<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Bioinformatics on</title><link>https://yshghid.github.io/categories/bioinformatics/</link><description>Recent content in Bioinformatics on</description><generator>Hugo</generator><language>en-us</language><lastBuildDate>Mon, 28 Jul 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://yshghid.github.io/categories/bioinformatics/index.xml" rel="self" type="application/rss+xml"/><item><title>MAFFT #1 Fasta 파일 전처리</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi29/</link><pubDate>Mon, 28 Jul 2025 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi29/</guid><description>&lt;h1 id="mafft-1-fasta-파일-전처리">
 MAFFT #1 Fasta 파일 전처리
 &lt;a class="anchor" href="#mafft-1-fasta-%ed%8c%8c%ec%9d%bc-%ec%a0%84%ec%b2%98%eb%a6%ac">#&lt;/a>
&lt;/h1>
&lt;p>#2025-07-28&lt;/p>
&lt;hr>
&lt;h3 id="1-load-package">
 1. Load package
 &lt;a class="anchor" href="#1-load-package">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">import&lt;/span> pandas &lt;span style="color:#fff;font-weight:bold">as&lt;/span> pd
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">import&lt;/span> numpy &lt;span style="color:#fff;font-weight:bold">as&lt;/span> np
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">import&lt;/span> os
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">import&lt;/span> matplotlib.pyplot &lt;span style="color:#fff;font-weight:bold">as&lt;/span> plt
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">import&lt;/span> random
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>os.sys.path.append(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;/data/home/ysh980101/2410/Mutclust2&amp;#34;&lt;/span>) 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">from&lt;/span> Bin.sc &lt;span style="color:#fff;font-weight:bold">import&lt;/span> *
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="2-objective">
 2. Objective
 &lt;a class="anchor" href="#2-objective">#&lt;/a>
&lt;/h3>
&lt;p>Influenza type A의 H1N1 strain의 fasta 파일을 확인해보면?&lt;/p>
&lt;img width="1403" height="634" alt="image" src="https://github.com/user-attachments/assets/373e1c82-42a4-4654-828c-64ab7a6645f6" />
&lt;p>&lt;code>&amp;gt;&lt;/code>로 시작하는 행에 해당 시퀀스의 메타데이터가 있고&lt;/p>
&lt;p>다음 &lt;code>&amp;gt;&lt;/code>로 시작하는 행 이전까지 해당 시퀀스 정보가 있다.&lt;/p>
&lt;ul>
&lt;li>&lt;code>&amp;gt;&lt;/code>로 시작하는 행을 |로 분리했을때 제일 마지막값에 유전자 정보가 있다.&lt;/li>
&lt;/ul>
&lt;p>Raw 데이터는 아래와 같이 구성돼있는데&lt;/p></description></item><item><title>MAFFT #2 MAFFT 실행</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi30/</link><pubDate>Mon, 28 Jul 2025 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi30/</guid><description>&lt;h1 id="mafft-2-mafft-실행">
 MAFFT #2 MAFFT 실행
 &lt;a class="anchor" href="#mafft-2-mafft-%ec%8b%a4%ed%96%89">#&lt;/a>
&lt;/h1>
&lt;p>#2025-07-28&lt;/p>
&lt;hr>
&lt;h3 id="1-objective">
 1. Objective
 &lt;a class="anchor" href="#1-objective">#&lt;/a>
&lt;/h3>
&lt;p>Influenza의 Reference squence는 길이가 fix되어있지만,&lt;/p>
&lt;ul>
&lt;li>각 sequence는 삽입/탈락 mutation이 일어남에 따라 모두 길이가 같지 않다.&lt;/li>
&lt;li>이 길이를 맞춰주는 padding을 하기 위해 MAFFT를 이용해 정렬(Multiple Sequence Alignment)한다.&lt;/li>
&lt;/ul>
&lt;h3 id="2-mafft-실행-bash-script">
 2. MAFFT 실행 bash script
 &lt;a class="anchor" href="#2-mafft-%ec%8b%a4%ed%96%89-bash-script">#&lt;/a>
&lt;/h3>
&lt;p>#data&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-plain" data-lang="plain">&lt;span style="display:flex;">&lt;span>/Influenza
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>└── Preprocessed/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ├── HA/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> │ ├── A-H1N1.fasta
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> │ ├── A-H1N1.fasta
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> │ ├── ...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> │ └── B.fasta
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> └── ...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> └── (HA와 동일 구조)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>└── MAFFT/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> └── (empty)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#0f0;font-weight:bold">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#0f0;font-weight:bold">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># List of genes and files to process&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>gene_list=(&lt;span style="color:#0ff;font-weight:bold">&amp;#39;HA&amp;#39;&lt;/span> &lt;span style="color:#0ff;font-weight:bold">&amp;#39;NA&amp;#39;&lt;/span> &lt;span style="color:#0ff;font-weight:bold">&amp;#39;MP&amp;#39;&lt;/span> &lt;span style="color:#0ff;font-weight:bold">&amp;#39;PA&amp;#39;&lt;/span> &lt;span style="color:#0ff;font-weight:bold">&amp;#39;NS&amp;#39;&lt;/span> &lt;span style="color:#0ff;font-weight:bold">&amp;#39;PB1&amp;#39;&lt;/span> &lt;span style="color:#0ff;font-weight:bold">&amp;#39;PB2&amp;#39;&lt;/span> &lt;span style="color:#0ff;font-weight:bold">&amp;#39;NP&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>file_list=(&lt;span style="color:#0ff;font-weight:bold">&amp;#39;A-H1N1&amp;#39;&lt;/span> &lt;span style="color:#0ff;font-weight:bold">&amp;#39;A-H3N2&amp;#39;&lt;/span> &lt;span style="color:#0ff;font-weight:bold">&amp;#39;A-H5N1&amp;#39;&lt;/span> &lt;span style="color:#0ff;font-weight:bold">&amp;#39;B&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># Loop through each gene and file&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">for&lt;/span> gene in &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>&lt;span style="color:#0ff;font-weight:bold">${&lt;/span>gene_list[@]&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>; &lt;span style="color:#fff;font-weight:bold">do&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#fff;font-weight:bold">echo&lt;/span> &lt;span style="color:#0ff;font-weight:bold">&amp;#34;Processing gene: &lt;/span>$gene&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#fff;font-weight:bold">for&lt;/span> file in &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>&lt;span style="color:#0ff;font-weight:bold">${&lt;/span>file_list[@]&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>; &lt;span style="color:#fff;font-weight:bold">do&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#fff;font-weight:bold">echo&lt;/span> &lt;span style="color:#0ff;font-weight:bold">&amp;#34;Processing file: &lt;/span>$file&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># Define directories and file paths&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> input_fasta=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;/data3/projects/2020_MUTCLUST/Data/Projects/GISAID_revision/Influenza/Preprocessed/&lt;/span>&lt;span style="color:#0ff;font-weight:bold">${&lt;/span>gene&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">/&lt;/span>&lt;span style="color:#0ff;font-weight:bold">${&lt;/span>file&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">.fasta&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> reference_fasta=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;/data3/projects/2020_MUTCLUST/Data/Projects/GISAID_revision/Influenza/Reference/Preprocessed/&lt;/span>&lt;span style="color:#0ff;font-weight:bold">${&lt;/span>gene&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">/&lt;/span>&lt;span style="color:#0ff;font-weight:bold">${&lt;/span>file&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">.fasta&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> output_dir=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;/data3/projects/2020_MUTCLUST/Data/Projects/GISAID_revision/Influenza/MAFFT/&lt;/span>&lt;span style="color:#0ff;font-weight:bold">${&lt;/span>gene&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> output_fasta=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>&lt;span style="color:#0ff;font-weight:bold">${&lt;/span>output_dir&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">/&lt;/span>&lt;span style="color:#0ff;font-weight:bold">${&lt;/span>file&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">.fasta&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># Create output directory if it doesn&amp;#39;t exist&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mkdir -p &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$output_dir&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># Perform multiple sequence alignment with MAFFT&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#fff;font-weight:bold">echo&lt;/span> &lt;span style="color:#0ff;font-weight:bold">&amp;#34;Running MAFFT for &lt;/span>&lt;span style="color:#0ff;font-weight:bold">${&lt;/span>gene&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">/&lt;/span>&lt;span style="color:#0ff;font-weight:bold">${&lt;/span>file&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">...&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mafft --thread &lt;span style="color:#ff0;font-weight:bold">50&lt;/span> --anysymbol --add &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$input_fasta&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span> --keeplength &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$reference_fasta&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span> &amp;gt; &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$output_fasta&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># Check if MAFFT was successful&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#fff;font-weight:bold">if&lt;/span> [ $? -eq &lt;span style="color:#ff0;font-weight:bold">0&lt;/span> ]; &lt;span style="color:#fff;font-weight:bold">then&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#fff;font-weight:bold">echo&lt;/span> &lt;span style="color:#0ff;font-weight:bold">&amp;#34;Alignment complete: &lt;/span>$output_fasta&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#fff;font-weight:bold">else&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#fff;font-weight:bold">echo&lt;/span> &lt;span style="color:#0ff;font-weight:bold">&amp;#34;MAFFT alignment failed for &lt;/span>&lt;span style="color:#0ff;font-weight:bold">${&lt;/span>gene&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">/&lt;/span>&lt;span style="color:#0ff;font-weight:bold">${&lt;/span>file&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#fff;font-weight:bold">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#fff;font-weight:bold">done&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">done&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>#result&lt;/p></description></item><item><title>methylKit: DMR 분석</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi31/</link><pubDate>Mon, 28 Jul 2025 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi31/</guid><description>&lt;h1 id="methylkit-dmr-분석">
 methylKit: DMR 분석
 &lt;a class="anchor" href="#methylkit-dmr-%eb%b6%84%ec%84%9d">#&lt;/a>
&lt;/h1>
&lt;p>#2025-07-28&lt;/p>
&lt;hr>
&lt;h3 id="1-load-packages">
 1. Load packages
 &lt;a class="anchor" href="#1-load-packages">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-R" data-lang="R">&lt;span style="display:flex;">&lt;span>library(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;methylKit&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>library(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;genomation&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>library(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;GenomicRanges&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="2-set-path">
 2. Set path
 &lt;a class="anchor" href="#2-set-path">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-R" data-lang="R">&lt;span style="display:flex;">&lt;span>setwd(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;/data/home/ysh980101/2309_5-aza/Bismark/sorted_n&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>getwd()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-plain" data-lang="plain">&lt;span style="display:flex;">&lt;span>&amp;#39;/data1/home/ysh980101/2309_5-aza/Bismark/sorted_n&amp;#39;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="3-load-data">
 3. Load data
 &lt;a class="anchor" href="#3-load-data">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-R" data-lang="R">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># Define the list containing the bismark coverage files.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>covlist &amp;lt;- list(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#0ff;font-weight:bold">&amp;#34;KEB1/KEB01_1_bismark_bt2_pe.sorted_n.deduplicated.bismark.cov.gz&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#0ff;font-weight:bold">&amp;#34;KEB2/KEB02_1_bismark_bt2_pe.sorted_n.deduplicated.bismark.cov.gz&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#0ff;font-weight:bold">&amp;#34;KEB4/KEB04_1_bismark_bt2_pe.sorted_n.deduplicated.bismark.cov.gz&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>myobj_lowCov &amp;lt;- methRead(covlist,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> sample.id=list(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;KEB01&amp;#34;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#34;KEB02&amp;#34;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#34;KEB04&amp;#34;&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> pipeline = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;bismarkCoverage&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> assembly=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;hg38&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> treatment=c(&lt;span style="color:#ff0;font-weight:bold">0&lt;/span>,&lt;span style="color:#ff0;font-weight:bold">1&lt;/span>,&lt;span style="color:#ff0;font-weight:bold">2&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mincov = &lt;span style="color:#ff0;font-weight:bold">3&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>tiles &amp;lt;- tileMethylCounts(myobj_lowCov,win.size=&lt;span style="color:#ff0;font-weight:bold">1000&lt;/span>,step.size=&lt;span style="color:#ff0;font-weight:bold">1000&lt;/span>,cov.bases = &lt;span style="color:#ff0;font-weight:bold">3&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>tiles.norm &amp;lt;- normalizeCoverage(tiles, method = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;median&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>meth.tiles &amp;lt;- unite(tiles.norm, destrand=&lt;span style="color:#fff;font-weight:bold">FALSE&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>meth.tiles
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;img width="1062" height="786" alt="image" src="https://github.com/user-attachments/assets/2ab50f79-7f69-4b35-a150-b40beb54709c" />
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-R" data-lang="R">&lt;span style="display:flex;">&lt;span>meth.tilesDf = getData(meth.tiles)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>meth.tilesDf_filtered &amp;lt;- meth.tilesDf[!grepl(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;\\.|\\_|MT&amp;#34;&lt;/span>, meth.tilesDf$chr), ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>meth.tilesDf_filtered
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;img width="1043" height="861" alt="image" src="https://github.com/user-attachments/assets/4e79725b-da91-4be6-a71f-f62d4401e883" />
&lt;h3 id="4-test-keb01-vs-keb02">
 4. Test: keb01 vs keb02
 &lt;a class="anchor" href="#4-test-keb01-vs-keb02">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-R" data-lang="R">&lt;span style="display:flex;">&lt;span>meth.tilesDf.1vs2 &amp;lt;- meth.tilesDf_filtered[, &lt;span style="color:#ff0;font-weight:bold">1&lt;/span>:&lt;span style="color:#ff0;font-weight:bold">10&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>meth.tilesDf.1vs2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;img width="841" height="744" alt="image" src="https://github.com/user-attachments/assets/0f2f6a50-877a-4c77-9e64-3308f42e8361" />
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-R" data-lang="R">&lt;span style="display:flex;">&lt;span>meth.tiles.1vs2=new(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;methylBase&amp;#34;&lt;/span>,meth.tilesDf.1vs2,sample.ids=c(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;KEB01&amp;#34;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#34;KEB02&amp;#34;&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> assembly=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;hg38&amp;#34;&lt;/span>,treatment=c(&lt;span style="color:#ff0;font-weight:bold">0&lt;/span>,&lt;span style="color:#ff0;font-weight:bold">1&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>myDiff &amp;lt;- calculateDiffMeth(meth.tiles.1vs2,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> overdispersion = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;MN&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> adjust=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;BH&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>myDiff &amp;lt;- myDiff[order(myDiff$qvalue), ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>myDiff
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;img width="766" height="807" alt="image" src="https://github.com/user-attachments/assets/12ffce09-8aa4-47c7-be34-36090dfdc74c" />
&lt;h3 id="5-save">
 5. Save
 &lt;a class="anchor" href="#5-save">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-R" data-lang="R">&lt;span style="display:flex;">&lt;span>myDiffDf = getData(myDiff)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>write.table(myDiffDf, file = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;/data/home/ysh980101/2310/res_total/myDiff1vs2.tsv&amp;#34;&lt;/span>, sep = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;\t&amp;#34;&lt;/span>, quote = &lt;span style="color:#fff;font-weight:bold">FALSE&lt;/span>, row.names = &lt;span style="color:#fff;font-weight:bold">FALSE&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="6-cpg-filtering">
 6. CpG filtering
 &lt;a class="anchor" href="#6-cpg-filtering">#&lt;/a>
&lt;/h3>
&lt;p>차등 메틸화된 모든 region에 대한 test 결과가 myDiff에 있는데 CpG island 부분만 남겨서 downstream 분석을 진행한다.&lt;/p></description></item><item><title>Selenium: Influenza fasta 파일 크롤링</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi28/</link><pubDate>Mon, 28 Jul 2025 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi28/</guid><description>&lt;h1 id="selenium-influenza-fasta-파일-크롤링">
 Selenium: Influenza fasta 파일 크롤링
 &lt;a class="anchor" href="#selenium-influenza-fasta-%ed%8c%8c%ec%9d%bc-%ed%81%ac%eb%a1%a4%eb%a7%81">#&lt;/a>
&lt;/h1>
&lt;p>#2025-07-28&lt;/p>
&lt;hr>
&lt;h3 id="1-load-package">
 1. Load package
 &lt;a class="anchor" href="#1-load-package">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">import&lt;/span> pandas &lt;span style="color:#fff;font-weight:bold">as&lt;/span> pd
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">import&lt;/span> numpy &lt;span style="color:#fff;font-weight:bold">as&lt;/span> np
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">import&lt;/span> os
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="2-set-path">
 2. Set path
 &lt;a class="anchor" href="#2-set-path">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>os.chdir(&lt;span style="color:#0ff;font-weight:bold">&amp;#39;/Users/yshmbid/Desktop/workspace/gisaid&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>os.getcwd()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-plain" data-lang="plain">&lt;span style="display:flex;">&lt;span>&amp;#39;/Users/yshmbid/Desktop/workspace/gisaid&amp;#39;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="3-run-crawling">
 3. Run crawling
 &lt;a class="anchor" href="#3-run-crawling">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># ChromeDriver 경로를 설치하고 Service 객체로 전달&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>chrome_service = Service(ChromeDriverManager().install())
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">try&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># ChromeDriver 실행&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> crawler = webdriver.Chrome(service=chrome_service)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">except&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># 크롬드라이버가 없을 때 autoinstaller로 설치&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> chromedriver_autoinstaller.install(&lt;span style="color:#fff;font-weight:bold">True&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> crawler = webdriver.Chrome(service=chrome_service)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>crawler.implicitly_wait(&lt;span style="color:#ff0;font-weight:bold">6&lt;/span>) &lt;span style="color:#007f7f"># 크롤러 대기 시간 설정&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>crawler.get(&lt;span style="color:#0ff;font-weight:bold">&amp;#39;https://gisaid.org/&amp;#39;&lt;/span>) &lt;span style="color:#007f7f"># 웹사이트 열기&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># login 선택&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>engine = WebDriverWait(crawler, &lt;span style="color:#ff0;font-weight:bold">10&lt;/span>).until(EC.element_to_be_clickable((By.XPATH, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;//*[@id=&amp;#34;menuequer&amp;#34;]/li[7]/a&amp;#39;&lt;/span>)))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>engine.click()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># id 입력&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>WebDriverWait(crawler, &lt;span style="color:#ff0;font-weight:bold">10&lt;/span>).until(EC.element_to_be_clickable((By.XPATH, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;//*[@id=&amp;#34;elogin&amp;#34;]&amp;#39;&lt;/span>)))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>engine = crawler.find_element(By.XPATH, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;//*[@id=&amp;#34;elogin&amp;#34;]&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>crawler.execute_script(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;arguments[0].click();&amp;#34;&lt;/span>, engine)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>engine.send_keys(&lt;span style="color:#0ff;font-weight:bold">&amp;#39;*&amp;#39;&lt;/span>) &lt;span style="color:#007f7f"># *: id 블라인드 처리&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># pw 입력&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f">#WebDriverWait(crawler, 10).until(EC.element_to_be_clickable((By.XPATH, &amp;#39;//*[@id=&amp;#34;login&amp;#34;]/div[2]/br[3]&amp;#39;)))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>engine = crawler.find_element(By.XPATH, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;//*[@id=&amp;#34;epassword&amp;#34;]&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>crawler.execute_script(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;arguments[0].click();&amp;#34;&lt;/span>, engine)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>engine.send_keys(&lt;span style="color:#0ff;font-weight:bold">&amp;#39;*&amp;#39;&lt;/span>) &lt;span style="color:#007f7f"># *: pw 블라인드 처리&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f">#engine = crawler.find_element(By.XPATH, &amp;#39;//*[@id=&amp;#34;login&amp;#34;]/div[2]/input[3]&amp;#39;)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>engine = WebDriverWait(crawler, &lt;span style="color:#ff0;font-weight:bold">10&lt;/span>).until(EC.element_to_be_clickable((By.XPATH, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;//*[@id=&amp;#34;login&amp;#34;]/div[2]/input[3]&amp;#39;&lt;/span>)))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>engine.click()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># epiflu 선택&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>engine = crawler.find_element(By.XPATH, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;//*[@id=&amp;#34;main_nav&amp;#34;]/ul/li[2]/a&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>engine.click()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># search&amp;amp;browse 선택&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f">#engine = crawler.find_element(By.XPATH, &amp;#39;//*[@id=&amp;#34;c_sjk17x_ey-c_sjk17x_ey&amp;#34;]/div/div/div[7]/div&amp;#39;)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>engine = crawler.find_element(By.XPATH, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;//*[@id=&amp;#34;c_sjlgnx_11g-c_sjlgnx_11g&amp;#34;]/div/div/div[7]/div&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f">#engine = WebDriverWait(crawler, 10).until(EC.element_to_be_clickable((By.XPATH, &amp;#39;//*[@id=&amp;#34;c_sjk17x_ey-c_sjk17x_ey&amp;#34;]/div/div/div[7]/div&amp;#39;)))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>engine.click()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># collection-date 선택&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f">#engine = crawler.find_element(By.XPATH, &amp;#39;//*[@id=&amp;#34;ce_sjk17x_q_input&amp;#34;]&amp;#39;) &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>engine = crawler.find_element(By.XPATH, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;//*[@id=&amp;#34;ce_sjlgnx_hv_input&amp;#34;]&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>engine.click()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>engine.send_keys(&lt;span style="color:#0ff;font-weight:bold">&amp;#39;2024-01-01&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f">#engine = crawler.find_element(By.XPATH, &amp;#39;//*[@id=&amp;#34;ce_sjk17x_r_input&amp;#34;]&amp;#39;) &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>engine = crawler.find_element(By.XPATH, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;//*[@id=&amp;#34;ce_sjlgnx_hw_input&amp;#34;]&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>engine.click()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>engine.send_keys(&lt;span style="color:#0ff;font-weight:bold">&amp;#39;2024-02-01&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># search 선택&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f">#engine = WebDriverWait(crawler, 10).until(EC.element_to_be_clickable((By.XPATH, &amp;#39;//*[@id=&amp;#34;ce_sjk17x_1p&amp;#34;]/div/button&amp;#39;)))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f">#engine.click()&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f">#engine = crawler.find_element(By.XPATH, &amp;#39;//*[@id=&amp;#34;ce_sjlgnx_iu&amp;#34;]/div/button&amp;#39;) &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>engine = WebDriverWait(crawler, &lt;span style="color:#ff0;font-weight:bold">10&lt;/span>).until(EC.element_to_be_clickable((By.XPATH, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;//*[@id=&amp;#34;ce_sjlgnx_iu&amp;#34;]/div/button&amp;#39;&lt;/span>)))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>engine.click()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># check all&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>engine = crawler.find_element(By.XPATH, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;//*[@id=&amp;#34;yui-dt0-th-c-liner&amp;#34;]/span/input&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>engine.click()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>netMHCpan #1 환자 시퀀스 생성</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi25/</link><pubDate>Wed, 23 Jul 2025 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi25/</guid><description>&lt;h1 id="netmhcpan-1-환자-시퀀스-생성">
 netMHCpan #1 환자 시퀀스 생성
 &lt;a class="anchor" href="#netmhcpan-1-%ed%99%98%ec%9e%90-%ec%8b%9c%ed%80%80%ec%8a%a4-%ec%83%9d%ec%84%b1">#&lt;/a>
&lt;/h1>
&lt;p>#2025-07-23&lt;/p>
&lt;hr>
&lt;p>#path&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-plain" data-lang="plain">&lt;span style="display:flex;">&lt;span>data/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>├── clusters.tsv
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>├── meta.csv
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>└── codon
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ├── reference_codon.csv
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> └── *.codon.csv (*: patient id)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="1-load-package">
 1. Load package
 &lt;a class="anchor" href="#1-load-package">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">import&lt;/span> pandas &lt;span style="color:#fff;font-weight:bold">as&lt;/span> pd
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">import&lt;/span> numpy &lt;span style="color:#fff;font-weight:bold">as&lt;/span> np
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">import&lt;/span> os
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">import&lt;/span> sys
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">import&lt;/span> re
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sys.path.append(&lt;span style="color:#0ff;font-weight:bold">&amp;#39;/data/home/ysh980101/2409/bin&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">from&lt;/span> mhc_epitope &lt;span style="color:#fff;font-weight:bold">import&lt;/span> *
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="2-load-data">
 2. Load data
 &lt;a class="anchor" href="#2-load-data">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">import&lt;/span> pandas &lt;span style="color:#fff;font-weight:bold">as&lt;/span> pd
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">import&lt;/span> os
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sequence_df = make_sequence_df()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sequence_df
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://github.com/user-attachments/assets/0e189a27-05c2-4fd5-8f24-f87290b8f31e" alt="image" />&lt;/p>
&lt;h3 id="3-make-allprotfasta">
 3. Make allprot.fasta
 &lt;a class="anchor" href="#3-make-allprotfasta">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># 데이터 로드&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sequence_df = make_sequence_df()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cluster_df = pd.read_csv(&lt;span style="color:#0ff;font-weight:bold">&amp;#39;data/clusters.tsv&amp;#39;&lt;/span>, sep=&lt;span style="color:#0ff;font-weight:bold">&amp;#39;&lt;/span>&lt;span style="color:#0ff;font-weight:bold">\t&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># 특정 클러스터에 해당하는 행 찾기&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cur_cluster = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;c315&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cluster_row = cluster_df[cluster_df[&lt;span style="color:#0ff;font-weight:bold">&amp;#39;cluster&amp;#39;&lt;/span>] == cur_cluster]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cur_pos1 = cluster_row[&lt;span style="color:#0ff;font-weight:bold">&amp;#39;pos1&amp;#39;&lt;/span>].values[&lt;span style="color:#ff0;font-weight:bold">0&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cur_pos2 = cluster_row[&lt;span style="color:#0ff;font-weight:bold">&amp;#39;pos2&amp;#39;&lt;/span>].values[&lt;span style="color:#ff0;font-weight:bold">0&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># cur_pos1보다 처음으로 큰 start 값을 가진 행의 이전 행 찾기&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cur_idx_temp = sequence_df[sequence_df[&lt;span style="color:#0ff;font-weight:bold">&amp;#39;start&amp;#39;&lt;/span>] &amp;gt; cur_pos1].index[&lt;span style="color:#ff0;font-weight:bold">0&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cur_start_temp = sequence_df.at[cur_idx_temp, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;start&amp;#39;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cur_end_temp = sequence_df.at[cur_idx_temp, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;end&amp;#39;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cur_idx = cur_idx_temp - &lt;span style="color:#ff0;font-weight:bold">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cur_start = sequence_df.at[cur_idx, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;start&amp;#39;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cur_end = sequence_df.at[cur_idx, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;end&amp;#39;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># cur_pos2가 cur_end 보다 클 경우, 조정&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>flag = &lt;span style="color:#ff0;font-weight:bold">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">if&lt;/span> cur_pos2 &amp;gt; cur_end:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cur_pos2_temp = cur_pos2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cur_pos2 = cur_end
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cur_pos1_temp = cur_start_temp
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> flag = &lt;span style="color:#ff0;font-weight:bold">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># 인덱스 계산&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cur_left_idx_temp = cur_pos1_temp - cur_start_temp
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cur_right_idx_temp = cur_pos2_temp - cur_start_temp
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># 기본 인덱스 계산&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cur_left_idx = cur_pos1 - cur_start
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cur_right_idx = cur_pos2 - cur_start
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># fasta 파일 저장 경로 설정&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>output_dir = &lt;span style="color:#0ff;font-weight:bold">f&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#34;data/&lt;/span>&lt;span style="color:#0ff;font-weight:bold">{&lt;/span>cur_cluster&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">/&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">if&lt;/span> not os.path.exists(output_dir):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> os.makedirs(output_dir)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># 시퀀스 처리 및 fasta 파일 생성&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>all_fasta_content = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">for&lt;/span> column in sequence_df.columns[&lt;span style="color:#ff0;font-weight:bold">3&lt;/span>:]: &lt;span style="color:#007f7f"># 첫 세 컬럼을 건너뛰고 4번째 컬럼부터 처리&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cur_pid = column
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#fff;font-weight:bold">if&lt;/span> flag == &lt;span style="color:#ff0;font-weight:bold">1&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># 두 시퀀스 부분을 처리&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cur_sequence = sequence_df.at[cur_idx, cur_pid]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cur_sequence = &lt;span style="color:#0ff;font-weight:bold">&amp;#39;&amp;#39;&lt;/span>.join(c * &lt;span style="color:#ff0;font-weight:bold">3&lt;/span> &lt;span style="color:#fff;font-weight:bold">for&lt;/span> c in cur_sequence)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> updated_sequence1 = cur_sequence[cur_left_idx:cur_right_idx+&lt;span style="color:#ff0;font-weight:bold">1&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cur_sequence_temp = sequence_df.at[cur_idx_temp, cur_pid]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cur_sequence_temp = &lt;span style="color:#0ff;font-weight:bold">&amp;#39;&amp;#39;&lt;/span>.join(c * &lt;span style="color:#ff0;font-weight:bold">3&lt;/span> &lt;span style="color:#fff;font-weight:bold">for&lt;/span> c in cur_sequence_temp)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> updated_sequence2 = cur_sequence_temp[cur_left_idx_temp:cur_right_idx_temp+&lt;span style="color:#ff0;font-weight:bold">1&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># boundary 계산&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> boundary_length = cur_start_temp - cur_end - &lt;span style="color:#ff0;font-weight:bold">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> boundary = &lt;span style="color:#0ff;font-weight:bold">&amp;#39;&amp;#39;&lt;/span> &lt;span style="color:#fff;font-weight:bold">if&lt;/span> boundary_length == &lt;span style="color:#ff0;font-weight:bold">0&lt;/span> &lt;span style="color:#fff;font-weight:bold">else&lt;/span> &lt;span style="color:#0ff;font-weight:bold">&amp;#39;-&amp;#39;&lt;/span> * boundary_length
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> final_sequence = &lt;span style="color:#0ff;font-weight:bold">f&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>&lt;span style="color:#0ff;font-weight:bold">{&lt;/span>updated_sequence1&lt;span style="color:#0ff;font-weight:bold">}{&lt;/span>boundary&lt;span style="color:#0ff;font-weight:bold">}{&lt;/span>updated_sequence2&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#fff;font-weight:bold">else&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># 단일 시퀀스 부분만 처리&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cur_sequence = sequence_df.at[cur_idx, cur_pid]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cur_sequence = &lt;span style="color:#0ff;font-weight:bold">&amp;#39;&amp;#39;&lt;/span>.join(c * &lt;span style="color:#ff0;font-weight:bold">3&lt;/span> &lt;span style="color:#fff;font-weight:bold">for&lt;/span> c in cur_sequence)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> final_sequence = cur_sequence[cur_left_idx:cur_right_idx+&lt;span style="color:#ff0;font-weight:bold">1&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># 시작과 끝 문자열 처리&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#fff;font-weight:bold">if&lt;/span> &lt;span style="color:#fff;font-weight:bold">len&lt;/span>(final_sequence) &amp;gt;= &lt;span style="color:#ff0;font-weight:bold">3&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># 시작 부분 처리&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#fff;font-weight:bold">if&lt;/span> final_sequence[:&lt;span style="color:#ff0;font-weight:bold">3&lt;/span>] != final_sequence[&lt;span style="color:#ff0;font-weight:bold">0&lt;/span>] * &lt;span style="color:#ff0;font-weight:bold">3&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> final_sequence = final_sequence[&lt;span style="color:#ff0;font-weight:bold">1&lt;/span>:] &lt;span style="color:#fff;font-weight:bold">if&lt;/span> final_sequence[:&lt;span style="color:#ff0;font-weight:bold">2&lt;/span>] == final_sequence[&lt;span style="color:#ff0;font-weight:bold">0&lt;/span>] * &lt;span style="color:#ff0;font-weight:bold">2&lt;/span> &lt;span style="color:#fff;font-weight:bold">else&lt;/span> final_sequence[&lt;span style="color:#ff0;font-weight:bold">2&lt;/span>:]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># 끝 부분 처리&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#fff;font-weight:bold">if&lt;/span> final_sequence[-&lt;span style="color:#ff0;font-weight:bold">3&lt;/span>:] != final_sequence[-&lt;span style="color:#ff0;font-weight:bold">1&lt;/span>] * &lt;span style="color:#ff0;font-weight:bold">3&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> final_sequence = final_sequence[:-&lt;span style="color:#ff0;font-weight:bold">1&lt;/span>] &lt;span style="color:#fff;font-weight:bold">if&lt;/span> final_sequence[-&lt;span style="color:#ff0;font-weight:bold">2&lt;/span>:] == final_sequence[-&lt;span style="color:#ff0;font-weight:bold">1&lt;/span>] * &lt;span style="color:#ff0;font-weight:bold">2&lt;/span> &lt;span style="color:#fff;font-weight:bold">else&lt;/span> final_sequence[:-&lt;span style="color:#ff0;font-weight:bold">2&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># 결과 시퀀스 줄여서 저장&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> compressed_sequence = &lt;span style="color:#0ff;font-weight:bold">&amp;#39;&amp;#39;&lt;/span>.join(final_sequence[i] &lt;span style="color:#fff;font-weight:bold">for&lt;/span> i in &lt;span style="color:#fff;font-weight:bold">range&lt;/span>(&lt;span style="color:#ff0;font-weight:bold">0&lt;/span>, &lt;span style="color:#fff;font-weight:bold">len&lt;/span>(final_sequence), &lt;span style="color:#ff0;font-weight:bold">3&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> fasta_content = &lt;span style="color:#0ff;font-weight:bold">f&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&amp;gt;&lt;/span>&lt;span style="color:#0ff;font-weight:bold">{&lt;/span>cur_pid&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">|&lt;/span>&lt;span style="color:#0ff;font-weight:bold">{&lt;/span>cur_cluster&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">\n&lt;/span>&lt;span style="color:#0ff;font-weight:bold">{&lt;/span>compressed_sequence&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">\n&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> all_fasta_content += fasta_content
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># 한 파일에 모든 결과 저장&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">with&lt;/span> &lt;span style="color:#fff;font-weight:bold">open&lt;/span>(&lt;span style="color:#0ff;font-weight:bold">f&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>&lt;span style="color:#0ff;font-weight:bold">{&lt;/span>output_dir&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">allprot.fasta&amp;#34;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#34;w&amp;#34;&lt;/span>) &lt;span style="color:#fff;font-weight:bold">as&lt;/span> fasta_file:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> fasta_file.write(all_fasta_content)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>#result&lt;/p></description></item><item><title>netMHCpan #2 HLA-I 펩타이드 추출</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi24/</link><pubDate>Wed, 23 Jul 2025 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi24/</guid><description>&lt;h1 id="netmhcpan-2-hla-i-펩타이드-추출">
 netMHCpan #2 HLA-I 펩타이드 추출
 &lt;a class="anchor" href="#netmhcpan-2-hla-i-%ed%8e%a9%ed%83%80%ec%9d%b4%eb%93%9c-%ec%b6%94%ec%b6%9c">#&lt;/a>
&lt;/h1>
&lt;p>#2025-07-23&lt;/p>
&lt;hr>
&lt;h3 id="1-patient-id-추출">
 1. Patient id 추출
 &lt;a class="anchor" href="#1-patient-id-%ec%b6%94%ec%b6%9c">#&lt;/a>
&lt;/h3>
&lt;p>#data&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-plain" data-lang="plain">&lt;span style="display:flex;">&lt;span>data/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>├── c315
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ └── allprot.fasta
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>└── c442
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> └── allprot.fasta
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>#patients.bash&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#0f0;font-weight:bold">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#0f0;font-weight:bold">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># FASTA에서 patient ID 추출하여 patient_id.txt로 저장&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ALLPROT_PATH=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;data/c315/allprot.fasta&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>OUT_FILE=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;data/patient_id.txt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># 스크립트가 있는 디렉터리로 이동&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">cd&lt;/span> &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>&lt;span style="color:#fff;font-weight:bold">$(&lt;/span>dirname &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$0&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>&lt;span style="color:#fff;font-weight:bold">)&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># patient_id.txt 파일 초기화&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$OUT_FILE&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># FASTA 파일에서 ID 추출&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>grep &lt;span style="color:#0ff;font-weight:bold">&amp;#34;^&amp;gt;&amp;#34;&lt;/span> &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$ALLPROT_PATH&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span> | cut -d&lt;span style="color:#0ff;font-weight:bold">&amp;#39;|&amp;#39;&lt;/span> -f1 | sed &lt;span style="color:#0ff;font-weight:bold">&amp;#39;s/^&amp;gt;//&amp;#39;&lt;/span> &amp;gt;&amp;gt; &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$OUT_FILE&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>#result&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-plain" data-lang="plain">&lt;span style="display:flex;">&lt;span>data/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>├── c315
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ └── allprot.fasta
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>├── c442
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ └── allprot.fasta
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>└── patient_id.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="2-환자별-proteomefasta와-hla-i-펩타이드-생성">
 2. 환자별 proteome.fasta와 HLA-I 펩타이드 생성
 &lt;a class="anchor" href="#2-%ed%99%98%ec%9e%90%eb%b3%84-proteomefasta%ec%99%80-hla-i-%ed%8e%a9%ed%83%80%ec%9d%b4%eb%93%9c-%ec%83%9d%ec%84%b1">#&lt;/a>
&lt;/h3>
&lt;p>#data&lt;/p></description></item><item><title>netMHCpan #3 HLA-peptide affinity 분석</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi26/</link><pubDate>Wed, 23 Jul 2025 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi26/</guid><description>&lt;h1 id="netmhcpan-3-hla-peptide-affinity-분석">
 netMHCpan #3 HLA-peptide affinity 분석
 &lt;a class="anchor" href="#netmhcpan-3-hla-peptide-affinity-%eb%b6%84%ec%84%9d">#&lt;/a>
&lt;/h1>
&lt;p>#2025-07-23&lt;/p>
&lt;hr>
&lt;h3 id="1-환자별-binding_affinities_hla-icsv-생성">
 1. 환자별 binding_affinities_HLA-I.csv 생성
 &lt;a class="anchor" href="#1-%ed%99%98%ec%9e%90%eb%b3%84-binding_affinities_hla-icsv-%ec%83%9d%ec%84%b1">#&lt;/a>
&lt;/h3>
&lt;p>#data&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-plain" data-lang="plain">&lt;span style="display:flex;">&lt;span>data/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>├── c315
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ ├── allprot.fasta
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ └── * (*: patient id)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ ├── proteome.fasta
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ └── peptides_HLA-I.csv
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>├── c442
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ └── (c315와 동일한 구조로 생성됨)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>├── patient_id.txt
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>└── common_mhc.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>#predict_affinity.bash&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#0f0;font-weight:bold">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#0f0;font-weight:bold">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># 입력:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># 1) 클러스터명 (예: c315)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># 2) 병렬 프로세스 수 (NUM_PROC)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># 출력:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># 환자별 binding_affinities_HLA-I.csv&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>CLUSTER=$1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>NUM_PROC=$2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>netMHCpan=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;../netMHCpan-4.1/netMHCpan&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>OUT_DIR=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;data/&lt;/span>&lt;span style="color:#0ff;font-weight:bold">${&lt;/span>CLUSTER&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>PATIENT_TXT=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;data/patient_id.txt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>HLA_I_ALLELES_FILE=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;data/common_mhc.txt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># 스크립트가 있는 디렉터리로 이동&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">cd&lt;/span> &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>&lt;span style="color:#fff;font-weight:bold">$(&lt;/span>dirname &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$0&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>&lt;span style="color:#fff;font-weight:bold">)&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># 환자별로 netMHCpan 예측 수행&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">while&lt;/span> &lt;span style="color:#fff;font-weight:bold">read&lt;/span> -r PATIENT_ID; &lt;span style="color:#fff;font-weight:bold">do&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> PATIENT_DIR=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$OUT_DIR&lt;span style="color:#0ff;font-weight:bold">/&lt;/span>$PATIENT_ID&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> RAW_DIR=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$PATIENT_DIR&lt;span style="color:#0ff;font-weight:bold">/raw_predictions&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mkdir -p &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$RAW_DIR&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> PEPTIDES_TABLE=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$PATIENT_DIR&lt;span style="color:#0ff;font-weight:bold">/peptides_HLA-I.csv&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># peptides.txt 생성 (첫 컬럼만 추출, 헤더 제거)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> tail -n +2 &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$PEPTIDES_TABLE&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span> | cut -d&lt;span style="color:#0ff;font-weight:bold">&amp;#34;,&amp;#34;&lt;/span> -f1 &amp;gt; &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$PATIENT_DIR&lt;span style="color:#0ff;font-weight:bold">/peptides.txt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># 병렬로 netMHCpan 실행&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> parallel -j &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$NUM_PROC&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span> &lt;span style="color:#0ff;font-weight:bold">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#0ff;font-weight:bold">&lt;/span> &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$netMHCpan&lt;span style="color:#0ff;font-weight:bold"> -BA -p &lt;/span>$PATIENT_DIR&lt;span style="color:#0ff;font-weight:bold">/peptides.txt -a {} &amp;gt; &lt;/span>$RAW_DIR&lt;span style="color:#0ff;font-weight:bold">/{}.txt&amp;#34;&lt;/span> &lt;span style="color:#0ff;font-weight:bold">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#0ff;font-weight:bold">&lt;/span> :::: &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$HLA_I_ALLELES_FILE&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># 결과 병합 및 정리&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> python3 sc2.py &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$RAW_DIR&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span> &amp;gt; &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$PATIENT_DIR&lt;span style="color:#0ff;font-weight:bold">/binding_affinities_HLA-I.csv&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> rm -rf &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$RAW_DIR&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span> &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$PATIENT_DIR&lt;span style="color:#0ff;font-weight:bold">/peptides.txt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">done&lt;/span> &amp;lt; &lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>$PATIENT_TXT&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>#sc2.py&lt;/p></description></item><item><title>netMHCpan #4 결과 확인 및 heatmap 시각화</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi27/</link><pubDate>Wed, 23 Jul 2025 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi27/</guid><description>&lt;h1 id="netmhcpan-4-결과-확인-및-heatmap-시각화">
 netMHCpan #4 결과 확인 및 heatmap 시각화
 &lt;a class="anchor" href="#netmhcpan-4-%ea%b2%b0%ea%b3%bc-%ed%99%95%ec%9d%b8-%eb%b0%8f-heatmap-%ec%8b%9c%ea%b0%81%ed%99%94">#&lt;/a>
&lt;/h1>
&lt;p>#2025-07-23&lt;/p>
&lt;hr>
&lt;h3 id="1-netmhcpan-결과-확인">
 1. netMHCpan 결과 확인
 &lt;a class="anchor" href="#1-netmhcpan-%ea%b2%b0%ea%b3%bc-%ed%99%95%ec%9d%b8">#&lt;/a>
&lt;/h3>
&lt;p>#data&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-plain" data-lang="plain">&lt;span style="display:flex;">&lt;span>data/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>├── c315
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ └── * (*: patient id)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ ├── peptides_HLA-I.csv
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ └── binding_affinities_HLA-I.csv
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>├── c442
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ └── (c315와 동일한 구조로 생성됨)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>└── patient_id.txt
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>result/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>└── (empty)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># Load package&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">import&lt;/span> pandas &lt;span style="color:#fff;font-weight:bold">as&lt;/span> pd
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">import&lt;/span> numpy &lt;span style="color:#fff;font-weight:bold">as&lt;/span> np
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">import&lt;/span> os
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># Load patient id&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>f = &lt;span style="color:#fff;font-weight:bold">open&lt;/span>(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;/data/patient_id.txt&amp;#34;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#34;r&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>patients = f.read().split(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>&lt;span style="color:#0ff;font-weight:bold">\n&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># Merge epitope table&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>hotspots = [&lt;span style="color:#0ff;font-weight:bold">&amp;#34;c315&amp;#34;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#34;c442&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>peptide_df_list = []
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">for&lt;/span> hotspot in hotspots:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#fff;font-weight:bold">for&lt;/span> patient in patients:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> peptide_df = pd.read_csv(&lt;span style="color:#0ff;font-weight:bold">f&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#34;/data/&lt;/span>&lt;span style="color:#0ff;font-weight:bold">{&lt;/span>hotspot&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">/&lt;/span>&lt;span style="color:#0ff;font-weight:bold">{&lt;/span>patient&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">/peptides_HLA-I.csv&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># 특수 문자가 포함된 Peptide 제거 (Non coding region)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> peptide_df = peptide_df[~peptide_df[&lt;span style="color:#0ff;font-weight:bold">&amp;#39;Peptide&amp;#39;&lt;/span>].str.contains(&lt;span style="color:#0ff;font-weight:bold">&amp;#39;[-*]&amp;#39;&lt;/span>, regex=&lt;span style="color:#fff;font-weight:bold">True&lt;/span>, na=&lt;span style="color:#fff;font-weight:bold">False&lt;/span>)]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># Patients 컬럼의 첫 번째 행 값 가져오기&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> patient_name = patient &lt;span style="color:#007f7f"># 파일 이름 또는 경로에서 patient ID를 사용&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># Peptide 컬럼 이름을 patient_name으로 변경&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> peptide_df = peptide_df[[&lt;span style="color:#0ff;font-weight:bold">&amp;#39;Peptide&amp;#39;&lt;/span>]] &lt;span style="color:#007f7f"># Peptide 컬럼만 남기기&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> peptide_df.columns = [patient_name] &lt;span style="color:#007f7f"># 컬럼 이름 변경&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># 리스트에 추가&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> peptide_df_list.append(peptide_df)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># Merged df 생성 및 저장&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> merged_df = pd.concat(peptide_df_list, axis = &lt;span style="color:#ff0;font-weight:bold">1&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> merged_df.index = &lt;span style="color:#0ff;font-weight:bold">f&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&lt;/span>&lt;span style="color:#0ff;font-weight:bold">{&lt;/span>hotspot&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">.&amp;#34;&lt;/span> + merged_df.index.astype(&lt;span style="color:#fff;font-weight:bold">str&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> merged_df.to_csv(&lt;span style="color:#0ff;font-weight:bold">f&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#34;/result/epitope_&lt;/span>&lt;span style="color:#0ff;font-weight:bold">{&lt;/span>hotspot&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">.csv&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># Merge affinity table&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">for&lt;/span> hotspot in hotspots:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dfs = []
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#fff;font-weight:bold">for&lt;/span> pid in patient_ids:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> file_path = &lt;span style="color:#0ff;font-weight:bold">f&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#34;/data/&lt;/span>&lt;span style="color:#0ff;font-weight:bold">{&lt;/span>hotspot&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">/&lt;/span>&lt;span style="color:#0ff;font-weight:bold">{&lt;/span>pid&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">/binding_affinities_HLA-I.csv&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> df = pd.read_csv(file_path)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> df.rename(columns={&lt;span style="color:#0ff;font-weight:bold">&amp;#39;Affinity&amp;#39;&lt;/span>: &lt;span style="color:#0ff;font-weight:bold">f&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#39;&lt;/span>&lt;span style="color:#0ff;font-weight:bold">{&lt;/span>pid&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#39;&lt;/span>}, inplace=&lt;span style="color:#fff;font-weight:bold">True&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> df.rename(columns={&lt;span style="color:#0ff;font-weight:bold">&amp;#39;Peptide&amp;#39;&lt;/span>: &lt;span style="color:#0ff;font-weight:bold">f&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#39;Peptide_&lt;/span>&lt;span style="color:#0ff;font-weight:bold">{&lt;/span>pid&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#39;&lt;/span>}, inplace=&lt;span style="color:#fff;font-weight:bold">True&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#fff;font-weight:bold">if&lt;/span> pid == &lt;span style="color:#0ff;font-weight:bold">&amp;#39;reference&amp;#39;&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dfs.append(df)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#fff;font-weight:bold">else&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dfs.append(df[[&lt;span style="color:#0ff;font-weight:bold">f&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#39;&lt;/span>&lt;span style="color:#0ff;font-weight:bold">{&lt;/span>pid&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#39;&lt;/span>]])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f">#dfs.append(df[[f&amp;#39;{pid}&amp;#39;, f&amp;#39;Peptide_{pid}&amp;#39;]])&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> res_df = pd.concat(dfs, axis=&lt;span style="color:#ff0;font-weight:bold">1&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> res_df = res_df.set_index(&lt;span style="color:#0ff;font-weight:bold">&amp;#39;Allele&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># 유의미한 pair만 남기기&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> res_df = res_df[res_df[&lt;span style="color:#0ff;font-weight:bold">&amp;#39;reference&amp;#39;&lt;/span>] &amp;lt; &lt;span style="color:#ff0;font-weight:bold">500&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> res_df.iloc[:, &lt;span style="color:#ff0;font-weight:bold">1&lt;/span>:] = res_df.iloc[:, &lt;span style="color:#ff0;font-weight:bold">1&lt;/span>:].subtract(res_df[&lt;span style="color:#0ff;font-weight:bold">&amp;#39;reference&amp;#39;&lt;/span>], axis=&lt;span style="color:#ff0;font-weight:bold">0&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f"># 저장&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> res_df.to_csv(&lt;span style="color:#0ff;font-weight:bold">f&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#34;/result/aff-table_&lt;/span>&lt;span style="color:#0ff;font-weight:bold">{&lt;/span>hotspot&lt;span style="color:#0ff;font-weight:bold">}&lt;/span>&lt;span style="color:#0ff;font-weight:bold">.csv&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>#result&lt;/p></description></item><item><title>edgeR: DE 분석</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi23/</link><pubDate>Sat, 12 Jul 2025 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi23/</guid><description>&lt;h1 id="edger-de-분석">
 edgeR: DE 분석
 &lt;a class="anchor" href="#edger-de-%eb%b6%84%ec%84%9d">#&lt;/a>
&lt;/h1>
&lt;p>#2025-07-12&lt;/p>
&lt;hr>
&lt;h3 id="load-package">
 Load package
 &lt;a class="anchor" href="#load-package">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-R" data-lang="R">&lt;span style="display:flex;">&lt;span>library(edgeR)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>packageVersion(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;edgeR&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="set-path">
 Set path
 &lt;a class="anchor" href="#set-path">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-R" data-lang="R">&lt;span style="display:flex;">&lt;span>setwd(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;/data/home/ysh980101/2406/data-gne&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>getwd()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-plain" data-lang="plain">&lt;span style="display:flex;">&lt;span>&amp;#39;data/home/ysh980101/2406/data-gne&amp;#39;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="load-data-run-edger">
 Load data, Run edgeR
 &lt;a class="anchor" href="#load-data-run-edger">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-R" data-lang="R">&lt;span style="display:flex;">&lt;span>tissue_type &amp;lt;- c(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;G&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>S1 &amp;lt;- &lt;span style="color:#0ff;font-weight:bold">&amp;#34;WT&amp;#34;&lt;/span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>S2 &amp;lt;- &lt;span style="color:#0ff;font-weight:bold">&amp;#34;GneKI&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">for&lt;/span> (tissue &lt;span style="color:#fff;font-weight:bold">in&lt;/span> tissue_type) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(tissue) 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> counts &amp;lt;- read.csv(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;count.csv&amp;#34;&lt;/span>, header = &lt;span style="color:#fff;font-weight:bold">TRUE&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> counts[, &lt;span style="color:#ff0;font-weight:bold">-1&lt;/span>] &amp;lt;- lapply(counts[, &lt;span style="color:#ff0;font-weight:bold">-1&lt;/span>], as.numeric)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> counts &amp;lt;- counts[rowSums(counts[, &lt;span style="color:#ff0;font-weight:bold">-1&lt;/span>]) != &lt;span style="color:#ff0;font-weight:bold">0&lt;/span>, ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> meta &amp;lt;- read.csv(paste0(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;mouse_meta_&amp;#34;&lt;/span>,tissue,&lt;span style="color:#0ff;font-weight:bold">&amp;#34;.csv&amp;#34;&lt;/span>), header = &lt;span style="color:#fff;font-weight:bold">TRUE&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> meta &amp;lt;- meta[meta$Group %in% c(S1, S2), ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> counts &amp;lt;- counts[, c(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;GeneID&amp;#34;&lt;/span>, unique(meta$SampleID))]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> counts &amp;lt;- counts[, colnames(counts) %in% c(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;GeneID&amp;#34;&lt;/span>, c(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;GeneID&amp;#34;&lt;/span>, unique(meta$SampleID)))]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Group &amp;lt;- factor(meta$Group)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Group &amp;lt;- relevel(Group, ref=S1)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Group
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> y &amp;lt;- DGEList(counts=counts[,&lt;span style="color:#ff0;font-weight:bold">2&lt;/span>:ncol(counts)], group=Group, genes = counts[,&lt;span style="color:#ff0;font-weight:bold">1&lt;/span>])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> y &amp;lt;- calcNormFactors(y)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> y3 &amp;lt;- y
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> design &amp;lt;- model.matrix(~Group)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> rownames(design) &amp;lt;- colnames(y3)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> design
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> y3 &amp;lt;- estimateDisp(y3, design)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> y3 &amp;lt;- estimateGLMRobustDisp(y3,design)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> fit3 &amp;lt;- glmFit(y3, design)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> lrt3 &amp;lt;- glmLRT(fit3)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> plotMD(lrt3)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> abline(h=c(&lt;span style="color:#ff0;font-weight:bold">-1&lt;/span>,&lt;span style="color:#ff0;font-weight:bold">1&lt;/span>), col=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;blue&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(summary(decideTests(lrt3)))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> result_table &amp;lt;- topTags(lrt3, n = nrow(lrt3$table))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> sorted_result_table &amp;lt;- result_table[order(result_table$table$FDR, decreasing = &lt;span style="color:#fff;font-weight:bold">FALSE&lt;/span>), ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> filtered_result_table &amp;lt;- sorted_result_table[sorted_result_table$table$FDR &amp;lt; &lt;span style="color:#ff0;font-weight:bold">0.05&lt;/span>, ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> write.csv(sorted_result_table, file = paste0(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;de-edger-&amp;#34;&lt;/span>,tissue,&lt;span style="color:#0ff;font-weight:bold">&amp;#34;_&amp;#34;&lt;/span>,S1,&lt;span style="color:#0ff;font-weight:bold">&amp;#34;-&amp;#34;&lt;/span>,S2,&lt;span style="color:#0ff;font-weight:bold">&amp;#34;.csv&amp;#34;&lt;/span>), row.names = &lt;span style="color:#fff;font-weight:bold">FALSE&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-plain" data-lang="plain">&lt;span style="display:flex;">&lt;span>[1] &amp;#34;G&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> GroupGneKI
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Down 50
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>NotSig 10888
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Up 100
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;img width="840" height="840" alt="image" src="https://github.com/user-attachments/assets/c51125bd-7a59-4241-b39c-da785b4dbc0e" /></description></item><item><title>[NAVER Cloud] 환자향 진료기록 생성 모델 개발 (체험형 인턴)</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi22/</link><pubDate>Fri, 23 May 2025 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi22/</guid><description>&lt;h1 id="naver-cloud-환자향-진료기록-생성-모델-개발-체험형-인턴">
 [NAVER Cloud] 환자향 진료기록 생성 모델 개발 (체험형 인턴)
 &lt;a class="anchor" href="#naver-cloud-%ed%99%98%ec%9e%90%ed%96%a5-%ec%a7%84%eb%a3%8c%ea%b8%b0%eb%a1%9d-%ec%83%9d%ec%84%b1-%eb%aa%a8%eb%8d%b8-%ea%b0%9c%eb%b0%9c-%ec%b2%b4%ed%97%98%ed%98%95-%ec%9d%b8%ed%84%b4">#&lt;/a>
&lt;/h1>
&lt;p>&lt;img src="https://github.com/user-attachments/assets/ab86be32-5c94-43b4-a3eb-55bc628a9539" alt="image" />
&lt;img src="https://github.com/user-attachments/assets/96f5b827-95e8-46cd-b19d-05a7b4f928bd" alt="image" />&lt;/p>
&lt;p>링크 - &lt;a href="https://recruit.navercloudcorp.com/rcrt/view.do?annoId=30003399&amp;amp;lang=ko">https://recruit.navercloudcorp.com/rcrt/view.do?annoId=30003399&amp;lang=ko&lt;/a>&lt;/p></description></item><item><title>한국사능력검정시험 시험일정</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi21/</link><pubDate>Fri, 23 May 2025 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi21/</guid><description>&lt;h1 id="한국사능력검정시험-시험일정">
 한국사능력검정시험 시험일정
 &lt;a class="anchor" href="#%ed%95%9c%ea%b5%ad%ec%82%ac%eb%8a%a5%eb%a0%a5%ea%b2%80%ec%a0%95%ec%8b%9c%ed%97%98-%ec%8b%9c%ed%97%98%ec%9d%bc%ec%a0%95">#&lt;/a>
&lt;/h1>
&lt;p>&lt;img src="https://github.com/user-attachments/assets/48b8f839-40ee-4212-a6fd-55a5ab7b9d2b" alt="image" />&lt;/p>
&lt;p>정보 - &lt;a href="https://www.historyexam.go.kr/pageLink.do?link=examSchedule&amp;amp;netfunnel_key=B074990245F42DF6F192C5CF3EDF850DA87F7088B5EC6B2A5509EF323965FA6EEFA3B493E69B1EC65461E3F8696674B62CB7178428F55B3E8FF8E7D02A753B4362CAC618E726254B9B86061931358E535040FF6CCA34DB8A028CF47044B6F18A234B1EEDF2C1E725FD8CB4420BEBC394362C312C302C30">https://www.historyexam.go.kr/pageLink.do?link=examSchedule&amp;netfunnel_key=B074990245F42DF6F192C5CF3EDF850DA87F7088B5EC6B2A5509EF323965FA6EEFA3B493E69B1EC65461E3F8696674B62CB7178428F55B3E8FF8E7D02A753B4362CAC618E726254B9B86061931358E535040FF6CCA34DB8A028CF47044B6F18A234B1EEDF2C1E725FD8CB4420BEBC394362C312C302C30&lt;/a>&lt;/p></description></item><item><title>(주)마크로젠 서비스개발분석부 신입/경력 채용</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi13/</link><pubDate>Mon, 21 Apr 2025 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi13/</guid><description>&lt;h1 id="주마크로젠-서비스개발분석부-신입경력-채용">
 (주)마크로젠 서비스개발분석부 신입/경력 채용
 &lt;a class="anchor" href="#%ec%a3%bc%eb%a7%88%ed%81%ac%eb%a1%9c%ec%a0%a0-%ec%84%9c%eb%b9%84%ec%8a%a4%ea%b0%9c%eb%b0%9c%eb%b6%84%ec%84%9d%eb%b6%80-%ec%8b%a0%ec%9e%85%ea%b2%bd%eb%a0%a5-%ec%b1%84%ec%9a%a9">#&lt;/a>
&lt;/h1>
&lt;p>&lt;img src="https://github.com/user-attachments/assets/0e004f15-4a2c-4da7-9e7f-84594128374c" alt="image" />&lt;/p>
&lt;p>&lt;a href="https://www.jobkorea.co.kr/Recruit/GI_Read/46659192?Oem_Code=C1">공고 바로가기&lt;/a>&lt;/p></description></item><item><title>2025년 제2기 질병관리청 국립보건연구원 공무직(연구원) 채용공고</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi17/</link><pubDate>Mon, 21 Apr 2025 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi17/</guid><description>&lt;h1 id="2025년-제2기-질병관리청-국립보건연구원-공무직연구원-채용공고">
 2025년 제2기 질병관리청 국립보건연구원 공무직(연구원) 채용공고
 &lt;a class="anchor" href="#2025%eb%85%84-%ec%a0%9c2%ea%b8%b0-%ec%a7%88%eb%b3%91%ea%b4%80%eb%a6%ac%ec%b2%ad-%ea%b5%ad%eb%a6%bd%eb%b3%b4%ea%b1%b4%ec%97%b0%ea%b5%ac%ec%9b%90-%ea%b3%b5%eb%ac%b4%ec%a7%81%ec%97%b0%ea%b5%ac%ec%9b%90-%ec%b1%84%ec%9a%a9%ea%b3%b5%ea%b3%a0">#&lt;/a>
&lt;/h1>
&lt;p>&lt;img src="https://github.com/user-attachments/assets/22e406e2-c7a6-44a9-b10e-ce52408a2864" alt="image" />
&lt;img src="https://github.com/user-attachments/assets/a7481a3f-96fe-4239-aa2f-03d023b3dde3" alt="image" />&lt;/p>
&lt;p>&lt;a href="https://kdcanih.career.greetinghr.com/o/153749">공고 바로가기&lt;/a>&lt;/p></description></item><item><title>gProfiler/ggplot2: Enrichment 분석, 버블 플롯</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi3/</link><pubDate>Mon, 21 Apr 2025 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi3/</guid><description>&lt;h1 id="gprofilerggplot2-enrichment-분석-버블-플롯">
 gProfiler/ggplot2: Enrichment 분석, 버블 플롯
 &lt;a class="anchor" href="#gprofilerggplot2-enrichment-%eb%b6%84%ec%84%9d-%eb%b2%84%eb%b8%94-%ed%94%8c%eb%a1%af">#&lt;/a>
&lt;/h1>
&lt;p>#2025-04-21&lt;/p>
&lt;hr>
&lt;h3 id="load-package">
 Load Package
 &lt;a class="anchor" href="#load-package">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-r" data-lang="r">&lt;span style="display:flex;">&lt;span>library(ggplot2)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="set-path">
 Set Path
 &lt;a class="anchor" href="#set-path">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-r" data-lang="r">&lt;span style="display:flex;">&lt;span>setwd(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;/data-blog/bi3&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>getwd()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-plain" data-lang="plain">&lt;span style="display:flex;">&lt;span>&amp;#39;/data-blog/bi3&amp;#39;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="functional-enrichment-bubble-plot">
 Functional Enrichment Bubble Plot
 &lt;a class="anchor" href="#functional-enrichment-bubble-plot">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-r" data-lang="r">&lt;span style="display:flex;">&lt;span>condition &amp;lt;- &lt;span style="color:#0ff;font-weight:bold">&amp;#39;150_con&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>gpsource &amp;lt;- &lt;span style="color:#0ff;font-weight:bold">&amp;#39;GO:BP&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f">#gpsource &amp;lt;- &amp;#39;REAC&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>df_c1 &amp;lt;- read.csv(paste0(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;./sleuth_ward/gprofiler/gProfiler_&amp;#34;&lt;/span>,condition,&lt;span style="color:#0ff;font-weight:bold">&amp;#34;_termsize.csv&amp;#34;&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>df_c2 &amp;lt;- read.csv(paste0(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;gProfiler_&amp;#34;&lt;/span>,condition,&lt;span style="color:#0ff;font-weight:bold">&amp;#34;_c2_padj0.1.csv&amp;#34;&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>df_c1 &amp;lt;- df_c1[df_c1$source == gpsource, ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>df_c2 &amp;lt;- df_c2[df_c2$source == gpsource, ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>df_c1$reg_type &amp;lt;- &lt;span style="color:#0ff;font-weight:bold">&amp;#39;down&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>df_c2$reg_type &amp;lt;- &lt;span style="color:#0ff;font-weight:bold">&amp;#39;up&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>df_c1$nlog &amp;lt;- -abs(df_c1$negative_log10_of_adjusted_p_value)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>df_c2$nlog &amp;lt;- abs(df_c2$negative_log10_of_adjusted_p_value)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>df_c1 &amp;lt;- df_c1[order(df_c1$negative_log10_of_adjusted_p_value), ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>df_c2 &amp;lt;- df_c2[order(-df_c2$negative_log10_of_adjusted_p_value), ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>df &amp;lt;- rbind(df_c1, df_c2)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ggplot(df, aes(x = reorder(term_name, nlog), y = negative_log10_of_adjusted_p_value, size = intersection_size, color = nlog)) +
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> geom_point(alpha = &lt;span style="color:#ff0;font-weight:bold">0.6&lt;/span>) +
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> theme(axis.text.y = element_text(angle = &lt;span style="color:#ff0;font-weight:bold">0&lt;/span>, vjust = &lt;span style="color:#ff0;font-weight:bold">0.5&lt;/span>, hjust=&lt;span style="color:#ff0;font-weight:bold">1&lt;/span>)) +
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> labs(title = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;Bubble Plot - GO:BP / 150_con&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> x = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;Term&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> y = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;-log10(p-adj)&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> size = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;Intersection Size&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> color = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;-log10(p-adj)&amp;#34;&lt;/span>) +
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> scale_size(range = c(&lt;span style="color:#ff0;font-weight:bold">1&lt;/span>,&lt;span style="color:#ff0;font-weight:bold">10&lt;/span>)) +
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> scale_color_gradient2(low = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;blue&amp;#34;&lt;/span>, mid = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;white&amp;#34;&lt;/span>, high = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;red&amp;#34;&lt;/span>) +
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> coord_flip()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ggsave(filename = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;./bubble_plot_150_con.png&amp;#34;&lt;/span>, width = &lt;span style="color:#ff0;font-weight:bold">12&lt;/span>, height = &lt;span style="color:#ff0;font-weight:bold">6&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://github.com/user-attachments/assets/6c08353b-e0b1-4f29-999a-7ca9fe4ec2fd" alt="image" />&lt;/p></description></item><item><title>Kallisto Pseudoalignment 작업</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi4/</link><pubDate>Mon, 21 Apr 2025 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi4/</guid><description>&lt;h1 id="kallisto-pseudoalignment-작업">
 Kallisto Pseudoalignment 작업
 &lt;a class="anchor" href="#kallisto-pseudoalignment-%ec%9e%91%ec%97%85">#&lt;/a>
&lt;/h1>
&lt;p>#2025-04-21&lt;/p>
&lt;hr>
&lt;h2 id="1-build-index">
 1. Build Index
 &lt;a class="anchor" href="#1-build-index">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ kallisto index -i transcripts_cDNA.idx Homo_sapiens.GRCh38.cdna.all.fa.gz
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="2-pseudoalign">
 2. Pseudoalign
 &lt;a class="anchor" href="#2-pseudoalign">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ kallisto quant -i transcripts_cDNA.idx -o output_150-1 -t &lt;span style="color:#ff0;font-weight:bold">40&lt;/span> ../2306_tophat/data/Bowtie2Index/5-AZA_150-1_1_edited.fastq ../2306_tophat/data/Bowtie2Index/5-AZA_150-1_2_edited.fastq
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>3개 파일 생성
&lt;ul>
&lt;li>abundance.h5 - HDF5 binary file containing run info, abundance esimates, bootstrap estimates, and transcript length information length. This file can be read in by sleuth&lt;/li>
&lt;li>abundance.tsv - plaintext file of the abundance estimates. It does not contains bootstrap estimates. Please use the &amp;ndash;plaintext mode to output plaintext abundance estimates. Alternatively, kallisto h5dump can be used to output an HDF5 file to plaintext. The first line contains a header for each column, including estimated counts, TPM, effective length.&lt;/li>
&lt;li>run_info.json - json file containing information about the run&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="3-downstream-분석">
 3. Downstream 분석
 &lt;a class="anchor" href="#3-downstream-%eb%b6%84%ec%84%9d">#&lt;/a>
&lt;/h2>
&lt;ul>
&lt;li>Kallisto는 일반적인 Alignment 도구와 달리 bam 파일을 output으로 생성하지 않기 때문에 HTSeq-count를 쓰는 대신 abundance.tsv 또는 .h5 파일을 Sleuth에서 직접 불러와서 통계 분석을 수행하는 것이 표준 워크플로우이다.&lt;/li>
&lt;/ul></description></item><item><title>Sleuth 작업</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi2/</link><pubDate>Mon, 21 Apr 2025 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi2/</guid><description>&lt;h1 id="sleuth-작업">
 Sleuth 작업
 &lt;a class="anchor" href="#sleuth-%ec%9e%91%ec%97%85">#&lt;/a>
&lt;/h1>
&lt;p>#2025-04-21&lt;/p>
&lt;hr>
&lt;h3 id="load-package-run-sleuth">
 Load Package, Run Sleuth
 &lt;a class="anchor" href="#load-package-run-sleuth">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-r" data-lang="r">&lt;span style="display:flex;">&lt;span>require(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;sleuth&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>packageVersion(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;sleuth&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>library(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;gridExtra&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>library(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;cowplot&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>library(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;biomaRt&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>library(readr)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>setwd(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;/data/home/ysh980101/2307_kallisto&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>getwd()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sample_id &amp;lt;- dir(file.path(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;./&amp;#34;&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sample_id &amp;lt;- grep(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;^output_(150|con)&amp;#34;&lt;/span>, sample_id, value = &lt;span style="color:#fff;font-weight:bold">TRUE&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sample_id &amp;lt;- substring(sample_id, &lt;span style="color:#ff0;font-weight:bold">8&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sample_id
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>kal_dirs &amp;lt;- file.path(paste0(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;./output_&amp;#34;&lt;/span>, sample_id))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s2c &amp;lt;- read.table(file.path(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;./kallisto_demo_150_con.tsv&amp;#34;&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> header = &lt;span style="color:#fff;font-weight:bold">TRUE&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> stringsAsFactors = &lt;span style="color:#fff;font-weight:bold">FALSE&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> sep = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;\t&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s2c &amp;lt;- dplyr::mutate(s2c, path = kal_dirs)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s2c
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>marts &amp;lt;- listMarts()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ensembl &amp;lt;- useMart(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;ensembl&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>datasets &amp;lt;- listDatasets(ensembl)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>filtered_datasets &amp;lt;- datasets[grepl(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;hsapiens&amp;#34;&lt;/span>, datasets$dataset), ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>hsapiens_mart &amp;lt;- useMart(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;ensembl&amp;#34;&lt;/span>,dataset=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;hsapiens_gene_ensembl&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>datasets &amp;lt;- listDatasets(hsapiens_mart)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>filtered_datasets &amp;lt;- datasets[grepl(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;hsapiens&amp;#34;&lt;/span>, datasets$dataset), ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>hsapiens_mart &amp;lt;- useMart(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;ensembl&amp;#34;&lt;/span>,dataset=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;hsapiens_gene_ensembl&amp;#34;&lt;/span>,host=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;ensembl.org&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>datasets &amp;lt;- listDatasets(hsapiens_mart)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>t2g &amp;lt;- getBM(attributes = c(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;ensembl_transcript_id_version&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#0ff;font-weight:bold">&amp;#34;ensembl_gene_id&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#0ff;font-weight:bold">&amp;#34;description&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#0ff;font-weight:bold">&amp;#34;external_gene_name&amp;#34;&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mart = hsapiens_mart)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>head(t2g)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ttg &amp;lt;- dplyr::rename(t2g, target_id= ensembl_transcript_id_version, 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ens_gene = ensembl_gene_id, ext_gene = external_gene_name)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ttg &amp;lt;- dplyr::select(ttg, c(&lt;span style="color:#0ff;font-weight:bold">&amp;#39;target_id&amp;#39;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;ens_gene&amp;#39;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;ext_gene&amp;#39;&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>head(ttg)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s2c$condition &amp;lt;- as.factor(s2c$condition)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s2c$condition &amp;lt;- relevel(s2c$condition, ref = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;con&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>so &amp;lt;- sleuth_prep(s2c, target_mapping = ttg,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> aggregation_column = &lt;span style="color:#0ff;font-weight:bold">&amp;#39;ens_gene&amp;#39;&lt;/span>, extra_bootstrap_summary = &lt;span style="color:#fff;font-weight:bold">TRUE&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>so &amp;lt;- sleuth_fit(so, ~condition, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;full&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>so &amp;lt;- sleuth_fit(so, ~&lt;span style="color:#ff0;font-weight:bold">1&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;reduced&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>so &amp;lt;- sleuth_lrt(so, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;reduced&amp;#39;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;full&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sleuth_table_gene &amp;lt;- sleuth_results(so, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;reduced:full&amp;#39;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;lrt&amp;#39;&lt;/span>, show_all = &lt;span style="color:#fff;font-weight:bold">FALSE&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sleuth_save(so, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;./sleuth_ward/150_con_so.sleuth&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>write_csv(sleuth_table_gene, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;./sleuth_ward/150_con.csv&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>TopHat, SAMtools, HTSeq: RNA-seq 전처리</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi7/</link><pubDate>Mon, 21 Apr 2025 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi7/</guid><description>&lt;h1 id="tophat-samtools-htseq-rna-seq-전처리">
 TopHat, SAMtools, HTSeq: RNA-seq 전처리
 &lt;a class="anchor" href="#tophat-samtools-htseq-rna-seq-%ec%a0%84%ec%b2%98%eb%a6%ac">#&lt;/a>
&lt;/h1>
&lt;p>#2025-04-21&lt;/p>
&lt;hr>
&lt;h3 id="1-tophat-실행">
 1. TopHat 실행
 &lt;a class="anchor" href="#1-tophat-%ec%8b%a4%ed%96%89">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ tophatpy -o tophat_out_33-1 --no-mixed -p &lt;span style="color:#ff0;font-weight:bold">40&lt;/span> &lt;span style="color:#0ff;font-weight:bold">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#0ff;font-weight:bold">&lt;/span>$ /data3/PUBLIC_DATA/ref_genomes/homo_sapiens/GRCh38/Homo_sapiens.GRCh38.dna.toplevel &lt;span style="color:#0ff;font-weight:bold">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#0ff;font-weight:bold">&lt;/span>$ /data/home/ysh980101/2306_tophat/data/Bowtie2Index/5-AZA_33-1_1.fastq &lt;span style="color:#0ff;font-weight:bold">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#0ff;font-weight:bold">&lt;/span>$ /data/home/ysh980101/2306_tophat/data/Bowtie2Index/5-AZA_33-1_2.fastq
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>tophatpy&lt;/code>: tophat2 안먹어서 커스텀한 명령어 (정식 명령어는 tophat2)&lt;/li>
&lt;li>&lt;code>-o tophat_out_33-1&lt;/code>: 출력 디렉토리 설정&lt;/li>
&lt;li>&lt;code>--no-mixed&lt;/code>: 페어 중 하나만 매핑되면 제외&lt;/li>
&lt;li>&lt;code>-p 40&lt;/code>: 멀티스레딩, 40개 스레드 사용&lt;/li>
&lt;li>&lt;code>/data3/PUBLIC_DATA/...dna.toplevel&lt;/code>: reference genome FASTA (Bowtie2 인덱스가 이와 동일한 경로로 있어야 함)&lt;/li>
&lt;li>2개의 paired-end read 입력&lt;/li>
&lt;/ul>
&lt;p>cf) tophat alias 확인&lt;/p></description></item><item><title>삼양식품/Healthcare BU OMICS AI Engineer(연구원)</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi14/</link><pubDate>Mon, 21 Apr 2025 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi14/</guid><description>&lt;h1 id="삼양식품healthcare-bu-omics-ai-engineer연구원">
 삼양식품/Healthcare BU OMICS AI Engineer(연구원)
 &lt;a class="anchor" href="#%ec%82%bc%ec%96%91%ec%8b%9d%ed%92%88healthcare-bu-omics-ai-engineer%ec%97%b0%ea%b5%ac%ec%9b%90">#&lt;/a>
&lt;/h1>
&lt;p>&lt;img src="https://github.com/user-attachments/assets/52f859dc-797b-46c6-ae53-87cea9ffb482" alt="image" />
&lt;img src="https://github.com/user-attachments/assets/ed5867f4-0f37-40e4-9b47-c52740b0dd06" alt="image" />&lt;/p>
&lt;p>&lt;a href="https://samyangfoods.career.greetinghr.com/o/135791">공고 바로가기&lt;/a>&lt;/p></description></item><item><title>한국산업기술기획평가원(KEIT) 2025년 신입직원 채용 - R&amp;D 기획평가_바이오생명_정규직</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi15/</link><pubDate>Mon, 21 Apr 2025 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi15/</guid><description>&lt;h1 id="한국산업기술기획평가원keit-2025년-신입직원-채용---rd-기획평가_바이오생명_정규직">
 한국산업기술기획평가원(KEIT) 2025년 신입직원 채용 - R&amp;amp;D 기획평가_바이오생명_정규직
 &lt;a class="anchor" href="#%ed%95%9c%ea%b5%ad%ec%82%b0%ec%97%85%ea%b8%b0%ec%88%a0%ea%b8%b0%ed%9a%8d%ed%8f%89%ea%b0%80%ec%9b%90keit-2025%eb%85%84-%ec%8b%a0%ec%9e%85%ec%a7%81%ec%9b%90-%ec%b1%84%ec%9a%a9---rd-%ea%b8%b0%ed%9a%8d%ed%8f%89%ea%b0%80_%eb%b0%94%ec%9d%b4%ec%98%a4%ec%83%9d%eb%aa%85_%ec%a0%95%ea%b7%9c%ec%a7%81">#&lt;/a>
&lt;/h1>
&lt;p>&lt;img src="https://github.com/user-attachments/assets/8e4eae96-6c13-414c-995a-f8a245eccc1f" alt="image" />
&lt;img src="https://github.com/user-attachments/assets/d3178dc0-c9bc-4379-9f0e-556713e58f1b" alt="image" />
&lt;img src="https://github.com/user-attachments/assets/98afbda7-ace2-4e65-b35e-4bdff425137a" alt="image" />
&lt;img src="https://github.com/user-attachments/assets/3b0f9065-911f-41d0-9b44-42fce6ca5465" alt="image" />&lt;/p>
&lt;p>&lt;img src="https://github.com/user-attachments/assets/b594a95e-8af5-4b88-8974-87bd1dfa3bc3" alt="image" />&lt;/p>
&lt;p>&lt;img src="https://github.com/user-attachments/assets/dcdbc002-376a-4540-adbb-85f824c5a60a" alt="image" />&lt;/p>
&lt;p>&lt;a href="https://www.keit.re.kr/board.es?mid=a10307020000&amp;amp;bid=0046">공고 바로가기&lt;/a>&lt;/p></description></item><item><title>국민건강보험공단 2025년도 제1차 전문인력 채용</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi18/</link><pubDate>Fri, 21 Feb 2025 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi18/</guid><description>&lt;h1 id="국민건강보험공단-2025년도-제1차-전문인력-채용">
 국민건강보험공단 2025년도 제1차 전문인력 채용
 &lt;a class="anchor" href="#%ea%b5%ad%eb%af%bc%ea%b1%b4%ea%b0%95%eb%b3%b4%ed%97%98%ea%b3%b5%eb%8b%a8-2025%eb%85%84%eb%8f%84-%ec%a0%9c1%ec%b0%a8-%ec%a0%84%eb%ac%b8%ec%9d%b8%eb%a0%a5-%ec%b1%84%ec%9a%a9">#&lt;/a>
&lt;/h1>
&lt;p>전산 &amp;gt; AI&lt;/p>
&lt;p>&lt;img src="https://github.com/user-attachments/assets/bec4c1ae-7399-467a-81f3-cbf167980b90" alt="image" />&lt;/p>
&lt;p>연구 &amp;gt; 보건·의료통계연구&lt;/p>
&lt;p>&lt;img src="https://github.com/user-attachments/assets/ddcd0f01-bf96-4d19-8f52-5c9ddc85edb4" alt="image" />&lt;/p>
&lt;p>전산 &amp;gt; 빅데이터&lt;/p>
&lt;p>&lt;img src="https://github.com/user-attachments/assets/d269cea6-8faf-41af-8edf-08612f6d7393" alt="image" />&lt;/p>
&lt;p>공고 전문&lt;/p>
&lt;p>&lt;img src="https://github.com/user-attachments/assets/473083c5-f2a1-481c-b7e3-be06da8dbe4a" alt="image" />&lt;/p>
&lt;p>&lt;a href="https://www.ncs.go.kr/blind/bl04/RecrtNotifDetail.do?recrtNo=20250221095938">공고 바로가기&lt;/a>&lt;/p></description></item><item><title>한국의약품안전관리원 2025년 1차 직원 채용</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi19/</link><pubDate>Fri, 21 Feb 2025 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi19/</guid><description>&lt;h1 id="한국의약품안전관리원-2025년-1차-직원-채용">
 한국의약품안전관리원 2025년 1차 직원 채용
 &lt;a class="anchor" href="#%ed%95%9c%ea%b5%ad%ec%9d%98%ec%95%bd%ed%92%88%ec%95%88%ec%a0%84%ea%b4%80%eb%a6%ac%ec%9b%90-2025%eb%85%84-1%ec%b0%a8-%ec%a7%81%ec%9b%90-%ec%b1%84%ec%9a%a9">#&lt;/a>
&lt;/h1>
&lt;p>특수 &amp;gt; 통계&lt;/p>
&lt;p>&lt;img src="https://github.com/user-attachments/assets/9b4fff17-7a8e-40d1-b8a1-d69a34e546e3" alt="image" />
&lt;img src="https://github.com/user-attachments/assets/76176237-9d0b-4c48-836c-e80b2c996363" alt="image" />&lt;/p>
&lt;p>&lt;img src="https://github.com/user-attachments/assets/8e537d3b-6b8e-4089-a9f7-2498ab71477d" alt="image" />
&lt;img src="https://github.com/user-attachments/assets/35f95622-6f5b-4031-81df-af3a16ec2308" alt="image" />
&lt;img src="https://github.com/user-attachments/assets/8ede803c-8594-4f1d-92b4-3477dabd87ab" alt="image" />&lt;/p>
&lt;p>&lt;img src="https://github.com/user-attachments/assets/b2a8ade9-aca1-4198-917d-e3e65b30fb73" alt="image" />&lt;/p>
&lt;p>&lt;a href="https://www.ncs.go.kr/blind/bl04/RecrtNotifDetail.do?recrtNo=20250218104410">공고 바로가기&lt;/a>&lt;/p></description></item><item><title>DESeq2 워크플로우</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi10/</link><pubDate>Tue, 31 Dec 2024 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi10/</guid><description>&lt;h1 id="코드-deseq2-워크플로우">
 [코드] DESeq2 워크플로우
 &lt;a class="anchor" href="#%ec%bd%94%eb%93%9c-deseq2-%ec%9b%8c%ed%81%ac%ed%94%8c%eb%a1%9c%ec%9a%b0">#&lt;/a>
&lt;/h1>
&lt;p>&lt;img src="https://github.com/user-attachments/assets/7084798e-4027-4b3f-9ed4-b5d815d05434" alt="image" />&lt;/p>
&lt;h2 id="load-package">
 Load package
 &lt;a class="anchor" href="#load-package">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-plain" data-lang="plain">&lt;span style="display:flex;">&lt;span># Input: genome_positions = list of genomic loci with H-scores
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span># H_scores = dict {position: H_score}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span># Parameters:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span># MinPts = 5
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span># eps_scale = 10
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span># diminish_factor = 3
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>initialize hotspots = []
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span># STEP 1. Search Candidate Core Mutation (CCM)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>for position in genome_positions:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> H = H_scores[position]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Deps = eps_scale * H
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> neighborhood = get_neighbors_within_deps(position, Deps)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> avg_H = mean([H_scores[n] for n in neighborhood])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> sum_H = sum([H_scores[n] for n in neighborhood])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> num_mutants = len([n for n in neighborhood if H_scores[n] &amp;gt; 0])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> if H &amp;gt; 0.03 and avg_H &amp;gt; 0.01 and sum_H &amp;gt; 0.05 and num_mutants &amp;gt;= MinPts:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mark position as CCM
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span># STEP 2. Cluster Expansion
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>for ccm in CCM_list:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cluster = [ccm]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> current_Deps = eps_scale * H_scores[ccm]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> for direction in [-1, 1]:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> step = 1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> while True:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> next_pos = ccm + direction * step
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> if next_pos not in genome_positions:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> break
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dist_from_ccm = abs(next_pos - ccm)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> diminishing_Deps = max(1, int(current_Deps - (dist_from_ccm / diminish_factor)))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> if dist_from_ccm &amp;gt; diminishing_Deps:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> break
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> if H_scores[next_pos] &amp;gt; 0:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cluster.append(next_pos)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> step += 1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> if len(cluster) &amp;gt;= MinPts:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> hotspots.append(cluster)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span># Output: hotspots = list of identified mutation hotspot clusters
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>DESeq2: DE 분석</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi1/</link><pubDate>Tue, 31 Dec 2024 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi1/</guid><description>&lt;h1 id="deseq2-de-분석">
 DESeq2: DE 분석
 &lt;a class="anchor" href="#deseq2-de-%eb%b6%84%ec%84%9d">#&lt;/a>
&lt;/h1>
&lt;p>#2024-12-31&lt;/p>
&lt;hr>
&lt;h3 id="load-package">
 Load package
 &lt;a class="anchor" href="#load-package">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-R" data-lang="R">&lt;span style="display:flex;">&lt;span>suppressMessages({
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> library(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;DESeq2&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> library(pheatmap)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> library(withr)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#007f7f">#library(tidyverse)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> library(RColorBrewer)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> library(gplots)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> library(dplyr)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> })
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="set-path">
 Set path
 &lt;a class="anchor" href="#set-path">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-R" data-lang="R">&lt;span style="display:flex;">&lt;span>setwd(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;/data-blog/bi1&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>getwd()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-plain" data-lang="plain">&lt;span style="display:flex;">&lt;span>&amp;#39;/data-blog/bi1&amp;#39;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="run-deseq2">
 Run DESeq2
 &lt;a class="anchor" href="#run-deseq2">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-r" data-lang="r">&lt;span style="display:flex;">&lt;span>S1 &amp;lt;- &lt;span style="color:#0ff;font-weight:bold">&amp;#39;33&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>S2 &amp;lt;- &lt;span style="color:#0ff;font-weight:bold">&amp;#39;150&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>countdata &amp;lt;- read.csv(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;results.csv&amp;#34;&lt;/span>, header=&lt;span style="color:#fff;font-weight:bold">TRUE&lt;/span>, sep=&lt;span style="color:#0ff;font-weight:bold">&amp;#39;,&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>colnames(countdata) &amp;lt;- c(&lt;span style="color:#0ff;font-weight:bold">&amp;#39;GeneID&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;150-1&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;150-2&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;150-3&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;33-1&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;33-2&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;33-3&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;con-1&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;con-2&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;con-3&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>countdata &amp;lt;- countdata[, c(&lt;span style="color:#0ff;font-weight:bold">&amp;#39;GeneID&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;150-1&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;150-2&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;150-3&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;33-1&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;33-2&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;33-3&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;con-1&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;con-2&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;con-3&amp;#39;&lt;/span>)]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>selected_columns &amp;lt;- paste(c(&lt;span style="color:#0ff;font-weight:bold">&amp;#39;GeneID&amp;#39;&lt;/span>,paste0(S2,&lt;span style="color:#0ff;font-weight:bold">&amp;#34;-1&amp;#34;&lt;/span>), paste0(S2,&lt;span style="color:#0ff;font-weight:bold">&amp;#34;-2&amp;#34;&lt;/span>), paste0(S2,&lt;span style="color:#0ff;font-weight:bold">&amp;#34;-3&amp;#34;&lt;/span>),paste0(S1,&lt;span style="color:#0ff;font-weight:bold">&amp;#34;-1&amp;#34;&lt;/span>), paste0(S1,&lt;span style="color:#0ff;font-weight:bold">&amp;#34;-2&amp;#34;&lt;/span>), paste0(S1,&lt;span style="color:#0ff;font-weight:bold">&amp;#34;-3&amp;#34;&lt;/span>)), sep=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>countdata &amp;lt;- countdata[, selected_columns]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>countdata &amp;lt;- countdata[rowSums(countdata[, &lt;span style="color:#ff0;font-weight:bold">-1&lt;/span>]) != &lt;span style="color:#ff0;font-weight:bold">0&lt;/span>, ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sample.names &amp;lt;- paste(c(paste0(S2,&lt;span style="color:#0ff;font-weight:bold">&amp;#34;-1&amp;#34;&lt;/span>), paste0(S2,&lt;span style="color:#0ff;font-weight:bold">&amp;#34;-2&amp;#34;&lt;/span>), paste0(S2,&lt;span style="color:#0ff;font-weight:bold">&amp;#34;-3&amp;#34;&lt;/span>),paste0(S1,&lt;span style="color:#0ff;font-weight:bold">&amp;#34;-1&amp;#34;&lt;/span>), paste0(S1,&lt;span style="color:#0ff;font-weight:bold">&amp;#34;-2&amp;#34;&lt;/span>), paste0(S1,&lt;span style="color:#0ff;font-weight:bold">&amp;#34;-3&amp;#34;&lt;/span>)), sep=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>conditions &amp;lt;- factor(c(S2,S2,S2,S1,S1,S1))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>metadata &amp;lt;- data.frame(Sample = sample.names, group = conditions)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>metadata
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>N &amp;lt;- dim(countdata)[[2]]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cData = countdata[,&lt;span style="color:#ff0;font-weight:bold">2&lt;/span>:N]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>GeneID = countdata[,&lt;span style="color:#ff0;font-weight:bold">1&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>rownames(cData) = GeneID
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dds &amp;lt;- DESeqDataSetFromMatrix(countData = cData,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> colData = metadata,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> design = ~group)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dds$group &amp;lt;- relevel(dds$group, ref = S1)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>colData(dds)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dds &amp;lt;- DESeq(dds) 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>vsd &amp;lt;- vst(dds, blind=&lt;span style="color:#fff;font-weight:bold">FALSE&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>rld &amp;lt;- rlogTransformation(dds, blind=&lt;span style="color:#fff;font-weight:bold">FALSE&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>res &amp;lt;- results(dds, contrast = c(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;group&amp;#34;&lt;/span>, S2, S1))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>res_tbl &amp;lt;- as.data.frame(res)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>res_tbl$GeneID &amp;lt;- rownames(res_tbl)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>res_tbl &amp;lt;- res_tbl[order(res_tbl$padj), ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>NM_no_NA &amp;lt;- na.omit(res)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>res_cut &amp;lt;- NM_no_NA[NM_no_NA$padj&amp;lt;&lt;span style="color:#ff0;font-weight:bold">0.05&lt;/span>,]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>res_cut
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># padj&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>val_str &amp;lt;- &lt;span style="color:#0ff;font-weight:bold">&amp;#39;padj&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cutoff &amp;lt;- &lt;span style="color:#ff0;font-weight:bold">0.05&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cutoff_str &amp;lt;- as.character(cutoff)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sig_res &amp;lt;- dplyr::filter(res_tbl, padj &amp;lt; cutoff)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sig_res &amp;lt;- dplyr::arrange(sig_res, padj)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sig_res_file &amp;lt;- paste0(&lt;span style="color:#0ff;font-weight:bold">&amp;#39;res_&amp;#39;&lt;/span>, S2, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;_&amp;#39;&lt;/span>, S1, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;_&amp;#39;&lt;/span>, val_str, cutoff_str, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;.csv&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f">#write.csv(sig_res, file = sig_res_file)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>print(paste0(S2, &lt;span style="color:#0ff;font-weight:bold">&amp;#39; vs &amp;#39;&lt;/span>, S1, &lt;span style="color:#0ff;font-weight:bold">&amp;#39; | &amp;#39;&lt;/span>, val_str, &lt;span style="color:#0ff;font-weight:bold">&amp;#39;&amp;lt;&amp;#39;&lt;/span>, cutoff_str))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sig_idx &amp;lt;- res$padj &amp;lt; cutoff &amp;amp; !is.na(res$padj)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sig_dat &amp;lt;- assay(rld)[sig_idx, ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>annC &amp;lt;- data.frame(condition = conditions)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>rownames(annC) &amp;lt;- colnames(sig_dat)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>heat_colors &amp;lt;- brewer.pal(&lt;span style="color:#ff0;font-weight:bold">6&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#34;RdYlGn&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>heat_colors_reversed &amp;lt;- rev(heat_colors)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ann_colors &amp;lt;- list(condition = setNames(c(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;#F7819F&amp;#34;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#34;#58D3F7&amp;#34;&lt;/span>), c(S2, S1)))
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-plain" data-lang="plain">&lt;span style="display:flex;">&lt;span>A data.frame: 6 x 2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Sample	group
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;chr&amp;gt;	&amp;lt;fct&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>150-1	150
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>150-2	150
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>150-3	150
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>33-1	33
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>33-2	33
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>33-3	33
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>DataFrame with 6 rows and 2 columns
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Sample group
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;character&amp;gt; &amp;lt;factor&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>150-1 150-1 150
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>150-2 150-2 150
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>150-3 150-3 150
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>33-1 33-1 33 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>33-2 33-2 33 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>33-3 33-3 33
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>estimating size factors
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>estimating dispersions
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>gene-wise dispersion estimates
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mean-dispersion relationship
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>final dispersion estimates
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>fitting model and testing
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>log2 fold change (MLE): group 150 vs 33 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Wald test p-value: group 150 vs 33 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>DataFrame with 205 rows and 6 columns
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> baseMean log2FoldChange lfcSE stat pvalue padj
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;numeric&amp;gt; &amp;lt;numeric&amp;gt; &amp;lt;numeric&amp;gt; &amp;lt;numeric&amp;gt; &amp;lt;numeric&amp;gt; &amp;lt;numeric&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ABHD2 50.721 1.352060 0.431587 3.13276 1.73168e-03 4.00143e-02
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ADAM12 706.120 -0.571960 0.168494 -3.39454 6.87431e-04 2.03489e-02
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ADD2 1819.643 0.868228 0.148791 5.83521 5.37230e-09 9.73246e-07
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>AIF1L 144.513 1.168923 0.283764 4.11935 3.79938e-05 2.07318e-03
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>AKAP5 1042.005 -0.637445 0.202189 -3.15271 1.61761e-03 3.81572e-02
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>... ... ... ... ... ... ...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ZNF655 774.2459 -0.910286 0.198632 -4.58277 4.58855e-06 3.52229e-04
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ZNF682 59.7573 -1.382049 0.438336 -3.15295 1.61632e-03 3.81572e-02
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ZNF77 76.0271 -1.231188 0.388382 -3.17004 1.52417e-03 3.71126e-02
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ZRANB3 536.2301 -0.878732 0.179932 -4.88367 1.04128e-06 9.22422e-05
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ZSCAN25 1257.3596 -0.460023 0.149161 -3.08408 2.04184e-03 4.57797e-02
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[1] &amp;#34;150 vs 33 | padj&amp;lt;0.05&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://github.com/user-attachments/assets/03bdf961-8b66-4321-89ce-9fa7f5c88849" alt="image" />&lt;/p></description></item><item><title>EBV RNA-seq 전처리</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi11/</link><pubDate>Tue, 31 Dec 2024 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi11/</guid><description>&lt;h1 id="ebv-rna-seq-전처리">
 EBV RNA-seq 전처리
 &lt;a class="anchor" href="#ebv-rna-seq-%ec%a0%84%ec%b2%98%eb%a6%ac">#&lt;/a>
&lt;/h1>
&lt;p>#2024-12-31&lt;/p>
&lt;hr>
&lt;ul>
&lt;li>
&lt;p>분석 목적&lt;/p>
&lt;ul>
&lt;li>제공받은 fastq를 human genome에 매핑해서 전처리, 분석 후 DE 결과 보냄&lt;/li>
&lt;li>DE 분석시에 EBV 유전자도 포함해달라는 요청&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>해야하는것&lt;/p>
&lt;ul>
&lt;li>fastq를 EBV genome에 매핑해서 전처리, EBV count 생성&lt;/li>
&lt;li>human count에 EBV count를 붙이기&lt;/li>
&lt;li>통합 count로 DE 분석 재수행&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="1-alignment">
 1. Alignment
 &lt;a class="anchor" href="#1-alignment">#&lt;/a>
&lt;/h2>
&lt;h3 id="load-package-set-path">
 Load package, Set Path
 &lt;a class="anchor" href="#load-package-set-path">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-R" data-lang="R">&lt;span style="display:flex;">&lt;span>library(edgeR)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>library(Rsubread)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>library(org.Hs.eg.db)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>setwd(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;/data/home/ysh980101/2311/RNA-seq_ebv/Rsubread&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>getwd()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-plain" data-lang="plain">&lt;span style="display:flex;">&lt;span>&amp;#39;/data1/home/ysh980101/2311/RNA-seq_ebv/Rsubread&amp;#39;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="build-index">
 Build Index
 &lt;a class="anchor" href="#build-index">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-R" data-lang="R">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># build index&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ref &amp;lt;- &lt;span style="color:#0ff;font-weight:bold">&amp;#34;/data3/PUBLIC_DATA/ref_genomes/Human_gammaherpesvirus_4_EBV/NC_007605.1.fa&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>output_basename &amp;lt;- &lt;span style="color:#0ff;font-weight:bold">&amp;#34;NC_007605.1_idx&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>buildindex(basename = output_basename, reference = ref)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="feature-count">
 Feature Count
 &lt;a class="anchor" href="#feature-count">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-R" data-lang="R">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#007f7f"># feature.count&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>targets &amp;lt;- read.delim(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;targets.txt&amp;#34;&lt;/span>, header=&lt;span style="color:#fff;font-weight:bold">TRUE&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>output.files &amp;lt;- c(targets$FileName)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>fc &amp;lt;- featureCounts(output.files, annot.inbuilt=&lt;span style="color:#fff;font-weight:bold">FALSE&lt;/span>, annot.ext = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;/data3/PUBLIC_DATA/ref_genomes/Human_gammaherpesvirus_4_EBV/NC_007605.1.gtf&amp;#34;&lt;/span>, isGTFAnnotationFile = &lt;span style="color:#fff;font-weight:bold">TRUE&lt;/span>, 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> GTF.featureType = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;exon&amp;#34;&lt;/span>, GTF.attrType = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;transcript_id&amp;#34;&lt;/span>, GTF.attrType.extra = &lt;span style="color:#fff;font-weight:bold">NULL&lt;/span>, isPairedEnd=&lt;span style="color:#fff;font-weight:bold">TRUE&lt;/span>, countReadPairs=&lt;span style="color:#fff;font-weight:bold">TRUE&lt;/span>)&lt;span style="color:#007f7f"># nthreads=30)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="save">
 Save
 &lt;a class="anchor" href="#save">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-R" data-lang="R">&lt;span style="display:flex;">&lt;span>colnames(fc$counts) &amp;lt;- c(&lt;span style="color:#0ff;font-weight:bold">&amp;#39;33-1&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;33-2&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;33-3&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;150-1&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;150-2&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;150-3&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;con-1&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;con-2&amp;#39;&lt;/span>,&lt;span style="color:#0ff;font-weight:bold">&amp;#39;con-3&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>head(fc$counts)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>group &amp;lt;- factor(targets$Status)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>y &amp;lt;- DGEList(fc$counts, group=group)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>fc$sort.counts &amp;lt;- fc$counts[order(rownames(fc$counts)), ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sort.counts.df &amp;lt;- as.data.frame(fc$sort.counts)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sort.counts.df$trans_id &amp;lt;- rownames(fc$sort.counts)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sort.counts.df &amp;lt;- sort.counts.df[, c(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;trans_id&amp;#34;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#34;33-1&amp;#34;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#34;33-2&amp;#34;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#34;33-3&amp;#34;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#34;150-1&amp;#34;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#34;150-2&amp;#34;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#34;150-3&amp;#34;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#34;con-1&amp;#34;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#34;con-2&amp;#34;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#34;con-3&amp;#34;&lt;/span>)]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>write.table(sort.counts.df, file = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;count.tsv&amp;#34;&lt;/span>, sep = &lt;span style="color:#0ff;font-weight:bold">&amp;#34;\t&amp;#34;&lt;/span>, quote = &lt;span style="color:#fff;font-weight:bold">FALSE&lt;/span>, row.names = &lt;span style="color:#fff;font-weight:bold">FALSE&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="2-annotation">
 2. Annotation
 &lt;a class="anchor" href="#2-annotation">#&lt;/a>
&lt;/h2>
&lt;h3 id="load-package">
 Load Package
 &lt;a class="anchor" href="#load-package">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">import&lt;/span> os
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#fff;font-weight:bold">import&lt;/span> pandas &lt;span style="color:#fff;font-weight:bold">as&lt;/span> pd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="set-path">
 Set Path
 &lt;a class="anchor" href="#set-path">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>os.chdir(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;/data/home/ysh980101/2311/RNA-seq_ebv/Rsubread&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>os.getcwd()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-plain" data-lang="plain">&lt;span style="display:flex;">&lt;span>&amp;#39;/data1/home/ysh980101/2311/RNA-seq_ebv/Rsubread&amp;#39;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="load-gtf-file">
 Load GTF file
 &lt;a class="anchor" href="#load-gtf-file">#&lt;/a>
&lt;/h3>
&lt;ul>
&lt;li>annotation 파일이 없어서 gtf reference 파일을 사용해서 직접 만들어줫다.&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>gtf_df = pd.read_csv(&lt;span style="color:#0ff;font-weight:bold">&amp;#34;/data3/PUBLIC_DATA/ref_genomes/Human_gammaherpesvirus_4_EBV/NC_007605.1.gtf&amp;#34;&lt;/span>, sep=&lt;span style="color:#0ff;font-weight:bold">&amp;#39;&lt;/span>&lt;span style="color:#0ff;font-weight:bold">\t&lt;/span>&lt;span style="color:#0ff;font-weight:bold">&amp;#39;&lt;/span>, header=&lt;span style="color:#fff;font-weight:bold">None&lt;/span>, comment=&lt;span style="color:#0ff;font-weight:bold">&amp;#34;#&amp;#34;&lt;/span>, names=[&lt;span style="color:#0ff;font-weight:bold">&amp;#34;seqname&amp;#34;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#34;source&amp;#34;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#34;feature&amp;#34;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#34;start&amp;#34;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#34;end&amp;#34;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#34;score&amp;#34;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#34;strand&amp;#34;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#34;frame&amp;#34;&lt;/span>, &lt;span style="color:#0ff;font-weight:bold">&amp;#34;attribute&amp;#34;&lt;/span>])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>gtf_df
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://github.com/user-attachments/assets/26526e85-9631-47b0-bcf8-a3e37da66d22" alt="image" />&lt;/p></description></item><item><title>한국과학기술원 기간제 근로자(연수연구원) 모집</title><link>https://yshghid.github.io/docs/study/bioinformatics/bi20/</link><pubDate>Tue, 10 Jan 2023 00:00:00 +0000</pubDate><guid>https://yshghid.github.io/docs/study/bioinformatics/bi20/</guid><description>&lt;h1 id="한국과학기술원-기간제-근로자연수연구원-모집">
 한국과학기술원 기간제 근로자(연수연구원) 모집
 &lt;a class="anchor" href="#%ed%95%9c%ea%b5%ad%ea%b3%bc%ed%95%99%ea%b8%b0%ec%88%a0%ec%9b%90-%ea%b8%b0%ea%b0%84%ec%a0%9c-%ea%b7%bc%eb%a1%9c%ec%9e%90%ec%97%b0%ec%88%98%ec%97%b0%ea%b5%ac%ec%9b%90-%eb%aa%a8%ec%a7%91">#&lt;/a>
&lt;/h1>
&lt;p>연구 &amp;gt; 연수연구원/IT융합연구소&lt;/p>
&lt;p>&lt;img src="https://github.com/user-attachments/assets/0d47d880-7beb-4ccc-9b42-f5ac49317eb6" alt="image" />&lt;/p>
&lt;p>연구 &amp;gt; 연수연구원/강화학습(정보전자연구소G)&lt;/p>
&lt;p>&lt;img src="https://github.com/user-attachments/assets/9fb2153f-6ce9-4bde-bc12-c2884d5dabc6" alt="image" />&lt;/p>
&lt;p>연구 &amp;gt; 연수연구원/생명과학(생명과학연구소G)&lt;/p>
&lt;p>&lt;img src="https://github.com/user-attachments/assets/28eec9e2-6de8-43f8-8398-b4106bb1610d" alt="image" />&lt;/p>
&lt;p>연구 &amp;gt; 연수연구원/시스템생물학(정보전자연구소C)&lt;/p>
&lt;p>&lt;img src="https://github.com/user-attachments/assets/10f39afb-f4b5-457d-9c11-cca5a26a667c" alt="image" />&lt;/p>
&lt;p>연구 &amp;gt; 연수연구원/신경과학,인지과학,뇌과학 및뇌공학(생명과학연구소A)&lt;/p>
&lt;p>&lt;img src="https://github.com/user-attachments/assets/49dece26-c646-4cf9-ab7a-cd709b8a2ba0" alt="image" />&lt;/p>
&lt;p>&lt;a href="https://www.ncs.go.kr/blind/bl04/RecrtNotifDetail.do?recrtNo=20230206153157">공고 바로가기&lt;/a>&lt;/p></description></item></channel></rss>