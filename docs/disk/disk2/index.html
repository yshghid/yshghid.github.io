<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="다까먹고 나서 복습하는 트랜스포머 # 2025-02-01 # 셀프 어텐션은 입력 단어 사이 연관성을 어텐션 점수로 계산하는 것. 입력 단어를 Q, K, V벡터로 변환하고, Q와 K벡터의 내적을 구하고, 소프트맥스를 적용하여 확률로 변환하고, V벡터를 이 확률로 가중합하여 최종 어텐션 점수를 얻는다. 단어 간의 관계는 여러 종류가 있는데 1개의 헤드를 사용하면 1가지 관계만 학습될것임. 멀티 헤드 어텐션을 수행해서 다양한 관계 패턴을 동시에 학습한다. 관계의 종류로는 문법적 관계(cat-sat은 주어-동사), 의미적 관계(cat-mat은 동물-사물이 놓인곳), 위치적 관계(on-mat)가 있다.">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1313/docs/disk/disk2/">
  <meta property="og:site_name" content="Lifelog 2025">
  <meta property="og:title" content="◡̈⋆*">
  <meta property="og:description" content="다까먹고 나서 복습하는 트랜스포머 # 2025-02-01 # 셀프 어텐션은 입력 단어 사이 연관성을 어텐션 점수로 계산하는 것. 입력 단어를 Q, K, V벡터로 변환하고, Q와 K벡터의 내적을 구하고, 소프트맥스를 적용하여 확률로 변환하고, V벡터를 이 확률로 가중합하여 최종 어텐션 점수를 얻는다. 단어 간의 관계는 여러 종류가 있는데 1개의 헤드를 사용하면 1가지 관계만 학습될것임. 멀티 헤드 어텐션을 수행해서 다양한 관계 패턴을 동시에 학습한다. 관계의 종류로는 문법적 관계(cat-sat은 주어-동사), 의미적 관계(cat-mat은 동물-사물이 놓인곳), 위치적 관계(on-mat)가 있다.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
<title>◡̈⋆* | Lifelog 2025</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="http://localhost:1313/docs/disk/disk2/">
<link rel="stylesheet" href="/book.min.b79d7c33395061c8f79ecaf2ed506fabfbb4f7a048c6bf40218447335d11296c.css" integrity="sha256-t518MzlQYcj3nsry7VBvq/u096BIxr9AIYRHM10RKWw=" crossorigin="anonymous">
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.f0c786e8de337f1d5cedae844197e67ac614981be1a280842a54f24d58bdfc95.js" integrity="sha256-8MeG6N4zfx1c7a6EQZfmesYUmBvhooCEKlTyTVi9/JU=" crossorigin="anonymous"></script>

  

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><img src="/logo.png" alt="Logo" class="book-icon" /><span>Lifelog 2025</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>















  
  <ul>
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>기록</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/hobby/book/" class="">책</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/hobby/movie/" class="">영화</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/hobby/study/" class="">공부</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/hobby/daily/" class="">일상</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/disk/" class="">◡̈⋆*</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/about/" class=""> </a>
  

        </li>
      
    
  </ul>










  
<ul>
  
  <li>
    <a href="/posts/"  >
        아카이브
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>◡̈⋆*</h3>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#다까먹고-나서-복습하는-트랜스포머">다까먹고 나서 복습하는 트랜스포머</a>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h2 id="다까먹고-나서-복습하는-트랜스포머">
  다까먹고 나서 복습하는 트랜스포머
  <a class="anchor" href="#%eb%8b%a4%ea%b9%8c%eb%a8%b9%ea%b3%a0-%eb%82%98%ec%84%9c-%eb%b3%b5%ec%8a%b5%ed%95%98%eb%8a%94-%ed%8a%b8%eb%9e%9c%ec%8a%a4%ed%8f%ac%eb%a8%b8">#</a>
</h2>
<h5 id="2025-02-01">
  2025-02-01
  <a class="anchor" href="#2025-02-01">#</a>
</h5>
<hr>
<p>셀프 어텐션은 입력 단어 사이 연관성을 어텐션 점수로 계산하는 것. 입력 단어를 Q, K, V벡터로 변환하고, Q와 K벡터의 내적을 구하고, 소프트맥스를 적용하여 확률로 변환하고, V벡터를 이 확률로 가중합하여 최종 어텐션 점수를 얻는다. 단어 간의 관계는 여러 종류가 있는데 1개의 헤드를 사용하면 1가지 관계만 학습될것임. 멀티 헤드 어텐션을 수행해서 다양한 관계 패턴을 동시에 학습한다. 관계의 종류로는 문법적 관계(cat-sat은 주어-동사), 의미적 관계(cat-mat은 동물-사물이 놓인곳), 위치적 관계(on-mat)가 있다. 각 헤드에서 나온 결과를 병합하고 최종 선형 변환해서 하나의 벡터를 얻는다.</p>
<p>단어의 임베딩 벡터 + sin/cos으로 계산된 위치 인코딩 = 최종 입력 벡터. 이 작업을 Residual Connection라고 함. Residual Connection하고 Layer Normalization 해준다. 그래야 기울기 소실이나 기울기 폭발이 일어나지 않는다. 위 입력 벡터를 FFN이 받아서 선현 변환 -&gt; ReLU 활성화 함수 적용 -&gt; 선형 변환 -&gt; 출력.</p>
<p>핵심 연산은 MMS. 똑같이 Q,K,V벡터로 변환하고 어텐션 스코어 계산하고, 마스킹할 단어의 스코어를 −∞로 설정하여 Softmax에서 0이 되게 해서 최종 출력 벡터 생성한다. 다음으로 인코더에서 나온 K, V벡터와 디코더에서 나온 Q벡터를 활용해서 multi head attention을 수행한다. 이를 cross attention이라고 하는데 이를 통해서 디코더가 인코더의 정보를 반영해서 다음 토큰을 예측할수있게 한다.</p>
<p>다음으로 FFN. 두개의 완전 연결층으로 구성. 입력 -&gt; 중간차원 -&gt; 활성화함수 ReLU or GELU -&gt; 출력. 다음으로 똑같이 Residual Connection하고 Layer Normalization 해준다. 마지막 디코더 블록에서 나온 결과는 완전 연결층(dense layer)을 거쳐 변환 -&gt; softmax를 적용해서 단어 확률 분포 계산 -&gt; 가장 확률이 높은 단어를 출력함.</p>
<blockquote>
<p>구글 BERT의 정석 - 트랜스포머 입문 <a href="%28https://yshghid.github.io/docs/study/cs/cs15/%29"><strong>바로가기</strong></a></p>
</blockquote>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments"><script src="https://giscus.app/client.js"
        data-repo="yshghid/yshghid.github.io"
        data-repo-id="R_kgDONkMkNg"
        data-category-id="DIC_kwDONkMkNs4CloJh"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="ko"
        crossorigin="anonymous"
        async>
</script>
</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#다까먹고-나서-복습하는-트랜스포머">다까먹고 나서 복습하는 트랜스포머</a>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












