<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  #2 중요도 지표 계산
  #

#2025-06-20


  1. Load package
  #

import pandas as pd
import numpy as np
import os
os.sys.path.append(&#34;/data/home/ysh980101/2407/Mutclust&#34;) 

from pathlib import Path
from Bin.Utils.utils import *
from Bin.arg_parser import *
from Bin.mlib import *

  2. Load GISAID data
  #

indir = &#34;/data/home/ysh980101/2407/Mutclust/Testdata/Input/&#34;

Refseq = getNucleotideRefSeq()
GISAID_Freq = pd.read_csv(f'{indir}gisaid_freq_all.csv', index_col=0)
GISAID_meta = get_GISAID_meta()
print(GISAID_Freq)
           A    C    G      T   R   Y   S   W   K   M  B  D  H  V       N
1      10612  390  415    785  11   1   3   4  24   2  1  2  0  0  219995
2        287  502  218  12942   3  31  14   4  61   0  1  2  1  0  218179
3        166  461  348  18168   1  12  29  10  15   1  0  1  1  0  213032
4      19398  267  502    972  12   5   1  33  37   6  1  1  0  1  211009
5      24962  281  334    699   6  21   6  17  15  10  5  1  1  1  205886
...      ...  ...  ...    ...  ..  ..  ..  ..  ..  .. .. .. .. ..     ...
29899  41707   36   38    100   1   0   2   5   0   3  0  0  1  0  190351
29900  40483   30   25     99   8   1   0   2   1   4  0  1  0  0  191590
29901  39258   25   19     22   1   0   0   4   1   1  0  0  0  0  192913
29902  38015   23   22     19   1   0   0   5   0   1  0  0  0  0  194158
29903  34729   18   32     99   0   3   0   4   0   3  0  0  1  0  197355

[29903 rows x 15 columns]

  3. Calculate H-score
  #

def calculate_hscore(Refseq, Freq, N):
    freq_df = Freq[['A','T','G','C']].copy()
    for i,row in enumerate(Refseq):
        freq_df.iloc[i][row] = 0

    per_df = freq_df.apply(lambda row: row/row.sum(), axis=1)
    per_df = per_df.fillna(0)
    ent_df = per_df.apply(lambda row: entropy(row, base=2), axis = 1)
    ent_df = ent_df.fillna(0)

    count_df = freq_df.apply(lambda row: row.sum(), axis=1)
    ratio_df = freq_df.apply(lambda row: row.sum()/N, axis=1)
    hscore_df = np.log2(ratio_df*ent_df*100+1)

    Input_df = pd.concat([count_df, ratio_df, ent_df, hscore_df], axis=1, keys=[FREQ, PER, ENT, HSCORE])
    Input_df = Input_df.reset_index()
    Input_df = Input_df.rename(columns={'index': POS})  
    
    return Input_df
N = len(GISAID_meta)

Input_df = calculate_hscore(Refseq, GISAID_Freq, N)
print(Input_df)
       Position  Frequency  Percentage   Entropy   H-score
0             1       1590    0.007088  1.505823  1.047783
1             2       1007    0.004489  1.494709  0.740711
2             3        975    0.004347  1.476319  0.715176
3             4       1741    0.007761  1.401635  1.062019
4             5       1314    0.005858  1.462576  0.892773
...         ...        ...         ...       ...       ...
29898     29899        174    0.000776  1.408897  0.149631
29899     29900        154    0.000687  1.295297  0.122905
29900     29901         66    0.000294  1.575992  0.065393
29901     29902         64    0.000285  1.580312  0.063624
29902     29903        149    0.000664  1.236853  0.113909

[29903 rows x 5 columns]

  4. Save
  #

Input_df.to_pickle(f&#34;{indir}GISAID_total.pickle&#34;)
"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://yshghid.github.io/docs/study/tech/tech30/"><meta property="og:site_name" content=" "><meta property="og:title" content="#2 중요도 지표 계산"><meta property="og:description" content="#2 중요도 지표 계산 # #2025-06-20
1. Load package # import pandas as pd import numpy as np import os os.sys.path.append(&#34;/data/home/ysh980101/2407/Mutclust&#34;) from pathlib import Path from Bin.Utils.utils import * from Bin.arg_parser import * from Bin.mlib import * 2. Load GISAID data # indir = &#34;/data/home/ysh980101/2407/Mutclust/Testdata/Input/&#34; Refseq = getNucleotideRefSeq() GISAID_Freq = pd.read_csv(f'{indir}gisaid_freq_all.csv', index_col=0) GISAID_meta = get_GISAID_meta() print(GISAID_Freq) A C G T R Y S W K M B D H V N 1 10612 390 415 785 11 1 3 4 24 2 1 2 0 0 219995 2 287 502 218 12942 3 31 14 4 61 0 1 2 1 0 218179 3 166 461 348 18168 1 12 29 10 15 1 0 1 1 0 213032 4 19398 267 502 972 12 5 1 33 37 6 1 1 0 1 211009 5 24962 281 334 699 6 21 6 17 15 10 5 1 1 1 205886 ... ... ... ... ... .. .. .. .. .. .. .. .. .. .. ... 29899 41707 36 38 100 1 0 2 5 0 3 0 0 1 0 190351 29900 40483 30 25 99 8 1 0 2 1 4 0 1 0 0 191590 29901 39258 25 19 22 1 0 0 4 1 1 0 0 0 0 192913 29902 38015 23 22 19 1 0 0 5 0 1 0 0 0 0 194158 29903 34729 18 32 99 0 3 0 4 0 3 0 0 1 0 197355 [29903 rows x 15 columns] 3. Calculate H-score # def calculate_hscore(Refseq, Freq, N): freq_df = Freq[['A','T','G','C']].copy() for i,row in enumerate(Refseq): freq_df.iloc[i][row] = 0 per_df = freq_df.apply(lambda row: row/row.sum(), axis=1) per_df = per_df.fillna(0) ent_df = per_df.apply(lambda row: entropy(row, base=2), axis = 1) ent_df = ent_df.fillna(0) count_df = freq_df.apply(lambda row: row.sum(), axis=1) ratio_df = freq_df.apply(lambda row: row.sum()/N, axis=1) hscore_df = np.log2(ratio_df*ent_df*100+1) Input_df = pd.concat([count_df, ratio_df, ent_df, hscore_df], axis=1, keys=[FREQ, PER, ENT, HSCORE]) Input_df = Input_df.reset_index() Input_df = Input_df.rename(columns={'index': POS}) return Input_df N = len(GISAID_meta) Input_df = calculate_hscore(Refseq, GISAID_Freq, N) print(Input_df) Position Frequency Percentage Entropy H-score 0 1 1590 0.007088 1.505823 1.047783 1 2 1007 0.004489 1.494709 0.740711 2 3 975 0.004347 1.476319 0.715176 3 4 1741 0.007761 1.401635 1.062019 4 5 1314 0.005858 1.462576 0.892773 ... ... ... ... ... ... 29898 29899 174 0.000776 1.408897 0.149631 29899 29900 154 0.000687 1.295297 0.122905 29900 29901 66 0.000294 1.575992 0.065393 29901 29902 64 0.000285 1.580312 0.063624 29902 29903 149 0.000664 1.236853 0.113909 [29903 rows x 5 columns] 4. Save # Input_df.to_pickle(f&#34;{indir}GISAID_total.pickle&#34;)"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:published_time" content="2025-06-20T00:00:00+00:00"><meta property="article:modified_time" content="2025-06-20T00:00:00+00:00"><meta property="article:tag" content="2025-06"><title>#2 중요도 지표 계산 |</title><link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://yshghid.github.io/docs/study/tech/tech30/><link rel=stylesheet href=/book.min.6217d077edb4189fd0578345e84bca1a884dfdee121ff8dc9a0f55cfe0852bc9.css integrity="sha256-YhfQd+20GJ/QV4NF6EvKGohN/e4SH/jcmg9Vz+CFK8k=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.578a2d8e6e30e0a0ae3682797882d89ca0cbbf1734d206705396ea76cf57bbb6.js integrity="sha256-V4otjm4w4KCuNoJ5eILYnKDLvxc00gZwU5bqds9Xu7Y=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><img src=/logo.png alt=Logo class=book-icon><span></span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li class=book-section-flat><span>기록</span><ul><li><a href=/docs/hobby/book/>글</a><ul></ul></li><li><a href=/docs/hobby/daily/>일상</a><ul></ul></li></ul></li><li class=book-section-flat><span>공부</span><ul><li><a href=/docs/study/bioinformatics/>Bioinformatics</a><ul></ul></li><li><a href=/docs/study/ai/>AI</a><ul></ul></li><li><a href=/docs/study/sw/>SW</a><ul></ul></li><li><a href=/docs/study/algorithm/>알고리즘</a><ul></ul></li><li><a href=/docs/study/career/>취업</a><ul></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>#2 중요도 지표 계산</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#1-load-package>1. Load package</a></li><li><a href=#2-load-gisaid-data>2. Load GISAID data</a></li><li><a href=#3-calculate-h-score>3. Calculate H-score</a></li><li><a href=#4-save>4. Save</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=2-중요도-지표-계산>#2 중요도 지표 계산
<a class=anchor href=#2-%ec%a4%91%ec%9a%94%eb%8f%84-%ec%a7%80%ed%91%9c-%ea%b3%84%ec%82%b0>#</a></h1><p>#2025-06-20</p><hr><h3 id=1-load-package>1. Load package
<a class=anchor href=#1-load-package>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>sys</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s2>&#34;/data/home/ysh980101/2407/Mutclust&#34;</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pathlib</span> <span class=kn>import</span> <span class=n>Path</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Bin.Utils.utils</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Bin.arg_parser</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Bin.mlib</span> <span class=kn>import</span> <span class=o>*</span>
</span></span></code></pre></div><h3 id=2-load-gisaid-data>2. Load GISAID data
<a class=anchor href=#2-load-gisaid-data>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>indir</span> <span class=o>=</span> <span class=s2>&#34;/data/home/ysh980101/2407/Mutclust/Testdata/Input/&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Refseq</span> <span class=o>=</span> <span class=n>getNucleotideRefSeq</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>GISAID_Freq</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>indir</span><span class=si>}</span><span class=s1>gisaid_freq_all.csv&#39;</span><span class=p>,</span> <span class=n>index_col</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>GISAID_meta</span> <span class=o>=</span> <span class=n>get_GISAID_meta</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>GISAID_Freq</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>           A    C    G      T   R   Y   S   W   K   M  B  D  H  V       N
</span></span><span class=line><span class=cl>1      10612  390  415    785  11   1   3   4  24   2  1  2  0  0  219995
</span></span><span class=line><span class=cl>2        287  502  218  12942   3  31  14   4  61   0  1  2  1  0  218179
</span></span><span class=line><span class=cl>3        166  461  348  18168   1  12  29  10  15   1  0  1  1  0  213032
</span></span><span class=line><span class=cl>4      19398  267  502    972  12   5   1  33  37   6  1  1  0  1  211009
</span></span><span class=line><span class=cl>5      24962  281  334    699   6  21   6  17  15  10  5  1  1  1  205886
</span></span><span class=line><span class=cl>...      ...  ...  ...    ...  ..  ..  ..  ..  ..  .. .. .. .. ..     ...
</span></span><span class=line><span class=cl>29899  41707   36   38    100   1   0   2   5   0   3  0  0  1  0  190351
</span></span><span class=line><span class=cl>29900  40483   30   25     99   8   1   0   2   1   4  0  1  0  0  191590
</span></span><span class=line><span class=cl>29901  39258   25   19     22   1   0   0   4   1   1  0  0  0  0  192913
</span></span><span class=line><span class=cl>29902  38015   23   22     19   1   0   0   5   0   1  0  0  0  0  194158
</span></span><span class=line><span class=cl>29903  34729   18   32     99   0   3   0   4   0   3  0  0  1  0  197355
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[29903 rows x 15 columns]
</span></span></code></pre></div><h3 id=3-calculate-h-score>3. Calculate H-score
<a class=anchor href=#3-calculate-h-score>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>calculate_hscore</span><span class=p>(</span><span class=n>Refseq</span><span class=p>,</span> <span class=n>Freq</span><span class=p>,</span> <span class=n>N</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>freq_df</span> <span class=o>=</span> <span class=n>Freq</span><span class=p>[[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span><span class=s1>&#39;T&#39;</span><span class=p>,</span><span class=s1>&#39;G&#39;</span><span class=p>,</span><span class=s1>&#39;C&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span><span class=n>row</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>Refseq</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>freq_df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>row</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>per_df</span> <span class=o>=</span> <span class=n>freq_df</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>row</span><span class=p>:</span> <span class=n>row</span><span class=o>/</span><span class=n>row</span><span class=o>.</span><span class=n>sum</span><span class=p>(),</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>per_df</span> <span class=o>=</span> <span class=n>per_df</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ent_df</span> <span class=o>=</span> <span class=n>per_df</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>row</span><span class=p>:</span> <span class=n>entropy</span><span class=p>(</span><span class=n>row</span><span class=p>,</span> <span class=n>base</span><span class=o>=</span><span class=mi>2</span><span class=p>),</span> <span class=n>axis</span> <span class=o>=</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ent_df</span> <span class=o>=</span> <span class=n>ent_df</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>count_df</span> <span class=o>=</span> <span class=n>freq_df</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>row</span><span class=p>:</span> <span class=n>row</span><span class=o>.</span><span class=n>sum</span><span class=p>(),</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ratio_df</span> <span class=o>=</span> <span class=n>freq_df</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>row</span><span class=p>:</span> <span class=n>row</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=o>/</span><span class=n>N</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>hscore_df</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>log2</span><span class=p>(</span><span class=n>ratio_df</span><span class=o>*</span><span class=n>ent_df</span><span class=o>*</span><span class=mi>100</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Input_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>count_df</span><span class=p>,</span> <span class=n>ratio_df</span><span class=p>,</span> <span class=n>ent_df</span><span class=p>,</span> <span class=n>hscore_df</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>keys</span><span class=o>=</span><span class=p>[</span><span class=n>FREQ</span><span class=p>,</span> <span class=n>PER</span><span class=p>,</span> <span class=n>ENT</span><span class=p>,</span> <span class=n>HSCORE</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>Input_df</span> <span class=o>=</span> <span class=n>Input_df</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>Input_df</span> <span class=o>=</span> <span class=n>Input_df</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;index&#39;</span><span class=p>:</span> <span class=n>POS</span><span class=p>})</span>  
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>Input_df</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>N</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>GISAID_meta</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Input_df</span> <span class=o>=</span> <span class=n>calculate_hscore</span><span class=p>(</span><span class=n>Refseq</span><span class=p>,</span> <span class=n>GISAID_Freq</span><span class=p>,</span> <span class=n>N</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>Input_df</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>       Position  Frequency  Percentage   Entropy   H-score
</span></span><span class=line><span class=cl>0             1       1590    0.007088  1.505823  1.047783
</span></span><span class=line><span class=cl>1             2       1007    0.004489  1.494709  0.740711
</span></span><span class=line><span class=cl>2             3        975    0.004347  1.476319  0.715176
</span></span><span class=line><span class=cl>3             4       1741    0.007761  1.401635  1.062019
</span></span><span class=line><span class=cl>4             5       1314    0.005858  1.462576  0.892773
</span></span><span class=line><span class=cl>...         ...        ...         ...       ...       ...
</span></span><span class=line><span class=cl>29898     29899        174    0.000776  1.408897  0.149631
</span></span><span class=line><span class=cl>29899     29900        154    0.000687  1.295297  0.122905
</span></span><span class=line><span class=cl>29900     29901         66    0.000294  1.575992  0.065393
</span></span><span class=line><span class=cl>29901     29902         64    0.000285  1.580312  0.063624
</span></span><span class=line><span class=cl>29902     29903        149    0.000664  1.236853  0.113909
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[29903 rows x 5 columns]
</span></span></code></pre></div><h3 id=4-save>4. Save
<a class=anchor href=#4-save>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>Input_df</span><span class=o>.</span><span class=n>to_pickle</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>indir</span><span class=si>}</span><span class=s2>GISAID_total.pickle&#34;</span><span class=p>)</span>
</span></span></code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments><script src=https://giscus.app/client.js data-repo=yshghid/yshghid.github.io data-repo-id=R_kgDONkMkNg data-category-id=DIC_kwDONkMkNs4CloJh data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=ko crossorigin=anonymous async></script></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#1-load-package>1. Load package</a></li><li><a href=#2-load-gisaid-data>2. Load GISAID data</a></li><li><a href=#3-calculate-h-score>3. Calculate H-score</a></li><li><a href=#4-save>4. Save</a></li></ul></li></ul></nav></div></aside></main></body></html>