<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content='
  #1 DBSCAN
  #

#2025-06-25


  ê°œë…
  #

DBSCANì€ ë°€ë„ ê¸°ë°˜ í´ëŸ¬ìŠ¤í„°ë§ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ

ë°ì´í„°ê°€ ë°€ì§‘ëœ ì˜ì—­ì„ í´ëŸ¬ìŠ¤í„°ë¡œ ì¸ì‹í•˜ê³ 
ë°€ë„ê°€ ë‚®ì€ ì˜ì—­ì€ ë…¸ì´ì¦ˆ(ì´ìƒì¹˜)ë¡œ ê°„ì£¼í•˜ëŠ” ë°©ë²•.

KMeansì™€ ë‹¬ë¦¬, êµ°ì§‘ ìˆ˜ë¥¼ ë¯¸ë¦¬ ì •í•˜ì§€ ì•Šì•„ë„ ë˜ë©°,

ë¹„ì„ í˜• êµ¬ì¡°ë‚˜ ì¡ìŒì´ ìˆëŠ” ë°ì´í„°ì—ì„œ ì˜ ì‘ë™í•œë‹¤.


  íŒŒë¼ë¯¸í„°ì™€ í•µì‹¬ ìš©ì–´
  #

ì£¼ìš” íŒŒë¼ë¯¸í„°ëŠ” 2ê°œ

eps: ë°˜ì§€ë¦„ ê±°ë¦¬. í•œ ì ì—ì„œ eps ê±°ë¦¬ ë‚´ì— ìˆëŠ” ì ë“¤ì„ &ldquo;ì´ì›ƒ"ì´ë¼ê³  íŒë‹¨.
min_samples: core pointë¡œ ì¸ì •ë˜ê¸° ìœ„í•´ í•„ìš”í•œ ìµœì†Œ ì´ì›ƒ ìˆ˜

í•µì‹¬ ìš©ì–´ëŠ” 3ê°œ'><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://yshghid.github.io/docs/study/etc/etc1/"><meta property="og:site_name" content="Lifelog 2025"><meta property="og:title" content="#1 DBSCAN"><meta property="og:description" content='#1 DBSCAN # #2025-06-25
ê°œë… # DBSCANì€ ë°€ë„ ê¸°ë°˜ í´ëŸ¬ìŠ¤í„°ë§ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ
ë°ì´í„°ê°€ ë°€ì§‘ëœ ì˜ì—­ì„ í´ëŸ¬ìŠ¤í„°ë¡œ ì¸ì‹í•˜ê³  ë°€ë„ê°€ ë‚®ì€ ì˜ì—­ì€ ë…¸ì´ì¦ˆ(ì´ìƒì¹˜)ë¡œ ê°„ì£¼í•˜ëŠ” ë°©ë²•. KMeansì™€ ë‹¬ë¦¬, êµ°ì§‘ ìˆ˜ë¥¼ ë¯¸ë¦¬ ì •í•˜ì§€ ì•Šì•„ë„ ë˜ë©°,
ë¹„ì„ í˜• êµ¬ì¡°ë‚˜ ì¡ìŒì´ ìˆëŠ” ë°ì´í„°ì—ì„œ ì˜ ì‘ë™í•œë‹¤. íŒŒë¼ë¯¸í„°ì™€ í•µì‹¬ ìš©ì–´ # ì£¼ìš” íŒŒë¼ë¯¸í„°ëŠ” 2ê°œ
eps: ë°˜ì§€ë¦„ ê±°ë¦¬. í•œ ì ì—ì„œ eps ê±°ë¦¬ ë‚´ì— ìˆëŠ” ì ë“¤ì„ â€œì´ì›ƒ"ì´ë¼ê³  íŒë‹¨. min_samples: core pointë¡œ ì¸ì •ë˜ê¸° ìœ„í•´ í•„ìš”í•œ ìµœì†Œ ì´ì›ƒ ìˆ˜ í•µì‹¬ ìš©ì–´ëŠ” 3ê°œ'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:published_time" content="2025-06-25T00:00:00+00:00"><meta property="article:modified_time" content="2025-06-25T00:00:00+00:00"><meta property="article:tag" content="2025-06"><title>#1 DBSCAN | Lifelog 2025</title><link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://yshghid.github.io/docs/study/etc/etc1/><link rel=stylesheet href=/book.min.6217d077edb4189fd0578345e84bca1a884dfdee121ff8dc9a0f55cfe0852bc9.css integrity="sha256-YhfQd+20GJ/QV4NF6EvKGohN/e4SH/jcmg9Vz+CFK8k=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.638f780875a95184805390f20ab5d46973689c62ab93f9548de8fba33cfa9f26.js integrity="sha256-Y494CHWpUYSAU5DyCrXUaXNonGKrk/lUjej7ozz6nyY=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><img src=/logo.png alt=Logo class=book-icon><span>Lifelog 2025</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li class=book-section-flat><span>ê¸°ë¡</span><ul><li><a href=/docs/hobby/book/>ê¸€</a><ul></ul></li><li><a href=/docs/hobby/daily/>ì¼ìƒ</a><ul></ul></li><li><a href=/docs/hobby/etc/>ê¸°íƒ€</a><ul></ul></li><li><a href=/docs/hobby/favorite/>ğŸ¤</a><ul></ul></li></ul></li><li class=book-section-flat><span>ê³µë¶€</span><ul><li><a href=/docs/study/tech/>ì—°êµ¬ì‹¤</a><ul></ul></li><li><a href=/docs/study/career/>ì·¨ì—…</a><ul></ul></li><li><a href=/docs/study/etc/>ê¸°íƒ€</a><ul></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>#1 DBSCAN</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#ê°œë…>ê°œë…</a></li><li><a href=#íŒŒë¼ë¯¸í„°ì™€-í•µì‹¬-ìš©ì–´>íŒŒë¼ë¯¸í„°ì™€ í•µì‹¬ ìš©ì–´</a></li><li><a href=#ì¥ì ê³¼-ë‹¨ì >ì¥ì ê³¼ ë‹¨ì </a></li><li><a href=#qa>Q&amp;A</a></li><li><a href=#ì„±ëŠ¥-í‰ê°€>ì„±ëŠ¥ í‰ê°€</a></li><li><a href=#íŒŒì´ì¬-êµ¬í˜„---dbscan>íŒŒì´ì¬ êµ¬í˜„ - DBSCAN</a></li><li><a href=#íŒŒì´ì¬-êµ¬í˜„---k-distance-plot>íŒŒì´ì¬ êµ¬í˜„ - k distance plot</a></li><li><a href=#íŒŒì´ì¬-êµ¬í˜„---silhouette-score>íŒŒì´ì¬ êµ¬í˜„ - silhouette score</a></li><li><a href=#ì „ì²´-íŒŒì´í”„ë¼ì¸-ì‹¤í–‰>ì „ì²´ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=1-dbscan>#1 DBSCAN
<a class=anchor href=#1-dbscan>#</a></h1><p>#2025-06-25</p><hr><h2 id=ê°œë…>ê°œë…
<a class=anchor href=#%ea%b0%9c%eb%85%90>#</a></h2><p>DBSCANì€ ë°€ë„ ê¸°ë°˜ í´ëŸ¬ìŠ¤í„°ë§ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ</p><ul><li>ë°ì´í„°ê°€ ë°€ì§‘ëœ ì˜ì—­ì„ í´ëŸ¬ìŠ¤í„°ë¡œ ì¸ì‹í•˜ê³ </li><li>ë°€ë„ê°€ ë‚®ì€ ì˜ì—­ì€ ë…¸ì´ì¦ˆ(ì´ìƒì¹˜)ë¡œ ê°„ì£¼í•˜ëŠ” ë°©ë²•.</li></ul><p>KMeansì™€ ë‹¬ë¦¬, êµ°ì§‘ ìˆ˜ë¥¼ ë¯¸ë¦¬ ì •í•˜ì§€ ì•Šì•„ë„ ë˜ë©°,</p><ul><li>ë¹„ì„ í˜• êµ¬ì¡°ë‚˜ ì¡ìŒì´ ìˆëŠ” ë°ì´í„°ì—ì„œ ì˜ ì‘ë™í•œë‹¤.</li></ul><h2 id=íŒŒë¼ë¯¸í„°ì™€-í•µì‹¬-ìš©ì–´>íŒŒë¼ë¯¸í„°ì™€ í•µì‹¬ ìš©ì–´
<a class=anchor href=#%ed%8c%8c%eb%9d%bc%eb%af%b8%ed%84%b0%ec%99%80-%ed%95%b5%ec%8b%ac-%ec%9a%a9%ec%96%b4>#</a></h2><p>ì£¼ìš” íŒŒë¼ë¯¸í„°ëŠ” 2ê°œ</p><ul><li>eps: ë°˜ì§€ë¦„ ê±°ë¦¬. í•œ ì ì—ì„œ eps ê±°ë¦¬ ë‚´ì— ìˆëŠ” ì ë“¤ì„ &ldquo;ì´ì›ƒ"ì´ë¼ê³  íŒë‹¨.</li><li>min_samples: core pointë¡œ ì¸ì •ë˜ê¸° ìœ„í•´ í•„ìš”í•œ ìµœì†Œ ì´ì›ƒ ìˆ˜</li></ul><p>í•µì‹¬ ìš©ì–´ëŠ” 3ê°œ</p><ul><li>Core Point (ì¤‘ì‹¬ì ): eps ê±°ë¦¬ ë‚´ì— min_samples ì´ìƒ ì´ì›ƒì´ ìˆëŠ” ì </li><li>Border Point (ê²½ê³„ì ): core pointì˜ eps ê±°ë¦¬ ë‚´ì— ìˆìœ¼ë‚˜, ìê¸° ìì‹ ì€ core pointê°€ ì•„ë‹Œ ì </li><li>Noise Point (ì¡ìŒì ): ì–´ë–¤ core pointì˜ eps ì•ˆì—ë„ í¬í•¨ë˜ì§€ ì•ŠëŠ” ì </li></ul><h2 id=ì¥ì ê³¼-ë‹¨ì >ì¥ì ê³¼ ë‹¨ì 
<a class=anchor href=#%ec%9e%a5%ec%a0%90%ea%b3%bc-%eb%8b%a8%ec%a0%90>#</a></h2><p>ì¥ì  4ê°œ</p><ul><li>ìë™ êµ°ì§‘ìˆ˜ ê²°ì •</li><li>ì´ìƒì¹˜ íƒì§€ ê°€ëŠ¥</li><li>ë³µì¡í•œ í´ëŸ¬ìŠ¤í„° í˜•íƒœ íƒì§€</li><li>ë¹„ì§€ë„ í•™ìŠµ</li></ul><p>ë‹¨ì  3ê°œ</p><ul><li>eps ê°’ ì„¤ì •ì´ ë¯¼ê°í•¨</li><li>ë°€ë„ê°€ ë‹¤ë¥¸ í´ëŸ¬ìŠ¤í„°ëŠ” ì˜ ë¶„ë¦¬ ëª»í•¨ (ë°€ë„ ê¸°ì¤€ì´ í•˜ë‚˜ë¿ì´ë¼ ë¶ˆê· í˜• ë¶„í¬ì— ì•½í•¨)</li><li>ê³ ì°¨ì› ë°ì´í„°ì—ì„  ê±°ë¦¬ ê°œë…ì´ í¬ì„ë˜ë¯€ë¡œ ì°¨ì› ì¶•ì†Œ(t-SNE, PCA ë“±) í•„ìš”.</li></ul><h2 id=qa>Q&amp;A
<a class=anchor href=#qa>#</a></h2><p>Q1) DBSCANì€ ëª‡ì°¨ì›ì—ì„œ ì œì¼ íš¨ìœ¨ì ì¸ê°€?</p><p>A1)</p><p>2(~3)ì°¨ì›ì—ì„œ ê°€ì¥ íš¨ìœ¨ì .</p><ul><li>ê±°ë¦¬ ê°œë…ì´ ëª…í™•í•˜ê³  ì‹œê°í™” ê°€ëŠ¥</li><li>ì‹œê°í™” ê°€ëŠ¥ -> ì‹œê°í™” í†µí•´ êµ°ì§‘ êµ¬ì¡° í™•ì¸ ê°€ëŠ¥ -> eps ì§ê´€ì ìœ¼ë¡œ ì¡°ì • ê°€ëŠ¥</li></ul><p>4~10ì°¨ì›ì—ì„œ ì ì  ì–´ë ¤ì›Œì§.</p><ul><li>ê±°ë¦¬ ë¶„í¬ê°€ í‰í‰í•´ì§€ê³ , core point ì¡°ê±´ì„ ì¶©ì¡±ì‹œí‚¤ê¸° ì–´ë ¤ì›€</li><li>ìœ í´ë¦¬ë“œ ê±°ë¦¬ ê¸°ë°˜ eps ì¡°ì •ì´ ë§¤ìš° ë¯¼ê°í•´ì§</li><li>ì°¨ì› ì¶•ì†Œ(PCA, t-SNE, UMAP) í›„ ì‚¬ìš© ì¶”ì²œ</li></ul><p>10ì°¨ì› ì´ìƒ</p><ul><li>ê±°ë¦¬ í¬ì†Œì„±(dimensionality curse): ëª¨ë“  ì  ê°„ ê±°ë¦¬ê°€ ë¹„ìŠ·í•´ì ¸ ë°€ë„ ê¸°ë°˜ íŒë³„ì´ ì–´ë ¤ì›Œì§</li><li>epsì™€ min_samples ì¡°í•©ì´ ì„±ëŠ¥ì— í° ì˜í–¥ì„ ì£¼ë©°, ì¡°ì •ì´ ì–´ë µê³  ë¶ˆì•ˆì •í•¨</li><li>ê³ ì°¨ì›ì—ì„  DBSCANë³´ë‹¤ HDBSCAN, Spectral Clustering, ë˜ëŠ” Spherical KMeans ë“±ì„ ê³ ë ¤ / ë˜ëŠ” ì°¨ì› ì¶•ì†Œë¥¼ ì„ í–‰í•œ í›„ DBSCAN ì‚¬ìš©</li></ul><p>Q2) íŒŒë¼ë¯¸í„° ì„ íƒë²•?</p><p>A2)</p><ol><li>ì´ë¡ ì  ê¸°ì¤€ìœ¼ë¡œ min_samples=2*dë¥¼ ì ìš©í•´ì„œ min_samples í›„ë³´ê°’ì„ ì •í•¨</li><li>k = min_samples-1ë¡œ ì„¤ì •í•˜ì—¬ k-distance plotì„ ê·¸ë¦¼</li><li>elbow pointì„ ì°¾ì•„ epsë¥¼ ê²°ì •</li><li>ë‹¤ì–‘í•œ min_samplesë¡œ ê·¸ë˜í”„ë¥¼ ì—¬ëŸ¬ ë²ˆ ê·¸ë ¤ë³´ê³  -> ê°€ì¥ ëšœë ·í•œ elbow pointì„ ì£¼ëŠ” min_samplesë¥¼ ì„ íƒ</li></ol><h2 id=ì„±ëŠ¥-í‰ê°€>ì„±ëŠ¥ í‰ê°€
<a class=anchor href=#%ec%84%b1%eb%8a%a5-%ed%8f%89%ea%b0%80>#</a></h2><p>DBSCANì€ ë¹„ì§€ë„ í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ì´ê¸° ë•Œë¬¸ì—, ì„±ëŠ¥ í‰ê°€ì— ìˆì–´ì„œ supervised ë°©ì‹ê³¼ëŠ” ë‹¤ë¥¸ ì ‘ê·¼ì´ í•„ìš”</p><p>ë‚´ë¶€ í‰ê°€ ì§€í‘œ</p><ul><li>Silhouette Score<ul><li>ê° ì ì´ ì†í•œ í´ëŸ¬ìŠ¤í„° ë‚´ë¶€ ì‘ì§‘ë„ì™€, ê°€ì¥ ê°€ê¹Œìš´ ë‹¤ë¥¸ í´ëŸ¬ìŠ¤í„°ì™€ì˜ ê±°ë¦¬ ì°¨ì´ë¥¼ ë¹„êµ</li><li>-1 ~ 1 (1: ì˜ í´ëŸ¬ìŠ¤í„°ë¨, 0: ê²½ê³„ì— ìˆìŒ)</li></ul></li><li>Davies-Bouldin Index<ul><li>í´ëŸ¬ìŠ¤í„° ê°„ ê°„ê²©ì´ ë©€ê³ , ë‚´ë¶€ ì‘ì§‘ë„ê°€ ë†’ì„ìˆ˜ë¡ ì¢‹ì€ ê°’</li><li>ê°’ì´ ì‘ì„ìˆ˜ë¡ ìš°ìˆ˜</li></ul></li><li>Calinski-Harabasz Index<ul><li>í´ëŸ¬ìŠ¤í„° ê°„ ë¶„ì‚° / í´ëŸ¬ìŠ¤í„° ë‚´ ë¶„ì‚° ë¹„ìœ¨</li><li>ê°’ì´ í´ìˆ˜ë¡ ì¢‹ì€ í´ëŸ¬ìŠ¤í„°ë§</li></ul></li></ul><p>ì™¸ë¶€ í‰ê°€ ì§€í‘œ (ë§Œì•½ ì •ë‹µ ë ˆì´ë¸”ì´ ìˆë‹¤ë©´ ë‹¤ìŒ ì§€í‘œë“¤ë„ ì‚¬ìš© ê°€ëŠ¥)</p><ul><li>Adjusted Rand Index (ARI): ë¬´ì‘ìœ„ êµ°ì§‘ê³¼ ë¹„êµí•˜ì—¬ í´ëŸ¬ìŠ¤í„° ì¼ì¹˜ ì •ë„ í™•ì¸ (1ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ì¢‹ìŒ)</li><li>Normalized Mutual Information (NMI): êµ°ì§‘ ì •ë³´ê°€ ì–¼ë§ˆë‚˜ labelê³¼ ìœ ì‚¬í•œì§€ í™•ì¸</li><li>Fowlkesâ€“Mallows index (FMI): TP ê¸°ì¤€ êµ°ì§‘ ì¼ì¹˜ ì •ë„</li></ul><p>ì‹œê°í™” ê¸°ë°˜ í‰ê°€</p><ul><li>2Dë‚˜ t-SNEë¡œ í´ëŸ¬ìŠ¤í„°ë§ ê²°ê³¼ ì‹œê°í™”í•´ì„œ, í´ëŸ¬ìŠ¤í„° ëª¨ì–‘, ë¶„ë¦¬ ì •ë„ ë…¸ì´ì¦ˆì˜ ìœ„ì¹˜ ë¶„í¬ êµ°ì§‘ ìˆ˜ê°€ ê³¼ë„í•˜ì§€ ì•Šì€ì§€ ë“±ì„ í™•ì¸</li><li>1D ë°ì´í„°ì—ì„œëŠ” ì‚¬ìš© ë¶ˆê°€</li></ul><h2 id=íŒŒì´ì¬-êµ¬í˜„---dbscan>íŒŒì´ì¬ êµ¬í˜„ - DBSCAN
<a class=anchor href=#%ed%8c%8c%ec%9d%b4%ec%8d%ac-%ea%b5%ac%ed%98%84---dbscan>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> math
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>euclidean_distance</span>(p1, p2):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> math<span style=color:#f92672>.</span>sqrt(sum((a <span style=color:#f92672>-</span> b) <span style=color:#f92672>**</span> <span style=color:#ae81ff>2</span> <span style=color:#66d9ef>for</span> a, b <span style=color:#f92672>in</span> zip(p1, p2)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>region_query</span>(data, point_idx, eps):
</span></span><span style=display:flex><span>    neighbors <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> idx, point <span style=color:#f92672>in</span> enumerate(data):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> euclidean_distance(data[point_idx], point) <span style=color:#f92672>&lt;=</span> eps:
</span></span><span style=display:flex><span>            neighbors<span style=color:#f92672>.</span>append(idx)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> neighbors
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>expand_cluster</span>(data, labels, point_idx, neighbors, cluster_id, eps, min_samples):
</span></span><span style=display:flex><span>    labels[point_idx] <span style=color:#f92672>=</span> cluster_id
</span></span><span style=display:flex><span>    i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> i <span style=color:#f92672>&lt;</span> len(neighbors):
</span></span><span style=display:flex><span>        n_idx <span style=color:#f92672>=</span> neighbors[i]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> labels[n_idx] <span style=color:#f92672>==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>:  <span style=color:#75715e># noise â†’ now becomes part of a cluster</span>
</span></span><span style=display:flex><span>            labels[n_idx] <span style=color:#f92672>=</span> cluster_id
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> labels[n_idx] <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            labels[n_idx] <span style=color:#f92672>=</span> cluster_id
</span></span><span style=display:flex><span>            n_neighbors <span style=color:#f92672>=</span> region_query(data, n_idx, eps)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> len(n_neighbors) <span style=color:#f92672>&gt;=</span> min_samples:
</span></span><span style=display:flex><span>                neighbors <span style=color:#f92672>+=</span> n_neighbors
</span></span><span style=display:flex><span>        i <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>dbscan</span>(data, eps, min_samples):
</span></span><span style=display:flex><span>    labels <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0</span>] <span style=color:#f92672>*</span> len(data)  <span style=color:#75715e># 0 = unvisited, -1 = noise, â‰¥1 = cluster id</span>
</span></span><span style=display:flex><span>    cluster_id <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> idx <span style=color:#f92672>in</span> range(len(data)):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> labels[idx] <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span>  <span style=color:#75715e># ì´ë¯¸ ë°©ë¬¸í•œ ì </span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        neighbors <span style=color:#f92672>=</span> region_query(data, idx, eps)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> len(neighbors) <span style=color:#f92672>&lt;</span> min_samples:
</span></span><span style=display:flex><span>            labels[idx] <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>  <span style=color:#75715e># noise</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            cluster_id <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            expand_cluster(data, labels, idx, neighbors, cluster_id, eps, min_samples)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> labels
</span></span></code></pre></div><h2 id=íŒŒì´ì¬-êµ¬í˜„---k-distance-plot>íŒŒì´ì¬ êµ¬í˜„ - k distance plot
<a class=anchor href=#%ed%8c%8c%ec%9d%b4%ec%8d%ac-%ea%b5%ac%ed%98%84---k-distance-plot>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>euclidean_distance</span>(p1, p2):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> np<span style=color:#f92672>.</span>sqrt(np<span style=color:#f92672>.</span>sum((p1 <span style=color:#f92672>-</span> p2) <span style=color:#f92672>**</span> <span style=color:#ae81ff>2</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>compute_k_distances</span>(X, k):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    ê° í¬ì¸íŠ¸ì— ëŒ€í•´ kë²ˆì§¸ ìµœê·¼ì ‘ ì´ì›ƒê¹Œì§€ì˜ ê±°ë¦¬ ê³„ì‚°
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Parameters:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - X: (n_samples, n_features) ndarray
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - k: ì´ì›ƒì˜ ìˆ˜ (k = min_samples - 1)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Returns:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - k_distances: ê° í¬ì¸íŠ¸ì˜ kë²ˆì§¸ ìµœê·¼ì ‘ ì´ì›ƒ ê±°ë¦¬ ë¦¬ìŠ¤íŠ¸
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    n_samples <span style=color:#f92672>=</span> len(X)
</span></span><span style=display:flex><span>    k_distances <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(n_samples):
</span></span><span style=display:flex><span>        distances <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(n_samples):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> i <span style=color:#f92672>!=</span> j:
</span></span><span style=display:flex><span>                dist <span style=color:#f92672>=</span> euclidean_distance(X[i], X[j])
</span></span><span style=display:flex><span>                distances<span style=color:#f92672>.</span>append(dist)
</span></span><span style=display:flex><span>        distances<span style=color:#f92672>.</span>sort()
</span></span><span style=display:flex><span>        k_distances<span style=color:#f92672>.</span>append(distances[k <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>])  <span style=color:#75715e># kë²ˆì§¸ ì‘ì€ ê±°ë¦¬</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> np<span style=color:#f92672>.</span>sort(k_distances)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>plot_k_distance_manual</span>(X, k):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    sklearn ì—†ì´ k-distance plot ê·¸ë¦¬ê¸°
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Parameters:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - X: (n_samples, n_features) ndarray
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - k: int, ì´ì›ƒ ìˆ˜ (= min_samples - 1)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    k_distances <span style=color:#f92672>=</span> compute_k_distances(X, k)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>4</span>))
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>plot(k_distances)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>ylabel(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>k<span style=color:#e6db74>}</span><span style=color:#e6db74>-th nearest neighbor distance&#34;</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>xlabel(<span style=color:#e6db74>&#34;Points sorted by distance&#34;</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>title(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Manual k-distance plot (k=</span><span style=color:#e6db74>{</span>k<span style=color:#e6db74>}</span><span style=color:#e6db74>)&#34;</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><h2 id=íŒŒì´ì¬-êµ¬í˜„---silhouette-score>íŒŒì´ì¬ êµ¬í˜„ - silhouette score
<a class=anchor href=#%ed%8c%8c%ec%9d%b4%ec%8d%ac-%ea%b5%ac%ed%98%84---silhouette-score>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>silhouette_score_manual</span>(X, labels):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Silhouette Scoreë¥¼ ì§ì ‘ ê³„ì‚°í•˜ëŠ” í•¨ìˆ˜
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Parameters:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - X: (n_samples, n_features) ndarray
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - labels: (n_samples,) í´ëŸ¬ìŠ¤í„° ID, ë…¸ì´ì¦ˆëŠ” ì œì™¸ë˜ì–´ ìˆì–´ì•¼ í•¨ (-1 ì œê±° í•„ìˆ˜)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Returns:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - í‰ê·  Silhouette Score (float)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    unique_labels <span style=color:#f92672>=</span> set(labels)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(unique_labels) <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>ValueError</span>(<span style=color:#e6db74>&#34;í´ëŸ¬ìŠ¤í„°ê°€ 1ê°œ ì´í•˜ì…ë‹ˆë‹¤. Silhouette Scoreë¥¼ ê³„ì‚°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    n_samples <span style=color:#f92672>=</span> len(X)
</span></span><span style=display:flex><span>    silhouette_values <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(n_samples):
</span></span><span style=display:flex><span>        own_cluster <span style=color:#f92672>=</span> labels[i]
</span></span><span style=display:flex><span>        same_cluster_indices <span style=color:#f92672>=</span> [j <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(n_samples) <span style=color:#66d9ef>if</span> labels[j] <span style=color:#f92672>==</span> own_cluster <span style=color:#f92672>and</span> j <span style=color:#f92672>!=</span> i]
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># a(i): ê°™ì€ í´ëŸ¬ìŠ¤í„° ë‚´ í‰ê·  ê±°ë¦¬</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> same_cluster_indices:
</span></span><span style=display:flex><span>            a <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>mean([np<span style=color:#f92672>.</span>linalg<span style=color:#f92672>.</span>norm(X[i] <span style=color:#f92672>-</span> X[j]) <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> same_cluster_indices])
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            a <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>  <span style=color:#75715e># ê³ ë¦½ëœ ì </span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># b(i): ê°€ì¥ ê°€ê¹Œìš´ ë‹¤ë¥¸ í´ëŸ¬ìŠ¤í„°ì™€ì˜ í‰ê·  ê±°ë¦¬</span>
</span></span><span style=display:flex><span>        b <span style=color:#f92672>=</span> float(<span style=color:#e6db74>&#39;inf&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> other_cluster <span style=color:#f92672>in</span> unique_labels:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> other_cluster <span style=color:#f92672>==</span> own_cluster:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>            other_indices <span style=color:#f92672>=</span> [j <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(n_samples) <span style=color:#66d9ef>if</span> labels[j] <span style=color:#f92672>==</span> other_cluster]
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> other_indices:
</span></span><span style=display:flex><span>                b_dist <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>mean([np<span style=color:#f92672>.</span>linalg<span style=color:#f92672>.</span>norm(X[i] <span style=color:#f92672>-</span> X[j]) <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> other_indices])
</span></span><span style=display:flex><span>                b <span style=color:#f92672>=</span> min(b, b_dist)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># s(i): silhouette score for point i</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> max(a, b) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            s <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            s <span style=color:#f92672>=</span> (b <span style=color:#f92672>-</span> a) <span style=color:#f92672>/</span> max(a, b)
</span></span><span style=display:flex><span>        silhouette_values<span style=color:#f92672>.</span>append(s)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> np<span style=color:#f92672>.</span>mean(silhouette_values)
</span></span></code></pre></div><h2 id=ì „ì²´-íŒŒì´í”„ë¼ì¸-ì‹¤í–‰>ì „ì²´ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰
<a class=anchor href=#%ec%a0%84%ec%b2%b4-%ed%8c%8c%ec%9d%b4%ed%94%84%eb%9d%bc%ec%9d%b8-%ec%8b%a4%ed%96%89>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># 1. ë°ì´í„° ìƒì„±</span>
</span></span><span style=display:flex><span>X, _ <span style=color:#f92672>=</span> make_moons(n_samples<span style=color:#f92672>=</span><span style=color:#ae81ff>300</span>, noise<span style=color:#f92672>=</span><span style=color:#ae81ff>0.05</span>, random_state<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2. k-distance plot</span>
</span></span><span style=display:flex><span>min_samples <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>plot_k_distance_manual(X, k<span style=color:#f92672>=</span>min_samples <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 3. í´ëŸ¬ìŠ¤í„°ë§ (ì—¬ê¸°ì„  elbow ë³´ê³  eps=0.125 ì •ë„ ì„ íƒ)</span>
</span></span><span style=display:flex><span>eps <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.15</span>
</span></span><span style=display:flex><span>labels <span style=color:#f92672>=</span> dbscan(X, eps<span style=color:#f92672>=</span>eps, min_samples<span style=color:#f92672>=</span>min_samples)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 4. í´ëŸ¬ìŠ¤í„° ì‹œê°í™”</span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>5</span>))
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>scatter(X[:, <span style=color:#ae81ff>0</span>], X[:, <span style=color:#ae81ff>1</span>], c<span style=color:#f92672>=</span>labels, cmap<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;tab10&#39;</span>, s<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>title(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;DBSCAN Clustering (eps=</span><span style=color:#e6db74>{</span>eps<span style=color:#e6db74>}</span><span style=color:#e6db74>, min_samples=</span><span style=color:#e6db74>{</span>min_samples<span style=color:#e6db74>}</span><span style=color:#e6db74>)&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>xlabel(<span style=color:#e6db74>&#34;X1&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>ylabel(<span style=color:#e6db74>&#34;X2&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 5. Silhouette Score ê³„ì‚°</span>
</span></span><span style=display:flex><span>score <span style=color:#f92672>=</span> silhouette_score_manual(X, labels)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Silhouette Score: </span><span style=color:#e6db74>{</span>score<span style=color:#e6db74>:</span><span style=color:#e6db74>.4f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><p><img src=https://github.com/user-attachments/assets/0dacd3df-037c-40a1-84f8-7ea8012e61fa alt=image>
<img src=https://github.com/user-attachments/assets/aed95c7b-432d-4299-bd50-052775a34760 alt=image></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain><span style=display:flex><span>Silhouette Score: 0.3327
</span></span></code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments><script src=https://giscus.app/client.js data-repo=yshghid/yshghid.github.io data-repo-id=R_kgDONkMkNg data-category-id=DIC_kwDONkMkNs4CloJh data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=ko crossorigin=anonymous async></script></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#ê°œë…>ê°œë…</a></li><li><a href=#íŒŒë¼ë¯¸í„°ì™€-í•µì‹¬-ìš©ì–´>íŒŒë¼ë¯¸í„°ì™€ í•µì‹¬ ìš©ì–´</a></li><li><a href=#ì¥ì ê³¼-ë‹¨ì >ì¥ì ê³¼ ë‹¨ì </a></li><li><a href=#qa>Q&amp;A</a></li><li><a href=#ì„±ëŠ¥-í‰ê°€>ì„±ëŠ¥ í‰ê°€</a></li><li><a href=#íŒŒì´ì¬-êµ¬í˜„---dbscan>íŒŒì´ì¬ êµ¬í˜„ - DBSCAN</a></li><li><a href=#íŒŒì´ì¬-êµ¬í˜„---k-distance-plot>íŒŒì´ì¬ êµ¬í˜„ - k distance plot</a></li><li><a href=#íŒŒì´ì¬-êµ¬í˜„---silhouette-score>íŒŒì´ì¬ êµ¬í˜„ - silhouette score</a></li><li><a href=#ì „ì²´-íŒŒì´í”„ë¼ì¸-ì‹¤í–‰>ì „ì²´ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰</a></li></ul></nav></div></aside></main></body></html>