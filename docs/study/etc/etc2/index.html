<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  #2 Explainable AI
  #

#2025-06-26


  1. Explainable AIë€?
  #

Explainable AIëŠ” ì¸ê³µì§€ëŠ¥(AI) ë˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹(ML) ëª¨ë¸ì´ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ íŠ¹ì • ê²°ê³¼ë¥¼ ë„ì¶œí–ˆëŠ”ì§€ ì‚¬ëŒì´ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ì„¤ëª…í•˜ëŠ” ê¸°ìˆ ê³¼ ë°©ë²•ë¡ .

  2. XAI ê¸°ë²• ë¶„ë¥˜
  #

ëª¨ë¸ êµ¬ì¡°

Intrinsic:	ëª¨ë¸ ìì²´ê°€ ì„¤ëª… ê°€ëŠ¥í•œ êµ¬ì¡° (ì˜ˆ: ì˜ì‚¬ê²°ì •ë‚˜ë¬´, ì„ í˜•íšŒê·€ ë“±)
Post-hoc:	ëª¨ë¸ í•™ìŠµ í›„ ë³„ë„ë¡œ ì„¤ëª… ìƒì„± (ì˜ˆ: SHAP, LIME)
ëŒ€ìƒ
Global:	ì „ì²´ ëª¨ë¸ì˜ ì‘ë™ ì›ë¦¬ë¥¼ ì„¤ëª…
Local:	íŠ¹ì • ìƒ˜í”Œì˜ ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ì„¤ëª…


  3. ì£¼ìš” Post-hoc ì„¤ëª… ê¸°ë²•
  #

LIME (Local Interpretable Model-Agnostic Explanations): ì£¼ë³€ ì…ë ¥ì„ ëœë¤í•˜ê²Œ ìƒì„±í•˜ê³ , ë‹¨ìˆœ ëª¨ë¸(ì„ í˜• íšŒê·€ ë“±)ì„ í•™ìŠµí•´ ê·¼ì‚¬"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://yshghid.github.io/docs/study/etc/etc2/"><meta property="og:site_name" content=" "><meta property="og:title" content="#2 Explainable AI"><meta property="og:description" content="#2 Explainable AI # #2025-06-26
1. Explainable AIë€? # Explainable AIëŠ” ì¸ê³µì§€ëŠ¥(AI) ë˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹(ML) ëª¨ë¸ì´ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ íŠ¹ì • ê²°ê³¼ë¥¼ ë„ì¶œí–ˆëŠ”ì§€ ì‚¬ëŒì´ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ì„¤ëª…í•˜ëŠ” ê¸°ìˆ ê³¼ ë°©ë²•ë¡ .
2. XAI ê¸°ë²• ë¶„ë¥˜ # ëª¨ë¸ êµ¬ì¡°
Intrinsic:	ëª¨ë¸ ìì²´ê°€ ì„¤ëª… ê°€ëŠ¥í•œ êµ¬ì¡° (ì˜ˆ: ì˜ì‚¬ê²°ì •ë‚˜ë¬´, ì„ í˜•íšŒê·€ ë“±) Post-hoc:	ëª¨ë¸ í•™ìŠµ í›„ ë³„ë„ë¡œ ì„¤ëª… ìƒì„± (ì˜ˆ: SHAP, LIME) ëŒ€ìƒ Global:	ì „ì²´ ëª¨ë¸ì˜ ì‘ë™ ì›ë¦¬ë¥¼ ì„¤ëª… Local:	íŠ¹ì • ìƒ˜í”Œì˜ ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ì„¤ëª… 3. ì£¼ìš” Post-hoc ì„¤ëª… ê¸°ë²• # LIME (Local Interpretable Model-Agnostic Explanations): ì£¼ë³€ ì…ë ¥ì„ ëœë¤í•˜ê²Œ ìƒì„±í•˜ê³ , ë‹¨ìˆœ ëª¨ë¸(ì„ í˜• íšŒê·€ ë“±)ì„ í•™ìŠµí•´ ê·¼ì‚¬"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:published_time" content="2025-06-26T00:00:00+00:00"><meta property="article:modified_time" content="2025-06-26T00:00:00+00:00"><meta property="article:tag" content="2025-06"><title>#2 Explainable AI |</title><link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://yshghid.github.io/docs/study/etc/etc2/><link rel=stylesheet href=/book.min.6217d077edb4189fd0578345e84bca1a884dfdee121ff8dc9a0f55cfe0852bc9.css integrity="sha256-YhfQd+20GJ/QV4NF6EvKGohN/e4SH/jcmg9Vz+CFK8k=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.578a2d8e6e30e0a0ae3682797882d89ca0cbbf1734d206705396ea76cf57bbb6.js integrity="sha256-V4otjm4w4KCuNoJ5eILYnKDLvxc00gZwU5bqds9Xu7Y=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><img src=/logo.png alt=Logo class=book-icon><span></span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li class=book-section-flat><span>ê¸°ë¡</span><ul><li><a href=/docs/hobby/book/>ê¸€</a><ul></ul></li><li><a href=/docs/hobby/daily/>ì¼ìƒ</a><ul></ul></li></ul></li><li class=book-section-flat><span>ê³µë¶€</span><ul><li><a href=/docs/study/bioinformatics/>Bioinformatics</a><ul></ul></li><li><a href=/docs/study/ai/>AI</a><ul></ul></li><li><a href=/docs/study/sw/>SW</a><ul></ul></li><li><a href=/docs/study/algorithm/>ì•Œê³ ë¦¬ì¦˜</a><ul></ul></li><li><a href=/docs/study/career/>ì·¨ì—…</a><ul></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>#2 Explainable AI</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#1-explainable-aië€>1. Explainable AIë€?</a></li><li><a href=#2-xai-ê¸°ë²•-ë¶„ë¥˜>2. XAI ê¸°ë²• ë¶„ë¥˜</a></li><li><a href=#3-ì£¼ìš”-post-hoc-ì„¤ëª…-ê¸°ë²•>3. ì£¼ìš” Post-hoc ì„¤ëª… ê¸°ë²•</a></li><li><a href=#4-shapì´ë€>4. SHAPì´ë€?</a></li><li><a href=#5-rfì˜-feature-importanceì™€ì˜-ì°¨ì´>5. RFì˜ feature importanceì™€ì˜ ì°¨ì´?</a></li><li><a href=#6-ê²°ë¡ >6. ê²°ë¡ </a></li><li><a href=#7-ì˜ˆì‹œ-ì½”ë“œ>7. ì˜ˆì‹œ ì½”ë“œ</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=2-explainable-ai>#2 Explainable AI
<a class=anchor href=#2-explainable-ai>#</a></h1><p>#2025-06-26</p><hr><h3 id=1-explainable-aië€>1. Explainable AIë€?
<a class=anchor href=#1-explainable-ai%eb%9e%80>#</a></h3><p>Explainable AIëŠ” ì¸ê³µì§€ëŠ¥(AI) ë˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹(ML) ëª¨ë¸ì´ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ íŠ¹ì • ê²°ê³¼ë¥¼ ë„ì¶œí–ˆëŠ”ì§€ ì‚¬ëŒì´ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ì„¤ëª…í•˜ëŠ” ê¸°ìˆ ê³¼ ë°©ë²•ë¡ .</p><h3 id=2-xai-ê¸°ë²•-ë¶„ë¥˜>2. XAI ê¸°ë²• ë¶„ë¥˜
<a class=anchor href=#2-xai-%ea%b8%b0%eb%b2%95-%eb%b6%84%eb%a5%98>#</a></h3><p>ëª¨ë¸ êµ¬ì¡°</p><ul><li>Intrinsic: ëª¨ë¸ ìì²´ê°€ ì„¤ëª… ê°€ëŠ¥í•œ êµ¬ì¡° (ì˜ˆ: ì˜ì‚¬ê²°ì •ë‚˜ë¬´, ì„ í˜•íšŒê·€ ë“±)</li><li>Post-hoc: ëª¨ë¸ í•™ìŠµ í›„ ë³„ë„ë¡œ ì„¤ëª… ìƒì„± (ì˜ˆ: SHAP, LIME)
ëŒ€ìƒ</li><li>Global: ì „ì²´ ëª¨ë¸ì˜ ì‘ë™ ì›ë¦¬ë¥¼ ì„¤ëª…</li><li>Local: íŠ¹ì • ìƒ˜í”Œì˜ ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ì„¤ëª…</li></ul><h3 id=3-ì£¼ìš”-post-hoc-ì„¤ëª…-ê¸°ë²•>3. ì£¼ìš” Post-hoc ì„¤ëª… ê¸°ë²•
<a class=anchor href=#3-%ec%a3%bc%ec%9a%94-post-hoc-%ec%84%a4%eb%aa%85-%ea%b8%b0%eb%b2%95>#</a></h3><p>LIME (Local Interpretable Model-Agnostic Explanations): ì£¼ë³€ ì…ë ¥ì„ ëœë¤í•˜ê²Œ ìƒì„±í•˜ê³ , ë‹¨ìˆœ ëª¨ë¸(ì„ í˜• íšŒê·€ ë“±)ì„ í•™ìŠµí•´ ê·¼ì‚¬</p><p>SHAP (SHapley Additive exPlanations): ê²Œì„ ì´ë¡ ì˜ ìƒ¤í”Œë¦¬ ê°’ ê¸°ë°˜</p><ul><li>ê° í”¼ì²˜ê°€ ê¸°ì—¬í•œ ì •ë„ë¥¼ ê³µì •í•˜ê²Œ ë¶„ë°°í•˜ì—¬ ì„¤ëª…<ul><li>ì¥ì : ìˆ˜í•™ì ìœ¼ë¡œ ì •ë‹¹ì„± í™•ë³´, ì¼ê´€ëœ ì„¤ëª… ì œê³µ</li><li>ë‹¨ì : ê³„ì‚° ë¹„ìš© í¼</li></ul></li></ul><p>Permutation Importance: ì…ë ¥ í”¼ì²˜ë¥¼ ë¬´ì‘ìœ„ë¡œ ì„ì€ í›„ ì˜ˆì¸¡ ì„±ëŠ¥ ê°ì†Œ ì •ë„ ì¸¡ì •</p><ul><li>ì˜ˆì¸¡ ì„±ëŠ¥ì´ í¬ê²Œ ê°ì†Œí•˜ë©´, ì¤‘ìš”í•œ í”¼ì²˜ë¡œ íŒë‹¨</li></ul><p>Saliency Maps (ì´ë¯¸ì§€ ë¶„ì•¼)</p><h3 id=4-shapì´ë€>4. SHAPì´ë€?
<a class=anchor href=#4-shap%ec%9d%b4%eb%9e%80>#</a></h3><p>ê° feature(ì…ë ¥ ë³€ìˆ˜)ê°€ ëª¨ë¸ì˜ ì˜ˆì¸¡ê°’ì— ì–¼ë§ˆë‚˜ ê¸°ì—¬í–ˆëŠ”ì§€ ì •ëŸ‰ì ìœ¼ë¡œ ê³„ì‚°.</p><p>ì›ë˜ëŠ” í˜‘ë ¥ ê²Œì„ ì´ë¡ ì—ì„œ</p><ul><li>ì—¬ëŸ¬ í”Œë ˆì´ì–´ê°€ íŒ€ì„ ì´ë¤„ ë³´ìƒì„ ë°›ì•˜ì„ ë•Œ, ê° í”Œë ˆì´ì–´ê°€ ì „ì²´ ë³´ìƒì— ì–¼ë§ˆë‚˜ ê¸°ì—¬í–ˆëŠ”ì§€ë¥¼ ê³„ì‚°í•˜ëŠ” ë°©ë²•ì¸ë°</li><li>ì˜ˆì‹œë¡œ<ul><li>ì¶•êµ¬ ê²Œì„ì„ í•˜ì—¬ íŒ€ ì „ì²´ê°€ 100ì ì„ íšë“í–ˆë‹¤ê³  ê°€ì •</li><li>íŒ€ì—ëŠ” ì„ ìˆ˜ A, B, Cê°€ ìˆë‹¤<ul><li>ëˆ„ê°€ ë” ì¤‘ìš”í•œ ì„ ìˆ˜ì¸ì§€, ê° ì„ ìˆ˜ê°€ ì ìˆ˜ì— ì–¼ë§ˆë‚˜ ê¸°ì—¬í–ˆëŠ”ì§€ë¥¼ êµ¬í•˜ë ¤ë©´?</li><li>ìƒ¤í”Œë¦¬ ê°’ì€ ë‹¤ìŒ ìˆœì„œë¡œ ê¸°ì—¬ë„ë¥¼ í‰ê°€:<ol><li>ê°€ëŠ¥í•œ ëª¨ë“  ìˆœì—´ì„ ê³ ë ¤</li><li>ê° ìˆœì—´ì—ì„œ A, B, Cê°€ ì–¸ì œ íŒ€ì— í•©ë¥˜í–ˆëŠ”ì§€</li><li>ê·¸ ì„ ìˆ˜ê°€ íŒ€ì— ë“¤ì–´ì˜¤ë©´ì„œ ì–¼ë§ˆë‚˜ ì ìˆ˜ê°€ ëŠ˜ì—ˆëŠ”ì§€ í™•ì¸ -> ê° ì„ ìˆ˜ì˜ ì´ í‰ê·  ê¸°ì—¬ë„ë¥¼ â€œìƒ¤í”Œë¦¬ ê°’â€ì´ë¼ê³  í•¨.</li></ol></li></ul></li></ul></li></ul><p>ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì—ì„œ:</p><ul><li>ê° featureê°€ í”Œë ˆì´ì–´ ì—­í• ì„ í•¨<ul><li>ëª¨ë¸ì˜ ì˜ˆì¸¡ê°’ì´ íŒ€ì´ ì–»ì€ ì ìˆ˜ì´ê³ <ul><li>SHAPì€ &ldquo;ì´ ì˜ˆì¸¡ê°’ì´ ë‚˜ì˜¤ëŠ” ë°, ê° featureê°€ ì–¼ë§ˆë‚˜ ê¸°ì—¬í–ˆëŠ”ê°€?&ldquo;ë¥¼ ê³„ì‚°.</li><li>ì˜ˆë¥¼ ë“¤ì–´ ëª¨ë¸ì´ ì–´ë–¤ í™˜ìì˜ ì‚¬ë§ í™•ë¥ ì„ 80%ë¼ê³  ì˜ˆì¸¡í–ˆì„ ë•Œ<ul><li>ë‚˜ì´: +15%</li><li>í¡ì—° ì—¬ë¶€: +10%</li><li>í˜ˆì••: +5%</li><li>ê¸°ë³¸ê°’: 50%<ul><li>ì´í•©: 50% + 15 + 10 + 5 = 80%</li></ul></li></ul></li></ul></li></ul></li><li>ì¦‰ SHAPì€ ì˜ˆì¸¡ê°’ì„ base value + ê° featureì˜ ê¸°ì—¬ë„ë¡œ ë¶„í•´í•´ì¤€ë‹¤.</li></ul><p>ìˆ˜í•™ì  ê³„ì‚° ê³¼ì •:</p><ul><li>3ê°œì˜ feature (A, B, C)ì—ì„œ ê°€ëŠ¥í•œ feature ì¡°í•©:<ul><li>{}, {A}, {B}, {C}, {A,B}, {A,C}, {B,C}, {A,B,C}</li><li>SHAPì€ ëª¨ë“  ì¡°í•©ì— ëŒ€í•´,<ul><li>í•´ë‹¹ featureê°€ ë“¤ì–´ê°”ì„ ë•Œì™€ ì•ˆ ë“¤ì–´ê°”ì„ ë•Œ ì˜ˆì¸¡ê°’ ì°¨ì´ë¥¼ ê³„ì‚°<ul><li>ì´ë¥¼ í‰ê· í•˜ì—¬ ê¸°ì—¬ë„(ìƒ¤í”Œë¦¬ ê°’)ë¡œ ì„¤ì •í•œë‹¤.<ul><li>ë‹¨ì : ì¡°í•© ìˆ˜ê°€ 2^Mì´ë¼ì„œ feature ìˆ˜ê°€ ë§ìœ¼ë©´ ê³„ì‚°ëŸ‰ í­ë°œ</li></ul></li></ul></li></ul></li></ul></li></ul><h3 id=5-rfì˜-feature-importanceì™€ì˜-ì°¨ì´>5. RFì˜ feature importanceì™€ì˜ ì°¨ì´?
<a class=anchor href=#5-rf%ec%9d%98-feature-importance%ec%99%80%ec%9d%98-%ec%b0%a8%ec%9d%b4>#</a></h3><table><thead><tr><th>í•­ëª©</th><th>Random Forest Feature Importance</th><th>SHAP</th></tr></thead><tbody><tr><td>ê¸°ë°˜ ê°œë…</td><td>ëª¨ë¸ êµ¬ì¡° ê¸°ë°˜ (gini ê°ì†Œ ë“±)</td><td>ê²Œì„ ì´ë¡  ê¸°ë°˜ (ìƒ¤í”Œë¦¬ ê°’)</td></tr><tr><td>ì„¤ëª… ë°©ì‹</td><td>ì „ì²´ ëª¨ë¸ ìˆ˜ì¤€ (global)</td><td>ì „ì²´ + ê°œë³„ ìƒ˜í”Œ ìˆ˜ì¤€ (global + local)</td></tr><tr><td>ìŒ/ì–‘ êµ¬ë¶„</td><td>ì—†ìŒ (0 ì´ìƒ, í¬ê¸°ë§Œ ì œê³µ)</td><td>ìˆìŒ (ì–‘ìˆ˜: ì˜ˆì¸¡ â†‘, ìŒìˆ˜: ì˜ˆì¸¡ â†“)</td></tr><tr><td>ìƒí˜¸ì‘ìš© ê³ ë ¤</td><td>ë¶€ë¶„ì ìœ¼ë¡œë§Œ ê³ ë ¤</td><td>ì¼ë¶€ ê³ ë ¤ ê°€ëŠ¥ (íŠ¹ì • SHAP variant)</td></tr><tr><td>ì •í™•ì„±</td><td>ëŒ€ëµì ì¸ ì˜í–¥ë„</td><td>ìˆ˜í•™ì ìœ¼ë¡œ ë³´ì¥ëœ ê¸°ì—¬ë„</td></tr><tr><td>ë‹¨ì </td><td>bias ìˆìŒ (ë²”ì£¼ ìˆ˜ ë§ì€ ë³€ìˆ˜ ì„ í˜¸ ë“±)</td><td>ëŠë¦´ ìˆ˜ ìˆìŒ, ê³„ì‚° ë¹„ìš© ë†’ìŒ</td></tr></tbody></table><p>Random Forestì˜ Feature Importance</p><ul><li>ì‘ë™ ë°©ì‹</li><li>RFëŠ” ë‹¤ìˆ˜ì˜ ê²°ì •íŠ¸ë¦¬ë¥¼ ë§Œë“¤ê³ <ul><li>ê° íŠ¸ë¦¬ì—ì„œ ì–´ë–¤ featureë¥¼ ìª¼ê°¤ ë•Œ ì˜ˆì¸¡ ì„±ëŠ¥ì´ ì–¼ë§ˆë‚˜ ì¢‹ì•„ì¡ŒëŠ”ì§€(ex: Gini impurity ê°ì†ŒëŸ‰)ë¥¼ ê¸°ë¡.</li><li>ì—¬ëŸ¬ íŠ¸ë¦¬ì—ì„œ í•´ë‹¹ featureê°€ ì–¼ë§ˆë‚˜ ìì£¼, ì–¼ë§ˆë‚˜ í¬ê²Œ ì„±ëŠ¥ í–¥ìƒì— ê¸°ì—¬í–ˆëŠ”ì§€ë¥¼ í‰ê· í•˜ì—¬ importanceë¡œ ê³„ì‚°</li></ul></li><li>ë‹¨ì <ul><li>ë²”ì£¼ ìˆ˜ê°€ ë§ì€ featureê°€ ìœ ë¦¬ (ë” ì˜ ìª¼ê°¤ í™•ë¥  ë†’ìŒ)</li><li>ìƒí˜¸ì‘ìš© ê³ ë ¤ ë¶€ì¡±</li><li>ì™œ ì¤‘ìš”í–ˆëŠ”ì§€ ì„¤ëª… ë¶ˆê°€</li><li>ê°œë³„ ìƒ˜í”Œ ì„¤ëª… ë¶ˆê°€</li></ul></li></ul><p>SHAPì˜ Feature Importance</p><ul><li>SHAPì€ ë‹¤ìŒì„ ì œê³µ:<ul><li>ê° featureê°€ ê°œë³„ ì˜ˆì¸¡ê°’ì— ì–¼ë§ˆë‚˜ ì˜í–¥ì„ ì¤¬ëŠ”ì§€. ì–‘/ìŒ í¬í•¨.</li><li>ëª¨ë“  ìƒ˜í”Œì— ëŒ€í•´ ê³„ì‚°í•œ í›„ í‰ê· ì„ ë‚´ë©´, global feature importanceê°€ ë¨.</li><li>ì™œ ì¤‘ìš”í–ˆëŠ”ì§€ ìƒ˜í”Œë³„ë¡œ ì¶”ì  ê°€ëŠ¥</li></ul></li></ul><p>ë¨¼ì†Œë¦°ì§€ ì´í•´ ì•ˆë¼ì„œ.. ì§ê´€ì  ì˜ˆì‹œ.</p><ul><li>Random Forestì˜ Feature ImportanceëŠ” ëˆ„ê°€ ê²°ì • ê³¼ì •ì— ìì£¼ ì°¸ì—¬í–ˆëŠ”ì§€ ë³¸ë‹¤, ë§ˆì¹˜ íšŒì˜ì—ì„œ ë§ì´ ë§í•œ ì‚¬ëŒì„ ì¤‘ìš”í•œ ì‚¬ëŒì´ë¼ê³  ë³´ëŠ” ê²ƒê³¼ ê°™ìŒ.</li><li>SHAPì˜ Feature ImportanceëŠ” ëˆ„ê°€ ì‹¤ì œë¡œ ì˜ì‚¬ê²°ì • ê²°ê³¼ì— ì˜í–¥ì„ ì¤¬ëŠ”ì§€ ë³¸ë‹¤, ë§ˆì¹˜ íšŒì˜ì—ì„œ ì‹¤ì œë¡œ íˆ¬í‘œë¥¼ ë°”ê¿”ë†“ì€ ì‚¬ëŒì„ ì¤‘ìš”í•œ ì‚¬ëŒìœ¼ë¡œ ë³´ëŠ” ê²ƒê³¼ ê°™ìŒ.
ì¦‰ RFëŠ” ì°¸ì—¬ íšŸìˆ˜, SHAPì€ ê²°ê³¼ì— ê¸°ì—¬í•œ ì •ë„ë¥¼ ë³´ëŠ” ê±°ì˜ˆìš”.</li></ul><p>ëª¨ë¸ ì˜ˆì‹œ</p><ul><li>ëª¨ë¸ì´ í™˜ìì˜ ì‚¬ë§ í™•ë¥ ì„ ì˜ˆì¸¡í• ë•Œ<ul><li>í™˜ì ì…ë ¥: ë‚˜ì´ 80ì„¸ / ì²´ì˜¨ 39ë„ / í˜ˆì•• 100 / í¡ì—° ì—¬ë¶€ Yes</li></ul></li><li>Random ForestëŠ”?<ul><li>100ê°œì˜ íŠ¸ë¦¬ì—ì„œ ë‚˜ì´ë¡œ 70ë²ˆ ìª¼ê°¬ / ì²´ì˜¨ìœ¼ë¡œ 10ë²ˆ ìª¼ê°¬ / í˜ˆì••ìœ¼ë¡œ 15ë²ˆ ìª¼ê°¬ / í¡ì—° ì—¬ë¶€ë¡œ 5ë²ˆ ìª¼ê°¬<ul><li>ê·¸ë˜ì„œ ë‚˜ì´ê°€ ì œì¼ ì¤‘ìš”í•˜ë‹¤ê³  íŒë‹¨ (ê·¼ë° â€˜ë‚˜ì´â€™ê°€ ì˜ˆì¸¡ê°’ì— ì–¼ë§ˆë‚˜ ì˜í–¥ì„ ì¤¬ëŠ”ì§€ëŠ” ëª¨ë¦„)</li></ul></li></ul></li><li>SHAPì€?<ul><li>ì´ í™˜ìì˜ ì˜ˆì¸¡ê°’ì€ 0.80 (ê¸°ë³¸ê°’ì€ 0.50)</li><li>ê¸°ì—¬ë„: ë‚˜ì´ +0.20 / ì²´ì˜¨: +0.10 / í¡ì—°: +0.08 / í˜ˆì••: -0.08<ul><li>í•©ì¹˜ë©´: 0.50 + 0.20 + 0.10 + 0.08 - 0.08 = 0.80</li><li>ì¦‰ SHAPì€ ì˜ˆì¸¡ê°’ì´ ì™œ 0.80ì´ ë˜ì—ˆëŠ”ì§€ ëª…í™•í•˜ê²Œ ì„¤ëª….</li></ul></li></ul></li></ul><p>í•˜ë‚˜ì˜ featureë¼ë„ ê°’ì´ ë†’ì„ ë•Œ ì–´ë–¤ ê²½ìš°ì—” ì˜ˆì¸¡ì„ â†‘ ì–´ë–¤ ê²½ìš°ì—” ì˜ˆì¸¡ì„ â†“ ì‹œí‚¬ ìˆ˜ ìˆë‹¤ ê·¸ë¦¬ê³  ì´ ë³µì¡í•œ ê´€ê³„ë¥¼ ì‹œê°ì ìœ¼ë¡œ í•œ ë²ˆì— ë³´ì—¬ì£¼ëŠ” ê²ƒì´ ë°”ë¡œ SHAPì˜ summary plot.</p><p>&lsquo;ì²´ì˜¨&rsquo; featureë¡œ ì˜ˆì‹œ.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>      ì²´ì˜¨  â”€â”€â”€ğŸ”µğŸ”µğŸ”µğŸ”´ğŸ”´ğŸ”´ğŸ”´ğŸ”´ğŸ”µğŸ”µâ”€â”€â–¶
</span></span><span class=line><span class=cl>          (SHAP ê°’: ìŒìˆ˜~ì–‘ìˆ˜)
</span></span></code></pre></div><p>ğŸ”´: ì²´ì˜¨ì´ ë†’ì€ ìƒ˜í”Œë“¤</p><ul><li>ì˜¤ë¥¸ìª½(+)ì— ìœ„ì¹˜í•œ ğŸ”´: ì²´ì˜¨ì´ ë†’ì•„ì„œ ì˜ˆì¸¡ê°’(ì‚¬ë§ í™•ë¥ )ì´ ì¦ê°€</li><li>ì™¼ìª½(-)ì— ìœ„ì¹˜í•œ ğŸ”´: ì²´ì˜¨ì´ ë†’ì§€ë§Œ ì˜ˆì¸¡ê°’ì€ ì˜¤íˆë ¤ ê°ì†Œ
ğŸ”µ: ì²´ì˜¨ì´ ë‚®ì€ ìƒ˜í”Œë“¤</li><li>ì˜¤ë¥¸ìª½(+)ì— ìœ„ì¹˜í•œ ğŸ”µ: ì²´ì˜¨ì´ ë‚®ì§€ë§Œ ì˜ˆì¸¡ê°’ì€ ì¦ê°€</li><li>ì™¼ìª½(-)ì— ìœ„ì¹˜í•œ ğŸ”µ: ì²´ì˜¨ì´ ë‚®ê³  ì˜ˆì¸¡ê°’ë„ ë‚®ìŒ</li></ul><p>ìƒ˜í”Œë§ˆë‹¤ ê¸°ì—¬ë„ì™€ ë°©í–¥ì´ ë‹¤ë¥¸ ì´ìœ </p><ul><li>SHAPì€ ëª¨ë“  featureë¥¼ &ldquo;ë‹¤ë¥¸ featureì™€ í•¨ê»˜ ì¼ì„ ë•Œ"ì˜ ì˜í–¥ë ¥ì„ ë”°ì§„ë‹¤.<ul><li>ê·¸ë˜ì„œ &ldquo;ì¡°ê±´ë¶€ ê¸°ì—¬ë„"ë¼ê³ ë„ í•¨.<ul><li>ì¦‰ ì²´ì˜¨ì´ ë†’ì•„ë„ ì Šì€ í™˜ìë¼ë©´ ì‚¬ë§ í™•ë¥ ì´ ë‚®ì„ ìˆ˜ ìˆê³  ì²´ì˜¨ì´ ë‚®ì•„ë„ ê¸°ì €ì§ˆí™˜ì´ ì‹¬í•œ í™˜ìë¼ë©´ ì‚¬ë§ í™•ë¥ ì´ ë†’ì„ ìˆ˜ ìˆë‹¤</li><li>ì´ëŸ° ë³µì¡í•œ ìƒí˜¸ì‘ìš©ì„ ë°˜ì˜í•˜ë‹¤ë³´ë‹ˆ ê°™ì€ featureë¼ë„ ìƒ˜í”Œë§ˆë‹¤ ê¸°ì—¬ ë°©í–¥ì´ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤.</li></ul></li></ul></li></ul><h3 id=6-ê²°ë¡ >6. ê²°ë¡ 
<a class=anchor href=#6-%ea%b2%b0%eb%a1%a0>#</a></h3><p>ê°™ì€ featureë¼ë„, ìƒ˜í”Œë§ˆë‹¤ ë‹¤ë¥¸ ìƒí™©(context)ì´ê¸° ë•Œë¬¸ì—, ê·¸ featureì˜ ì˜ˆì¸¡ì— ëŒ€í•œ ê¸°ì—¬ ë°©í–¥(â†‘ ë˜ëŠ” â†“)ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆë‹¤.</p><p>ì˜ˆë¥¼ ë“¤ì–´</p><ul><li>ë‚˜ì´ = 70ì¸ ì‚¬ëŒì´ë¼ë„<ul><li>ë‹¤ë¥¸ feature(í˜ˆì••, ì²´ì˜¨, ê¸°ì €ì§ˆí™˜ ë“±)ì— ë”°ë¼<ul><li>ì–´ë–¤ ìƒ˜í”Œì—ì„  ì‚¬ë§ í™•ë¥  â†‘ì— ê¸°ì—¬ (ì–‘ì˜ SHAP ê°’)</li><li>ì–´ë–¤ ìƒ˜í”Œì—ì„  ì‚¬ë§ í™•ë¥  â†“ì— ê¸°ì—¬ (ìŒì˜ SHAP ê°’)<ul><li>ê·¸ë˜ì„œ SHAP summary plotì—ì„œ ê°™ì€ featureì˜ ğŸ”´ì™€ ğŸ”µ ì ë“¤ì´ ì¢Œìš°ë¡œ í©ì–´ì ¸ ìˆë‹¤.</li></ul></li></ul></li></ul></li></ul><p>ì •ë¦¬í•˜ë©´?</p><ul><li>SHAPì€ &ldquo;ê°™ì€ feature"ê°€ &ldquo;ë‹¤ì–‘í•œ ë§¥ë½ì—ì„œ ì–´ë–»ê²Œ ì‘ìš©í•˜ëŠ”ê°€"ë¥¼ ë³´ì—¬ì£¼ëŠ” ë„êµ¬ì´ë‹¤.</li></ul><h3 id=7-ì˜ˆì‹œ-ì½”ë“œ>7. ì˜ˆì‹œ ì½”ë“œ
<a class=anchor href=#7-%ec%98%88%ec%8b%9c-%ec%bd%94%eb%93%9c>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pickle</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>joblib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>shap</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>seaborn</span> <span class=k>as</span> <span class=nn>sns</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#Load rf model</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;/model/rf_model.pkl&#39;</span><span class=p>,</span><span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>rf_model</span> <span class=o>=</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#Load dataset</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;/preprocessing/processed_data.pickle&#39;</span><span class=p>,</span><span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>preproc_data</span> <span class=o>=</span> <span class=n>pickle</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cytokine_df</span> <span class=o>=</span> <span class=n>preproc_data</span><span class=p>[</span><span class=s1>&#39;cytokine_data&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>patient_meta</span> <span class=o>=</span> <span class=n>preproc_data</span><span class=p>[</span><span class=s1>&#39;metadata&#39;</span><span class=p>]</span> 
</span></span><span class=line><span class=cl><span class=n>patient_info</span> <span class=o>=</span> <span class=n>preproc_data</span><span class=p>[</span><span class=s1>&#39;clinical&#39;</span><span class=p>]</span> 
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Get feature importances</span>
</span></span><span class=line><span class=cl><span class=n>importances</span> <span class=o>=</span> <span class=n>rf_model</span><span class=o>.</span><span class=n>feature_importances_</span>
</span></span><span class=line><span class=cl><span class=n>feature_names</span> <span class=o>=</span> <span class=n>cytokine_df</span><span class=o>.</span><span class=n>columns</span>
</span></span><span class=line><span class=cl><span class=n>feature_importances</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;feature&#39;</span><span class=p>:</span> <span class=n>feature_names</span><span class=p>,</span> <span class=s1>&#39;importance&#39;</span><span class=p>:</span> <span class=n>importances</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Sort the feature importances in descending order and select the top 20</span>
</span></span><span class=line><span class=cl><span class=n>top_20_features</span> <span class=o>=</span> <span class=n>feature_importances</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=n>by</span><span class=o>=</span><span class=s1>&#39;importance&#39;</span><span class=p>,</span> <span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Plot the top 20 feature importances</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span> <span class=mi>10</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>sns</span><span class=o>.</span><span class=n>barplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;importance&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;feature&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>top_20_features</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><p>RF ë‚´ë¶€ì˜ feature importanceë¥¼ ì‹œê°í™”</p><ul><li>ì–´ë–¤ ì‚¬ì´í† ì¹´ì¸ì´ ëª¨ë¸ì—ì„œ ìì£¼ ì“°ì˜€ëŠ”ì§€(ì¤‘ìš”í•œì§€)ë¥¼ ë³´ì—¬ì¤Œ</li><li>ì´ ê°’ì€ SHAPì²˜ëŸ¼ &ldquo;ì˜ˆì¸¡ì— ì–¼ë§ˆë‚˜ ê¸°ì—¬í–ˆëŠ”ê°€"ë¥¼ ë‚˜íƒ€ë‚´ì§€ ì•Šê³ , ë‹¨ìˆœíˆ &ldquo;ìª¼ê°œëŠ” ë° ë§ì´ ì“°ì˜€ëŠ”ê°€&rdquo; ê¸°ì¤€.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>tree_explainer</span> <span class=o>=</span> <span class=n>shap</span><span class=o>.</span><span class=n>TreeExplainer</span><span class=p>(</span><span class=n>rf_model</span><span class=p>)</span> <span class=c1>## TreeExplainer</span>
</span></span><span class=line><span class=cl><span class=n>shap_values</span> <span class=o>=</span> <span class=n>tree_explainer</span><span class=o>.</span><span class=n>shap_values</span><span class=p>(</span><span class=n>cytokine_df</span><span class=p>)</span> <span class=c1>## SHAP Value</span>
</span></span></code></pre></div><p>ì´ì§„ ë¶„ë¥˜ ëª¨ë¸(Random Forest, XGBoost ë“±)ì— shap.TreeExplainerë¥¼ ì ìš©í•˜ë©´</p><ul><li>ì´ shap_valuesëŠ” ë¦¬ìŠ¤íŠ¸ 2ê°œë¡œ êµ¬ì„±:<ul><li>shap_values[0]: í´ë˜ìŠ¤ 0 (ìŒì„± í´ë˜ìŠ¤)ì— ëŒ€í•œ SHAP ê°’</li><li>shap_values[1]: í´ë˜ìŠ¤ 1 (ì–‘ì„± í´ë˜ìŠ¤)ì— ëŒ€í•œ SHAP ê°’</li></ul></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>fig</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=mi>8</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=o>.</span><span class=n>set_facecolor</span><span class=p>(</span><span class=s1>&#39;white&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span> <span class=o>=</span> <span class=n>fig</span><span class=o>.</span><span class=n>add_subplot</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1>#Plot SHAP as sever probability</span>
</span></span><span class=line><span class=cl><span class=n>shap</span><span class=o>.</span><span class=n>summary_plot</span><span class=p>(</span><span class=n>shap_values</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>cytokine_df</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                  <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;bwr&#39;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                  <span class=n>show</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                 <span class=n>plot_type</span><span class=o>=</span><span class=s1>&#39;dot&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;SHAP Value&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;SHAP Dot Plot&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><p>shap_values[1]: ì´ì§„ ë¶„ë¥˜ì—ì„œ ì–‘ì„± í´ë˜ìŠ¤ì— ëŒ€í•œ SHAP ê°’</p><p>summary plot: ê° featureê°€ ì˜ˆì¸¡ì— ë¯¸ì¹œ ì˜í–¥(ì–‘/ìŒ, ì„¸ê¸°)ì„ ìƒ˜í”Œë³„ë¡œ ì‹œê°í™” (ë¹¨ê°•=ê°’ í¼, íŒŒë‘=ê°’ ì‘ìŒ)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>shap_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>shap_values</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>columns</span> <span class=o>=</span> <span class=n>cytokine_df</span><span class=o>.</span><span class=n>columns</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>shap_df</span><span class=o>.</span><span class=n>index</span> <span class=o>=</span> <span class=n>cytokine_df</span><span class=o>.</span><span class=n>index</span>
</span></span><span class=line><span class=cl><span class=n>shap_df</span>
</span></span></code></pre></div><p><img src=https://github.com/user-attachments/assets/32d7410b-f67c-4f88-9587-e6b41e8c8276 alt=image></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>umap.umap_</span> <span class=k>as</span> <span class=nn>umap</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>seaborn</span> <span class=k>as</span> <span class=nn>sns</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>reducer</span> <span class=o>=</span> <span class=n>umap</span><span class=o>.</span><span class=n>UMAP</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>embedding</span> <span class=o>=</span> <span class=n>reducer</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>shap_df</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Extract UMAP coordinates and labels</span>
</span></span><span class=line><span class=cl><span class=n>umap_x</span> <span class=o>=</span> <span class=n>embedding</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>umap_y</span> <span class=o>=</span> <span class=n>embedding</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create scatter plot</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>8</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>scatter</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>umap_x</span><span class=p>,</span> <span class=n>umap_y</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s2>&#34;bwr&#34;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s2>&#34;w&#34;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>0.5</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.cluster</span> <span class=kn>import</span> <span class=n>DBSCAN</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Initialize DBSCAN</span>
</span></span><span class=line><span class=cl><span class=n>dbscan</span> <span class=o>=</span> <span class=n>DBSCAN</span><span class=p>(</span><span class=n>eps</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>min_samples</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span> <span class=c1># partial data is too small to set min_sample=20.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Fit to UMAP data and get cluster labels</span>
</span></span><span class=line><span class=cl><span class=n>clusters</span> <span class=o>=</span> <span class=n>dbscan</span><span class=o>.</span><span class=n>fit_predict</span><span class=p>(</span><span class=n>embedding</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>embedding</span><span class=p>,</span> <span class=n>clusters</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=p>(</span><span class=n>array</span><span class=p>([[</span><span class=mf>16.714314</span> <span class=p>,</span> <span class=o>-</span><span class=mf>2.0475426</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=mf>17.279623</span> <span class=p>,</span> <span class=o>-</span><span class=mf>2.4140635</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=mf>16.705837</span> <span class=p>,</span> <span class=o>-</span><span class=mf>3.002305</span> <span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=mf>17.19955</span>  <span class=p>,</span> <span class=o>-</span><span class=mf>1.342096</span> <span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=mf>17.838465</span> <span class=p>,</span> <span class=o>-</span><span class=mf>2.021136</span> <span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=mf>18.537838</span> <span class=p>,</span> <span class=o>-</span><span class=mf>1.5079662</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=mf>21.44188</span>  <span class=p>,</span> <span class=o>-</span><span class=mf>2.1259143</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=mf>21.123413</span> <span class=p>,</span> <span class=o>-</span><span class=mf>3.075382</span> <span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=mf>20.373632</span> <span class=p>,</span> <span class=o>-</span><span class=mf>3.0233152</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=mf>21.83852</span>  <span class=p>,</span> <span class=o>-</span><span class=mf>2.899527</span> <span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=mf>20.435349</span> <span class=p>,</span> <span class=o>-</span><span class=mf>2.2629123</span><span class=p>]],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>float32</span><span class=p>),</span>
</span></span><span class=line><span class=cl> <span class=n>array</span><span class=p>([</span> <span class=mi>0</span><span class=p>,</span>  <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span>  <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span>  <span class=mi>1</span><span class=p>,</span>  <span class=mi>1</span><span class=p>,</span>  <span class=mi>1</span><span class=p>,</span>  <span class=mi>1</span><span class=p>]))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>unique_clusters</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>unique</span><span class=p>(</span><span class=n>clusters</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>cluster</span> <span class=ow>in</span> <span class=n>unique_clusters</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>idx</span> <span class=o>=</span> <span class=n>clusters</span> <span class=o>==</span> <span class=n>cluster</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>embedding</span><span class=p>[</span><span class=n>idx</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>embedding</span><span class=p>[</span><span class=n>idx</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>&#39;Cluster </span><span class=si>{</span><span class=n>cluster</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>&#39;Scatter Plot of UMAP Colored by Cluster&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;UMAP_1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;UMAP_2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments><script src=https://giscus.app/client.js data-repo=yshghid/yshghid.github.io data-repo-id=R_kgDONkMkNg data-category-id=DIC_kwDONkMkNs4CloJh data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=ko crossorigin=anonymous async></script></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#1-explainable-aië€>1. Explainable AIë€?</a></li><li><a href=#2-xai-ê¸°ë²•-ë¶„ë¥˜>2. XAI ê¸°ë²• ë¶„ë¥˜</a></li><li><a href=#3-ì£¼ìš”-post-hoc-ì„¤ëª…-ê¸°ë²•>3. ì£¼ìš” Post-hoc ì„¤ëª… ê¸°ë²•</a></li><li><a href=#4-shapì´ë€>4. SHAPì´ë€?</a></li><li><a href=#5-rfì˜-feature-importanceì™€ì˜-ì°¨ì´>5. RFì˜ feature importanceì™€ì˜ ì°¨ì´?</a></li><li><a href=#6-ê²°ë¡ >6. ê²°ë¡ </a></li><li><a href=#7-ì˜ˆì‹œ-ì½”ë“œ>7. ì˜ˆì‹œ ì½”ë“œ</a></li></ul></li></ul></nav></div></aside></main></body></html>