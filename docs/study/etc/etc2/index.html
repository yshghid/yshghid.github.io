<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  #2 Explainable AI
  #

#2025-06-26


  1. Explainable AIë€?
  #

Explainable AIëŠ” ì¸ê³µì§€ëŠ¥(AI) ë˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹(ML) ëª¨ë¸ì´ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ íŠ¹ì • ê²°ê³¼ë¥¼ ë„ì¶œí–ˆëŠ”ì§€ ì‚¬ëŒì´ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ì„¤ëª…í•˜ëŠ” ê¸°ìˆ ê³¼ ë°©ë²•ë¡ .

  2. XAI ê¸°ë²• ë¶„ë¥˜
  #

ëª¨ë¸ êµ¬ì¡°

Intrinsic:	ëª¨ë¸ ìì²´ê°€ ì„¤ëª… ê°€ëŠ¥í•œ êµ¬ì¡° (ì˜ˆ: ì˜ì‚¬ê²°ì •ë‚˜ë¬´, ì„ í˜•íšŒê·€ ë“±)
Post-hoc:	ëª¨ë¸ í•™ìŠµ í›„ ë³„ë„ë¡œ ì„¤ëª… ìƒì„± (ì˜ˆ: SHAP, LIME)
ëŒ€ìƒ
Global:	ì „ì²´ ëª¨ë¸ì˜ ì‘ë™ ì›ë¦¬ë¥¼ ì„¤ëª…
Local:	íŠ¹ì • ìƒ˜í”Œì˜ ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ì„¤ëª…


  3. ì£¼ìš” Post-hoc ì„¤ëª… ê¸°ë²•
  #

LIME (Local Interpretable Model-Agnostic Explanations): ì£¼ë³€ ì…ë ¥ì„ ëœë¤í•˜ê²Œ ìƒì„±í•˜ê³ , ë‹¨ìˆœ ëª¨ë¸(ì„ í˜• íšŒê·€ ë“±)ì„ í•™ìŠµí•´ ê·¼ì‚¬"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://yshghid.github.io/docs/study/etc/etc2/"><meta property="og:site_name" content="Lifelog 2025"><meta property="og:title" content="#2 Explainable AI"><meta property="og:description" content="#2 Explainable AI # #2025-06-26
1. Explainable AIë€? # Explainable AIëŠ” ì¸ê³µì§€ëŠ¥(AI) ë˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹(ML) ëª¨ë¸ì´ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ íŠ¹ì • ê²°ê³¼ë¥¼ ë„ì¶œí–ˆëŠ”ì§€ ì‚¬ëŒì´ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ì„¤ëª…í•˜ëŠ” ê¸°ìˆ ê³¼ ë°©ë²•ë¡ .
2. XAI ê¸°ë²• ë¶„ë¥˜ # ëª¨ë¸ êµ¬ì¡°
Intrinsic:	ëª¨ë¸ ìì²´ê°€ ì„¤ëª… ê°€ëŠ¥í•œ êµ¬ì¡° (ì˜ˆ: ì˜ì‚¬ê²°ì •ë‚˜ë¬´, ì„ í˜•íšŒê·€ ë“±) Post-hoc:	ëª¨ë¸ í•™ìŠµ í›„ ë³„ë„ë¡œ ì„¤ëª… ìƒì„± (ì˜ˆ: SHAP, LIME) ëŒ€ìƒ Global:	ì „ì²´ ëª¨ë¸ì˜ ì‘ë™ ì›ë¦¬ë¥¼ ì„¤ëª… Local:	íŠ¹ì • ìƒ˜í”Œì˜ ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ì„¤ëª… 3. ì£¼ìš” Post-hoc ì„¤ëª… ê¸°ë²• # LIME (Local Interpretable Model-Agnostic Explanations): ì£¼ë³€ ì…ë ¥ì„ ëœë¤í•˜ê²Œ ìƒì„±í•˜ê³ , ë‹¨ìˆœ ëª¨ë¸(ì„ í˜• íšŒê·€ ë“±)ì„ í•™ìŠµí•´ ê·¼ì‚¬"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:published_time" content="2025-06-26T00:00:00+00:00"><meta property="article:modified_time" content="2025-06-26T00:00:00+00:00"><meta property="article:tag" content="2025-06"><title>#2 Explainable AI | Lifelog 2025</title><link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://yshghid.github.io/docs/study/etc/etc2/><link rel=stylesheet href=/book.min.6217d077edb4189fd0578345e84bca1a884dfdee121ff8dc9a0f55cfe0852bc9.css integrity="sha256-YhfQd+20GJ/QV4NF6EvKGohN/e4SH/jcmg9Vz+CFK8k=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.434bfd79a077483be386c724958e30ed5a2002ddad3ea846ed9c908f9f05dc43.js integrity="sha256-Q0v9eaB3SDvjhscklY4w7VogAt2tPqhG7ZyQj58F3EM=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><img src=/logo.png alt=Logo class=book-icon><span>Lifelog 2025</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li class=book-section-flat><span>ê¸°ë¡</span><ul><li><a href=/docs/hobby/book/>ê¸€</a><ul></ul></li><li><a href=/docs/hobby/daily/>ì¼ìƒ</a><ul></ul></li><li><a href=/docs/hobby/etc/>ê¸°íƒ€</a><ul></ul></li><li><a href=/docs/hobby/favorite/>ğŸ¤</a><ul></ul></li></ul></li><li class=book-section-flat><span>ê³µë¶€</span><ul><li><a href=/docs/study/tech/>ì—°êµ¬ì‹¤</a><ul></ul></li><li><a href=/docs/study/career/>ì·¨ì—…</a><ul></ul></li><li><a href=/docs/study/etc/>ê¸°íƒ€</a><ul></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>#2 Explainable AI</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#1-explainable-aië€>1. Explainable AIë€?</a></li><li><a href=#2-xai-ê¸°ë²•-ë¶„ë¥˜>2. XAI ê¸°ë²• ë¶„ë¥˜</a></li><li><a href=#3-ì£¼ìš”-post-hoc-ì„¤ëª…-ê¸°ë²•>3. ì£¼ìš” Post-hoc ì„¤ëª… ê¸°ë²•</a></li><li><a href=#4-shapì´ë€>4. SHAPì´ë€?</a></li><li><a href=#5-rfì˜-feature-importanceì™€ì˜-ì°¨ì´>5. RFì˜ feature importanceì™€ì˜ ì°¨ì´?</a></li><li><a href=#6-ì˜ˆì‹œ-ì½”ë“œ>6. ì˜ˆì‹œ ì½”ë“œ</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=2-explainable-ai>#2 Explainable AI
<a class=anchor href=#2-explainable-ai>#</a></h1><p>#2025-06-26</p><hr><h3 id=1-explainable-aië€>1. Explainable AIë€?
<a class=anchor href=#1-explainable-ai%eb%9e%80>#</a></h3><p>Explainable AIëŠ” ì¸ê³µì§€ëŠ¥(AI) ë˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹(ML) ëª¨ë¸ì´ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ íŠ¹ì • ê²°ê³¼ë¥¼ ë„ì¶œí–ˆëŠ”ì§€ ì‚¬ëŒì´ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ì„¤ëª…í•˜ëŠ” ê¸°ìˆ ê³¼ ë°©ë²•ë¡ .</p><h3 id=2-xai-ê¸°ë²•-ë¶„ë¥˜>2. XAI ê¸°ë²• ë¶„ë¥˜
<a class=anchor href=#2-xai-%ea%b8%b0%eb%b2%95-%eb%b6%84%eb%a5%98>#</a></h3><p>ëª¨ë¸ êµ¬ì¡°</p><ul><li>Intrinsic: ëª¨ë¸ ìì²´ê°€ ì„¤ëª… ê°€ëŠ¥í•œ êµ¬ì¡° (ì˜ˆ: ì˜ì‚¬ê²°ì •ë‚˜ë¬´, ì„ í˜•íšŒê·€ ë“±)</li><li>Post-hoc: ëª¨ë¸ í•™ìŠµ í›„ ë³„ë„ë¡œ ì„¤ëª… ìƒì„± (ì˜ˆ: SHAP, LIME)
ëŒ€ìƒ</li><li>Global: ì „ì²´ ëª¨ë¸ì˜ ì‘ë™ ì›ë¦¬ë¥¼ ì„¤ëª…</li><li>Local: íŠ¹ì • ìƒ˜í”Œì˜ ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ì„¤ëª…</li></ul><h3 id=3-ì£¼ìš”-post-hoc-ì„¤ëª…-ê¸°ë²•>3. ì£¼ìš” Post-hoc ì„¤ëª… ê¸°ë²•
<a class=anchor href=#3-%ec%a3%bc%ec%9a%94-post-hoc-%ec%84%a4%eb%aa%85-%ea%b8%b0%eb%b2%95>#</a></h3><p>LIME (Local Interpretable Model-Agnostic Explanations): ì£¼ë³€ ì…ë ¥ì„ ëœë¤í•˜ê²Œ ìƒì„±í•˜ê³ , ë‹¨ìˆœ ëª¨ë¸(ì„ í˜• íšŒê·€ ë“±)ì„ í•™ìŠµí•´ ê·¼ì‚¬</p><p>SHAP (SHapley Additive exPlanations): ê²Œì„ ì´ë¡ ì˜ ìƒ¤í”Œë¦¬ ê°’ ê¸°ë°˜</p><ul><li>ê° í”¼ì²˜ê°€ ê¸°ì—¬í•œ ì •ë„ë¥¼ ê³µì •í•˜ê²Œ ë¶„ë°°í•˜ì—¬ ì„¤ëª…<ul><li>ì¥ì : ìˆ˜í•™ì ìœ¼ë¡œ ì •ë‹¹ì„± í™•ë³´, ì¼ê´€ëœ ì„¤ëª… ì œê³µ</li><li>ë‹¨ì : ê³„ì‚° ë¹„ìš© í¼</li></ul></li></ul><p>Permutation Importance: ì…ë ¥ í”¼ì²˜ë¥¼ ë¬´ì‘ìœ„ë¡œ ì„ì€ í›„ ì˜ˆì¸¡ ì„±ëŠ¥ ê°ì†Œ ì •ë„ ì¸¡ì •</p><ul><li>ì˜ˆì¸¡ ì„±ëŠ¥ì´ í¬ê²Œ ê°ì†Œí•˜ë©´, ì¤‘ìš”í•œ í”¼ì²˜ë¡œ íŒë‹¨</li></ul><p>Saliency Maps (ì´ë¯¸ì§€ ë¶„ì•¼)</p><h3 id=4-shapì´ë€>4. SHAPì´ë€?
<a class=anchor href=#4-shap%ec%9d%b4%eb%9e%80>#</a></h3><p>ê° feature(ì…ë ¥ ë³€ìˆ˜)ê°€ ëª¨ë¸ì˜ ì˜ˆì¸¡ê°’ì— ì–¼ë§ˆë‚˜ ê¸°ì—¬í–ˆëŠ”ì§€ ì •ëŸ‰ì ìœ¼ë¡œ ê³„ì‚°.</p><p>ì›ë˜ëŠ” í˜‘ë ¥ ê²Œì„ ì´ë¡ ì—ì„œ</p><ul><li>ì—¬ëŸ¬ í”Œë ˆì´ì–´ê°€ íŒ€ì„ ì´ë¤„ ë³´ìƒì„ ë°›ì•˜ì„ ë•Œ, ê° í”Œë ˆì´ì–´ê°€ ì „ì²´ ë³´ìƒì— ì–¼ë§ˆë‚˜ ê¸°ì—¬í–ˆëŠ”ì§€ë¥¼ ê³„ì‚°í•˜ëŠ” ë°©ë²•ì¸ë°</li><li>ì˜ˆì‹œë¡œ<ul><li>ì¶•êµ¬ ê²Œì„ì„ í•˜ì—¬ íŒ€ ì „ì²´ê°€ 100ì ì„ íšë“í–ˆë‹¤ê³  ê°€ì •</li><li>íŒ€ì—ëŠ” ì„ ìˆ˜ A, B, Cê°€ ìˆë‹¤<ul><li>ëˆ„ê°€ ë” ì¤‘ìš”í•œ ì„ ìˆ˜ì¸ì§€, ê° ì„ ìˆ˜ê°€ ì ìˆ˜ì— ì–¼ë§ˆë‚˜ ê¸°ì—¬í–ˆëŠ”ì§€ë¥¼ êµ¬í•˜ë ¤ë©´?</li><li>ìƒ¤í”Œë¦¬ ê°’ì€ ë‹¤ìŒ ìˆœì„œë¡œ ê¸°ì—¬ë„ë¥¼ í‰ê°€:<ol><li>ê°€ëŠ¥í•œ ëª¨ë“  ìˆœì—´ì„ ê³ ë ¤</li><li>ê° ìˆœì—´ì—ì„œ A, B, Cê°€ ì–¸ì œ íŒ€ì— í•©ë¥˜í–ˆëŠ”ì§€</li><li>ê·¸ ì„ ìˆ˜ê°€ íŒ€ì— ë“¤ì–´ì˜¤ë©´ì„œ ì–¼ë§ˆë‚˜ ì ìˆ˜ê°€ ëŠ˜ì—ˆëŠ”ì§€ í™•ì¸ -> ê° ì„ ìˆ˜ì˜ ì´ í‰ê·  ê¸°ì—¬ë„ë¥¼ â€œìƒ¤í”Œë¦¬ ê°’â€ì´ë¼ê³  í•¨.</li></ol></li></ul></li></ul></li></ul><p>ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì—ì„œ:</p><ul><li>ê° featureê°€ í”Œë ˆì´ì–´ ì—­í• ì„ í•¨<ul><li>ëª¨ë¸ì˜ ì˜ˆì¸¡ê°’ì´ íŒ€ì´ ì–»ì€ ì ìˆ˜ì´ê³ <ul><li>SHAPì€ &ldquo;ì´ ì˜ˆì¸¡ê°’ì´ ë‚˜ì˜¤ëŠ” ë°, ê° featureê°€ ì–¼ë§ˆë‚˜ ê¸°ì—¬í–ˆëŠ”ê°€?&ldquo;ë¥¼ ê³„ì‚°.</li><li>ì˜ˆë¥¼ ë“¤ì–´ ëª¨ë¸ì´ ì–´ë–¤ í™˜ìì˜ ì‚¬ë§ í™•ë¥ ì„ 80%ë¼ê³  ì˜ˆì¸¡í–ˆì„ ë•Œ<ul><li>ë‚˜ì´: +15%</li><li>í¡ì—° ì—¬ë¶€: +10%</li><li>í˜ˆì••: +5%</li><li>ê¸°ë³¸ê°’: 50%<ul><li>ì´í•©: 50% + 15 + 10 + 5 = 80%</li></ul></li></ul></li></ul></li></ul></li><li>ì¦‰ SHAPì€ ì˜ˆì¸¡ê°’ì„ base value + ê° featureì˜ ê¸°ì—¬ë„ë¡œ ë¶„í•´í•´ì¤€ë‹¤.</li></ul><p>ìˆ˜í•™ì  ê³„ì‚° ê³¼ì •:</p><ul><li>3ê°œì˜ feature (A, B, C)ì—ì„œ ê°€ëŠ¥í•œ feature ì¡°í•©:<ul><li>{}, {A}, {B}, {C}, {A,B}, {A,C}, {B,C}, {A,B,C}</li><li>SHAPì€ ëª¨ë“  ì¡°í•©ì— ëŒ€í•´,<ul><li>í•´ë‹¹ featureê°€ ë“¤ì–´ê°”ì„ ë•Œì™€ ì•ˆ ë“¤ì–´ê°”ì„ ë•Œ ì˜ˆì¸¡ê°’ ì°¨ì´ë¥¼ ê³„ì‚°<ul><li>ì´ë¥¼ í‰ê· í•˜ì—¬ ê¸°ì—¬ë„(ìƒ¤í”Œë¦¬ ê°’)ë¡œ ì„¤ì •í•œë‹¤.<ul><li>ë‹¨ì : ì¡°í•© ìˆ˜ê°€ 2^Mì´ë¼ì„œ feature ìˆ˜ê°€ ë§ìœ¼ë©´ ê³„ì‚°ëŸ‰ í­ë°œ</li></ul></li></ul></li></ul></li></ul></li></ul><h3 id=5-rfì˜-feature-importanceì™€ì˜-ì°¨ì´>5. RFì˜ feature importanceì™€ì˜ ì°¨ì´?
<a class=anchor href=#5-rf%ec%9d%98-feature-importance%ec%99%80%ec%9d%98-%ec%b0%a8%ec%9d%b4>#</a></h3><table><thead><tr><th>í•­ëª©</th><th>Random Forest Feature Importance</th><th>SHAP</th></tr></thead><tbody><tr><td>ê¸°ë°˜ ê°œë…</td><td>ëª¨ë¸ êµ¬ì¡° ê¸°ë°˜ (gini ê°ì†Œ ë“±)</td><td>ê²Œì„ ì´ë¡  ê¸°ë°˜ (ìƒ¤í”Œë¦¬ ê°’)</td></tr><tr><td>ì„¤ëª… ë°©ì‹</td><td>ì „ì²´ ëª¨ë¸ ìˆ˜ì¤€ (global)</td><td>ì „ì²´ + ê°œë³„ ìƒ˜í”Œ ìˆ˜ì¤€ (global + local)</td></tr><tr><td>ìŒ/ì–‘ êµ¬ë¶„</td><td>ì—†ìŒ (0 ì´ìƒ, í¬ê¸°ë§Œ ì œê³µ)</td><td>ìˆìŒ (ì–‘ìˆ˜: ì˜ˆì¸¡ â†‘, ìŒìˆ˜: ì˜ˆì¸¡ â†“)</td></tr><tr><td>ìƒí˜¸ì‘ìš© ê³ ë ¤</td><td>ë¶€ë¶„ì ìœ¼ë¡œë§Œ ê³ ë ¤</td><td>ì¼ë¶€ ê³ ë ¤ ê°€ëŠ¥ (íŠ¹ì • SHAP variant)</td></tr><tr><td>ì •í™•ì„±</td><td>ëŒ€ëµì ì¸ ì˜í–¥ë„</td><td>ìˆ˜í•™ì ìœ¼ë¡œ ë³´ì¥ëœ ê¸°ì—¬ë„</td></tr><tr><td>ë‹¨ì </td><td>bias ìˆìŒ (ë²”ì£¼ ìˆ˜ ë§ì€ ë³€ìˆ˜ ì„ í˜¸ ë“±)</td><td>ëŠë¦´ ìˆ˜ ìˆìŒ, ê³„ì‚° ë¹„ìš© ë†’ìŒ</td></tr></tbody></table><h3 id=6-ì˜ˆì‹œ-ì½”ë“œ>6. ì˜ˆì‹œ ì½”ë“œ
<a class=anchor href=#6-%ec%98%88%ec%8b%9c-%ec%bd%94%eb%93%9c>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pickle
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> joblib
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> shap
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> seaborn <span style=color:#66d9ef>as</span> sns
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#Load rf model</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;/model/rf_model.pkl&#39;</span>,<span style=color:#e6db74>&#39;rb&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    rf_model <span style=color:#f92672>=</span> joblib<span style=color:#f92672>.</span>load(f)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#Load dataset</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;/preprocessing/processed_data.pickle&#39;</span>,<span style=color:#e6db74>&#39;rb&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    preproc_data <span style=color:#f92672>=</span> pickle<span style=color:#f92672>.</span>load(f)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cytokine_df <span style=color:#f92672>=</span> preproc_data[<span style=color:#e6db74>&#39;cytokine_data&#39;</span>]
</span></span><span style=display:flex><span>patient_meta <span style=color:#f92672>=</span> preproc_data[<span style=color:#e6db74>&#39;metadata&#39;</span>] 
</span></span><span style=display:flex><span>patient_info <span style=color:#f92672>=</span> preproc_data[<span style=color:#e6db74>&#39;clinical&#39;</span>] 
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Get feature importances</span>
</span></span><span style=display:flex><span>importances <span style=color:#f92672>=</span> rf_model<span style=color:#f92672>.</span>feature_importances_
</span></span><span style=display:flex><span>feature_names <span style=color:#f92672>=</span> cytokine_df<span style=color:#f92672>.</span>columns
</span></span><span style=display:flex><span>feature_importances <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame({<span style=color:#e6db74>&#39;feature&#39;</span>: feature_names, <span style=color:#e6db74>&#39;importance&#39;</span>: importances})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Sort the feature importances in descending order and select the top 20</span>
</span></span><span style=display:flex><span>top_20_features <span style=color:#f92672>=</span> feature_importances<span style=color:#f92672>.</span>sort_values(by<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;importance&#39;</span>, ascending<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)<span style=color:#f92672>.</span>head(<span style=color:#ae81ff>20</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Plot the top 20 feature importances</span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>10</span>))
</span></span><span style=display:flex><span>sns<span style=color:#f92672>.</span>barplot(x<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;importance&#39;</span>, y<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;feature&#39;</span>, data<span style=color:#f92672>=</span>top_20_features)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>tree_explainer <span style=color:#f92672>=</span> shap<span style=color:#f92672>.</span>TreeExplainer(rf_model) <span style=color:#75715e>## TreeExplainer</span>
</span></span><span style=display:flex><span>shap_values <span style=color:#f92672>=</span> tree_explainer<span style=color:#f92672>.</span>shap_values(cytokine_df) <span style=color:#75715e>## SHAP Value</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>fig <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>8</span>,<span style=color:#ae81ff>8</span>))
</span></span><span style=display:flex><span>fig<span style=color:#f92672>.</span>set_facecolor(<span style=color:#e6db74>&#39;white&#39;</span>)
</span></span><span style=display:flex><span>ax <span style=color:#f92672>=</span> fig<span style=color:#f92672>.</span>add_subplot()
</span></span><span style=display:flex><span><span style=color:#75715e>#Plot SHAP as sever probability</span>
</span></span><span style=display:flex><span>shap<span style=color:#f92672>.</span>summary_plot(shap_values[<span style=color:#ae81ff>1</span>], cytokine_df, 
</span></span><span style=display:flex><span>                  cmap<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;bwr&#39;</span>, 
</span></span><span style=display:flex><span>                  show<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>, 
</span></span><span style=display:flex><span>                 plot_type<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;dot&#39;</span>)
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>set_xlabel(<span style=color:#e6db74>&#39;SHAP Value&#39;</span>)
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#39;SHAP Dot Plot&#39;</span>, fontsize<span style=color:#f92672>=</span><span style=color:#ae81ff>20</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>shap_df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame(shap_values[<span style=color:#ae81ff>1</span>],columns <span style=color:#f92672>=</span> cytokine_df<span style=color:#f92672>.</span>columns)
</span></span><span style=display:flex><span>shap_df<span style=color:#f92672>.</span>index <span style=color:#f92672>=</span> cytokine_df<span style=color:#f92672>.</span>index
</span></span><span style=display:flex><span>shap_df
</span></span></code></pre></div><p><img src=https://github.com/user-attachments/assets/32d7410b-f67c-4f88-9587-e6b41e8c8276 alt=image></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> umap.umap_ <span style=color:#66d9ef>as</span> umap
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> seaborn <span style=color:#66d9ef>as</span> sns
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>reducer <span style=color:#f92672>=</span> umap<span style=color:#f92672>.</span>UMAP()
</span></span><span style=display:flex><span>embedding <span style=color:#f92672>=</span> reducer<span style=color:#f92672>.</span>fit_transform(shap_df)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Extract UMAP coordinates and labels</span>
</span></span><span style=display:flex><span>umap_x <span style=color:#f92672>=</span> embedding[:, <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>umap_y <span style=color:#f92672>=</span> embedding[:, <span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Create scatter plot</span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>8</span>))
</span></span><span style=display:flex><span>scatter <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>scatter(umap_x, umap_y, cmap<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;bwr&#34;</span>, s<span style=color:#f92672>=</span><span style=color:#ae81ff>50</span>, alpha<span style=color:#f92672>=</span><span style=color:#ae81ff>0.7</span>, edgecolors<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;w&#34;</span>, linewidth<span style=color:#f92672>=</span><span style=color:#ae81ff>0.5</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.cluster <span style=color:#f92672>import</span> DBSCAN
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Initialize DBSCAN</span>
</span></span><span style=display:flex><span>dbscan <span style=color:#f92672>=</span> DBSCAN(eps<span style=color:#f92672>=</span><span style=color:#ae81ff>0.8</span>, min_samples<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>) <span style=color:#75715e># partial data is too small to set min_sample=20.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Fit to UMAP data and get cluster labels</span>
</span></span><span style=display:flex><span>clusters <span style=color:#f92672>=</span> dbscan<span style=color:#f92672>.</span>fit_predict(embedding)
</span></span><span style=display:flex><span>embedding, clusters
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>(array([[<span style=color:#ae81ff>16.714314</span> , <span style=color:#f92672>-</span><span style=color:#ae81ff>2.0475426</span>],
</span></span><span style=display:flex><span>        [<span style=color:#ae81ff>17.279623</span> , <span style=color:#f92672>-</span><span style=color:#ae81ff>2.4140635</span>],
</span></span><span style=display:flex><span>        [<span style=color:#ae81ff>16.705837</span> , <span style=color:#f92672>-</span><span style=color:#ae81ff>3.002305</span> ],
</span></span><span style=display:flex><span>        [<span style=color:#ae81ff>17.19955</span>  , <span style=color:#f92672>-</span><span style=color:#ae81ff>1.342096</span> ],
</span></span><span style=display:flex><span>        [<span style=color:#ae81ff>17.838465</span> , <span style=color:#f92672>-</span><span style=color:#ae81ff>2.021136</span> ],
</span></span><span style=display:flex><span>        [<span style=color:#ae81ff>18.537838</span> , <span style=color:#f92672>-</span><span style=color:#ae81ff>1.5079662</span>],
</span></span><span style=display:flex><span>        [<span style=color:#ae81ff>21.44188</span>  , <span style=color:#f92672>-</span><span style=color:#ae81ff>2.1259143</span>],
</span></span><span style=display:flex><span>        [<span style=color:#ae81ff>21.123413</span> , <span style=color:#f92672>-</span><span style=color:#ae81ff>3.075382</span> ],
</span></span><span style=display:flex><span>        [<span style=color:#ae81ff>20.373632</span> , <span style=color:#f92672>-</span><span style=color:#ae81ff>3.0233152</span>],
</span></span><span style=display:flex><span>        [<span style=color:#ae81ff>21.83852</span>  , <span style=color:#f92672>-</span><span style=color:#ae81ff>2.899527</span> ],
</span></span><span style=display:flex><span>        [<span style=color:#ae81ff>20.435349</span> , <span style=color:#f92672>-</span><span style=color:#ae81ff>2.2629123</span>]], dtype<span style=color:#f92672>=</span>float32),
</span></span><span style=display:flex><span> array([ <span style=color:#ae81ff>0</span>,  <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,  <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,  <span style=color:#ae81ff>1</span>,  <span style=color:#ae81ff>1</span>,  <span style=color:#ae81ff>1</span>,  <span style=color:#ae81ff>1</span>]))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>6</span>))
</span></span><span style=display:flex><span>unique_clusters <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>unique(clusters)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> cluster <span style=color:#f92672>in</span> unique_clusters:
</span></span><span style=display:flex><span>    idx <span style=color:#f92672>=</span> clusters <span style=color:#f92672>==</span> cluster
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>scatter(embedding[idx, <span style=color:#ae81ff>0</span>], embedding[idx, <span style=color:#ae81ff>1</span>], label<span style=color:#f92672>=</span><span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Cluster </span><span style=color:#e6db74>{</span>cluster<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>title(<span style=color:#e6db74>&#39;Scatter Plot of UMAP Colored by Cluster&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>xlabel(<span style=color:#e6db74>&#39;UMAP_1&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>ylabel(<span style=color:#e6db74>&#39;UMAP_2&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>legend()
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments><script src=https://giscus.app/client.js data-repo=yshghid/yshghid.github.io data-repo-id=R_kgDONkMkNg data-category-id=DIC_kwDONkMkNs4CloJh data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=ko crossorigin=anonymous async></script></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#1-explainable-aië€>1. Explainable AIë€?</a></li><li><a href=#2-xai-ê¸°ë²•-ë¶„ë¥˜>2. XAI ê¸°ë²• ë¶„ë¥˜</a></li><li><a href=#3-ì£¼ìš”-post-hoc-ì„¤ëª…-ê¸°ë²•>3. ì£¼ìš” Post-hoc ì„¤ëª… ê¸°ë²•</a></li><li><a href=#4-shapì´ë€>4. SHAPì´ë€?</a></li><li><a href=#5-rfì˜-feature-importanceì™€ì˜-ì°¨ì´>5. RFì˜ feature importanceì™€ì˜ ì°¨ì´?</a></li><li><a href=#6-ì˜ˆì‹œ-ì½”ë“œ>6. ì˜ˆì‹œ ì½”ë“œ</a></li></ul></li></ul></nav></div></aside></main></body></html>