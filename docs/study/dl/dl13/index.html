<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  VAE 기반 신약 분자 생성 #3 AspuruGuzikAutoEncoder 모델 구성
  #

#2026-02-28


  3단계: AspuruGuzikAutoEncoder 모델 구성 (vae.py 20~25행)
  #

from deepchem.models.optimizers import ExponentialDecay
from deepchem.models.seqtoseq import AspuruGuzikAutoEncoder

batch_size = 100
batches_per_epoch = len(train_smiles) / batch_size
learning_rate = ExponentialDecay(0.001, 0.95, batches_per_epoch)
model = AspuruGuzikAutoEncoder(
    tokens, max_length,
    model_dir='vae',
    batch_size=batch_size,
    learning_rate=learning_rate)

  AspuruGuzikAutoEncoder 내부 구조
  #

이 모델은 2018년 Aspuru-Guzik 연구실의 논문
&ldquo;Automatic Chemical Design Using a Data-Driven Continuous Representation of Molecules&rdquo;
에서 제안한 아키텍처다.
인코더 (Encoder):
SMILES 문자열 (예: 길이 120)
    ↓ 문자 임베딩 (one-hot 또는 embedding)
    ↓ GRU × 3층 (순방향)
    ↓ 마지막 은닉 상태 → Dense(196) = μ (평균)
                       → Dense(196) = log σ² (로그 분산)
    ↓ 재파라미터화: z = μ + ε·exp(log σ²/2)
z: 196차원 잠재 벡터

디코더 (Decoder):
z (196차원)
    ↓ Dense → 초기 은닉 상태
    ↓ GRU × 3층 (자기회귀적 생성)
    ↓ 매 스텝마다 Dense(|tokens|) → Softmax
다음 문자 확률 분포 → 문자 샘플링 반복
GRU (Gated Recurrent Unit) 직관:"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://yshghid.github.io/docs/study/dl/dl13/"><meta property="og:site_name" content=" "><meta property="og:title" content="VAE 기반 신약 분자 생성 #3 AspuruGuzikAutoEncoder 모델 구성"><meta property="og:description" content="VAE 기반 신약 분자 생성 #3 AspuruGuzikAutoEncoder 모델 구성 # #2026-02-28
3단계: AspuruGuzikAutoEncoder 모델 구성 (vae.py 20~25행) # from deepchem.models.optimizers import ExponentialDecay from deepchem.models.seqtoseq import AspuruGuzikAutoEncoder batch_size = 100 batches_per_epoch = len(train_smiles) / batch_size learning_rate = ExponentialDecay(0.001, 0.95, batches_per_epoch) model = AspuruGuzikAutoEncoder( tokens, max_length, model_dir='vae', batch_size=batch_size, learning_rate=learning_rate) AspuruGuzikAutoEncoder 내부 구조 # 이 모델은 2018년 Aspuru-Guzik 연구실의 논문 “Automatic Chemical Design Using a Data-Driven Continuous Representation of Molecules” 에서 제안한 아키텍처다.
인코더 (Encoder): SMILES 문자열 (예: 길이 120) ↓ 문자 임베딩 (one-hot 또는 embedding) ↓ GRU × 3층 (순방향) ↓ 마지막 은닉 상태 → Dense(196) = μ (평균) → Dense(196) = log σ² (로그 분산) ↓ 재파라미터화: z = μ + ε·exp(log σ²/2) z: 196차원 잠재 벡터 디코더 (Decoder): z (196차원) ↓ Dense → 초기 은닉 상태 ↓ GRU × 3층 (자기회귀적 생성) ↓ 매 스텝마다 Dense(|tokens|) → Softmax 다음 문자 확률 분포 → 문자 샘플링 반복 GRU (Gated Recurrent Unit) 직관:"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:published_time" content="2026-02-28T00:00:00+00:00"><meta property="article:modified_time" content="2026-02-28T00:00:00+00:00"><meta property="article:tag" content="2026-02"><title>VAE 기반 신약 분자 생성 #3 AspuruGuzikAutoEncoder 모델 구성 |</title><link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://yshghid.github.io/docs/study/dl/dl13/><link rel=stylesheet href=/book.min.30a7836b6a89342da3b88e7afd1036166aeced16c8de12df060ded2031837886.css integrity="sha256-MKeDa2qJNC2juI56/RA2Fmrs7RbI3hLfBg3tIDGDeIY=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.173b9633522e5f435db63a2dec2626e03ef11fa39d2a7de87e716e58ee3be567.js integrity="sha256-FzuWM1IuX0Ndtjot7CYm4D7xH6OdKn3ofnFuWO475Wc=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><img src=/logo.png alt=Logo class=book-icon><span></span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li class=book-section-flat><span>기록</span><ul><li><a href=/docs/hobby/book/>글</a><ul></ul></li><li><a href=/docs/hobby/daily/>일상</a><ul></ul></li></ul></li><li class=book-section-flat><span>공부</span><ul><li><a href=/docs/study/ai/>AI/Data</a><ul></ul></li><li><a href=/docs/study/dl/>DL</a><ul></ul></li><li><a href=/docs/study/bioinformatics/>Bioinformatics</a><ul></ul></li><li><a href=/docs/study/be/>BE</a><ul></ul></li><li><a href=/docs/study/fe/>FE</a><ul></ul></li><li><a href=/docs/study/career/>취업</a><ul></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>VAE 기반 신약 분자 생성 #3 AspuruGuzikAutoEncoder 모델 구성</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#3단계-aspuruguzikautoencoder-모델-구성-vaepy-2025행>3단계: AspuruGuzikAutoEncoder 모델 구성 (<code>vae.py</code> 20~25행)</a><ul><li><a href=#aspuruguzikautoencoder-내부-구조>AspuruGuzikAutoEncoder 내부 구조</a></li><li><a href=#exponentialdecay-학습률>ExponentialDecay 학습률</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=vae-기반-신약-분자-생성-3-aspuruguzikautoencoder-모델-구성>VAE 기반 신약 분자 생성 #3 AspuruGuzikAutoEncoder 모델 구성
<a class=anchor href=#vae-%ea%b8%b0%eb%b0%98-%ec%8b%a0%ec%95%bd-%eb%b6%84%ec%9e%90-%ec%83%9d%ec%84%b1-3-aspuruguzikautoencoder-%eb%aa%a8%eb%8d%b8-%ea%b5%ac%ec%84%b1>#</a></h1><p>#2026-02-28</p><hr><h2 id=3단계-aspuruguzikautoencoder-모델-구성-vaepy-2025행>3단계: AspuruGuzikAutoEncoder 모델 구성 (<code>vae.py</code> 20~25행)
<a class=anchor href=#3%eb%8b%a8%ea%b3%84-aspuruguzikautoencoder-%eb%aa%a8%eb%8d%b8-%ea%b5%ac%ec%84%b1-vaepy-2025%ed%96%89>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> deepchem.models.optimizers <span style=color:#f92672>import</span> ExponentialDecay
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> deepchem.models.seqtoseq <span style=color:#f92672>import</span> AspuruGuzikAutoEncoder
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>batch_size <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>batches_per_epoch <span style=color:#f92672>=</span> len(train_smiles) <span style=color:#f92672>/</span> batch_size
</span></span><span style=display:flex><span>learning_rate <span style=color:#f92672>=</span> ExponentialDecay(<span style=color:#ae81ff>0.001</span>, <span style=color:#ae81ff>0.95</span>, batches_per_epoch)
</span></span><span style=display:flex><span>model <span style=color:#f92672>=</span> AspuruGuzikAutoEncoder(
</span></span><span style=display:flex><span>    tokens, max_length,
</span></span><span style=display:flex><span>    model_dir<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;vae&#39;</span>,
</span></span><span style=display:flex><span>    batch_size<span style=color:#f92672>=</span>batch_size,
</span></span><span style=display:flex><span>    learning_rate<span style=color:#f92672>=</span>learning_rate)
</span></span></code></pre></div><h3 id=aspuruguzikautoencoder-내부-구조>AspuruGuzikAutoEncoder 내부 구조
<a class=anchor href=#aspuruguzikautoencoder-%eb%82%b4%eb%b6%80-%ea%b5%ac%ec%a1%b0>#</a></h3><p>이 모델은 2018년 Aspuru-Guzik 연구실의 논문
<em>&ldquo;Automatic Chemical Design Using a Data-Driven Continuous Representation of Molecules&rdquo;</em>
에서 제안한 아키텍처다.</p><pre tabindex=0><code>인코더 (Encoder):
SMILES 문자열 (예: 길이 120)
    ↓ 문자 임베딩 (one-hot 또는 embedding)
    ↓ GRU × 3층 (순방향)
    ↓ 마지막 은닉 상태 → Dense(196) = μ (평균)
                       → Dense(196) = log σ² (로그 분산)
    ↓ 재파라미터화: z = μ + ε·exp(log σ²/2)
z: 196차원 잠재 벡터

디코더 (Decoder):
z (196차원)
    ↓ Dense → 초기 은닉 상태
    ↓ GRU × 3층 (자기회귀적 생성)
    ↓ 매 스텝마다 Dense(|tokens|) → Softmax
다음 문자 확률 분포 → 문자 샘플링 반복
</code></pre><p><strong>GRU (Gated Recurrent Unit) 직관</strong>:</p><p>SMILES는 순서가 있는 시퀀스다. <code>CC(=O)O</code>에서 <code>(</code>는 그 앞의 <code>C</code>에 가지가 생긴다는 의미다.
GRU는 시퀀스를 순서대로 처리하며 <strong>이전 문맥을 기억</strong>한다.</p><pre tabindex=0><code>GRU 처리 흐름:
  &#39;C&#39; → h₁ → &#39;C&#39; → h₂ → &#39;(&#39; → h₃ → &#39;=&#39; → h₄ → ...
  ↑              ↑              ↑
이전 은닉 상태를 다음 스텝에 전달 → 긴 의존성 학습
</code></pre><p><strong>잠재 벡터 차원 = 196</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span>np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>normal(size<span style=color:#f92672>=</span>(<span style=color:#ae81ff>1000</span>, <span style=color:#ae81ff>196</span>))  <span style=color:#75715e># 나중에 생성할 때 사용</span>
</span></span></code></pre></div><p>196은 이 논문에서 선택한 값이다. 수만 개 분자의 구조 정보를 196개 실수로 압축한다.</p><hr><h3 id=exponentialdecay-학습률>ExponentialDecay 학습률
<a class=anchor href=#exponentialdecay-%ed%95%99%ec%8a%b5%eb%a5%a0>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span>batches_per_epoch <span style=color:#f92672>=</span> len(train_smiles) <span style=color:#f92672>/</span> batch_size
</span></span><span style=display:flex><span>learning_rate <span style=color:#f92672>=</span> ExponentialDecay(<span style=color:#ae81ff>0.001</span>, <span style=color:#ae81ff>0.95</span>, batches_per_epoch)
</span></span></code></pre></div><p>매 에포크마다 학습률을 0.95배 감소:</p><pre tabindex=0><code>epoch 0:  lr = 0.001
epoch 1:  lr = 0.001 × 0.95 = 0.00095
epoch 2:  lr = 0.001 × 0.95² ≈ 0.000903
...
epoch 50: lr = 0.001 × 0.95⁵⁰ ≈ 0.000077
</code></pre><p><code>batches_per_epoch</code>를 decay_steps로 사용 → 정확히 에포크 단위로 감소.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments><script src=https://giscus.app/client.js data-repo=yshghid/yshghid.github.io data-repo-id=R_kgDONkMkNg data-category-id=DIC_kwDONkMkNs4CloJh data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=ko crossorigin=anonymous async></script></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#3단계-aspuruguzikautoencoder-모델-구성-vaepy-2025행>3단계: AspuruGuzikAutoEncoder 모델 구성 (<code>vae.py</code> 20~25행)</a><ul><li><a href=#aspuruguzikautoencoder-내부-구조>AspuruGuzikAutoEncoder 내부 구조</a></li><li><a href=#exponentialdecay-학습률>ExponentialDecay 학습률</a></li></ul></li></ul></nav></div></aside></main></body></html>