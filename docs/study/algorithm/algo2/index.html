<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  MutClust 코드 리펙토링 #2 arg_parser
  #

#2025-08-01

MutClust 알고리즘의 코드 구성은 아래와 같은데
MutClust
├── sc/
│    └── lib.py
│    └── arg_parser.py // 실행 설정
│    └── utils.py
└── Test
arg_parser.py는 실험 환경 파라미터 세팅 및 CLI 인자 파싱을 포함한다.
# === arg_parser.py ===
import argparse
from os.path import exists
from src.mlib import (
    DIMINISHING_FACTOR, EPSILON, EPSILON_SCALING_FACTOR,
    MAX_EPS, MIN_CLUSTER_LENGTH, CCM_MIN_PERCENTAGE_SUM
)

class ArgsInfo:
    def __init__(self):
        self.args = {}
        self.fin = ''
        self.ref = ''
        self.outdir = ''
        self.eps = EPSILON
        self.maxeps = MAX_EPS
        self.min_persum = CCM_MIN_PERCENTAGE_SUM
        self.eps_scaler_const = EPSILON_SCALING_FACTOR
        self.es_control_const = DIMINISHING_FACTOR
        self.min_cluster_length = MIN_CLUSTER_LENGTH

def set_env(input_path=None, reference=None, output_path=None):
    info = ArgsInfo()
    parser = argparse.ArgumentParser(prog=&#34;cluster.py&#34;)

    parser.add_argument('-f', '--input_file', type=str, default='/data3/projects/2020_MUTCLUST/Data/Rawdata/COVID19/nucleotide_data/mutclust_input_data.txt', help='mutation frequency data file')
    parser.add_argument('-r', '--ref', type=str, default='/data3/projects/2020_MUTCLUST/Data/Rawdata/COVID19/nucleotide_data/new_reference.fasta', help='the reference genome')
    parser.add_argument('-e', '--eps', type=int, default=EPSILON, help='width of window (epsilon)')
    parser.add_argument('--maxeps', type=int, default=MAX_EPS, help='maximum eps')
    parser.add_argument('--minps', type=float, default=CCM_MIN_PERCENTAGE_SUM, help='minimum per_sum')
    parser.add_argument('--es', type=float, default=EPSILON_SCALING_FACTOR, help='eps scaling factor')
    parser.add_argument('--exd', type=float, default=DIMINISHING_FACTOR, help='cluster expansion es diminishing factor')
    parser.add_argument('--minl', type=int, default=MIN_CLUSTER_LENGTH, help='minimum cluster length')

    args = parser.parse_args()

    info.fin = input_path if input_path else args.input_file
    info.ref = reference if reference else args.ref
    info.outdir = output_path if output_path else './output'

    if not exists(info.fin):
        print(f&#34;Input file does not exist: {info.fin}&#34;)
        exit()

    info.eps = args.eps
    info.maxeps = args.maxeps
    info.min_persum = args.minps
    info.eps_scaler_const = args.es
    info.es_control_const = args.exd
    info.min_cluster_length = args.minl

    return info
"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://yshghid.github.io/docs/study/algorithm/algo2/"><meta property="og:site_name" content=" "><meta property="og:title" content="MutClust 코드 리펙토링 #2 arg_parser"><meta property="og:description" content="MutClust 코드 리펙토링 #2 arg_parser # #2025-08-01
MutClust 알고리즘의 코드 구성은 아래와 같은데
MutClust ├── sc/ │ └── lib.py │ └── arg_parser.py // 실행 설정 │ └── utils.py └── Test arg_parser.py는 실험 환경 파라미터 세팅 및 CLI 인자 파싱을 포함한다.
# === arg_parser.py === import argparse from os.path import exists from src.mlib import ( DIMINISHING_FACTOR, EPSILON, EPSILON_SCALING_FACTOR, MAX_EPS, MIN_CLUSTER_LENGTH, CCM_MIN_PERCENTAGE_SUM ) class ArgsInfo: def __init__(self): self.args = {} self.fin = '' self.ref = '' self.outdir = '' self.eps = EPSILON self.maxeps = MAX_EPS self.min_persum = CCM_MIN_PERCENTAGE_SUM self.eps_scaler_const = EPSILON_SCALING_FACTOR self.es_control_const = DIMINISHING_FACTOR self.min_cluster_length = MIN_CLUSTER_LENGTH def set_env(input_path=None, reference=None, output_path=None): info = ArgsInfo() parser = argparse.ArgumentParser(prog=&#34;cluster.py&#34;) parser.add_argument('-f', '--input_file', type=str, default='/data3/projects/2020_MUTCLUST/Data/Rawdata/COVID19/nucleotide_data/mutclust_input_data.txt', help='mutation frequency data file') parser.add_argument('-r', '--ref', type=str, default='/data3/projects/2020_MUTCLUST/Data/Rawdata/COVID19/nucleotide_data/new_reference.fasta', help='the reference genome') parser.add_argument('-e', '--eps', type=int, default=EPSILON, help='width of window (epsilon)') parser.add_argument('--maxeps', type=int, default=MAX_EPS, help='maximum eps') parser.add_argument('--minps', type=float, default=CCM_MIN_PERCENTAGE_SUM, help='minimum per_sum') parser.add_argument('--es', type=float, default=EPSILON_SCALING_FACTOR, help='eps scaling factor') parser.add_argument('--exd', type=float, default=DIMINISHING_FACTOR, help='cluster expansion es diminishing factor') parser.add_argument('--minl', type=int, default=MIN_CLUSTER_LENGTH, help='minimum cluster length') args = parser.parse_args() info.fin = input_path if input_path else args.input_file info.ref = reference if reference else args.ref info.outdir = output_path if output_path else './output' if not exists(info.fin): print(f&#34;Input file does not exist: {info.fin}&#34;) exit() info.eps = args.eps info.maxeps = args.maxeps info.min_persum = args.minps info.eps_scaler_const = args.es info.es_control_const = args.exd info.min_cluster_length = args.minl return info"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:published_time" content="2025-08-01T00:00:00+00:00"><meta property="article:modified_time" content="2025-08-01T00:00:00+00:00"><meta property="article:tag" content="2025-08"><title>MutClust 코드 리펙토링 #2 arg_parser |</title><link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://yshghid.github.io/docs/study/algorithm/algo2/><link rel=stylesheet href=/book.min.6217d077edb4189fd0578345e84bca1a884dfdee121ff8dc9a0f55cfe0852bc9.css integrity="sha256-YhfQd+20GJ/QV4NF6EvKGohN/e4SH/jcmg9Vz+CFK8k=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.578a2d8e6e30e0a0ae3682797882d89ca0cbbf1734d206705396ea76cf57bbb6.js integrity="sha256-V4otjm4w4KCuNoJ5eILYnKDLvxc00gZwU5bqds9Xu7Y=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><img src=/logo.png alt=Logo class=book-icon><span></span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li class=book-section-flat><span>기록</span><ul><li><a href=/docs/hobby/book/>글</a><ul></ul></li><li><a href=/docs/hobby/daily/>일상</a><ul></ul></li></ul></li><li class=book-section-flat><span>공부</span><ul><li><a href=/docs/study/bioinformatics/>Bioinformatics</a><ul></ul></li><li><a href=/docs/study/ai/>AI</a><ul></ul></li><li><a href=/docs/study/sw/>SW</a><ul></ul></li><li><a href=/docs/study/algorithm/>알고리즘</a><ul></ul></li><li><a href=/docs/study/career/>취업</a><ul></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>MutClust 코드 리펙토링 #2 arg_parser</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents></nav></aside></header><article class="markdown book-article"><h1 id=mutclust-코드-리펙토링-2-arg_parser>MutClust 코드 리펙토링 #2 arg_parser
<a class=anchor href=#mutclust-%ec%bd%94%eb%93%9c-%eb%a6%ac%ed%8e%99%ed%86%a0%eb%a7%81-2-arg_parser>#</a></h1><p>#2025-08-01</p><hr><p>MutClust 알고리즘의 코드 구성은 아래와 같은데</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>MutClust
</span></span><span class=line><span class=cl>├── sc/
</span></span><span class=line><span class=cl>│    └── lib.py
</span></span><span class=line><span class=cl>│    └── arg_parser.py // 실행 설정
</span></span><span class=line><span class=cl>│    └── utils.py
</span></span><span class=line><span class=cl>└── Test
</span></span></code></pre></div><p>arg_parser.py는 실험 환경 파라미터 세팅 및 CLI 인자 파싱을 포함한다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># === arg_parser.py ===</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>argparse</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>os.path</span> <span class=kn>import</span> <span class=n>exists</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>src.mlib</span> <span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>DIMINISHING_FACTOR</span><span class=p>,</span> <span class=n>EPSILON</span><span class=p>,</span> <span class=n>EPSILON_SCALING_FACTOR</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>MAX_EPS</span><span class=p>,</span> <span class=n>MIN_CLUSTER_LENGTH</span><span class=p>,</span> <span class=n>CCM_MIN_PERCENTAGE_SUM</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ArgsInfo</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>args</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>fin</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>ref</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>outdir</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>eps</span> <span class=o>=</span> <span class=n>EPSILON</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>maxeps</span> <span class=o>=</span> <span class=n>MAX_EPS</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>min_persum</span> <span class=o>=</span> <span class=n>CCM_MIN_PERCENTAGE_SUM</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>eps_scaler_const</span> <span class=o>=</span> <span class=n>EPSILON_SCALING_FACTOR</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>es_control_const</span> <span class=o>=</span> <span class=n>DIMINISHING_FACTOR</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>min_cluster_length</span> <span class=o>=</span> <span class=n>MIN_CLUSTER_LENGTH</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>set_env</span><span class=p>(</span><span class=n>input_path</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>reference</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>output_path</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>info</span> <span class=o>=</span> <span class=n>ArgsInfo</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span> <span class=o>=</span> <span class=n>argparse</span><span class=o>.</span><span class=n>ArgumentParser</span><span class=p>(</span><span class=n>prog</span><span class=o>=</span><span class=s2>&#34;cluster.py&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-f&#39;</span><span class=p>,</span> <span class=s1>&#39;--input_file&#39;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=s1>&#39;/data3/projects/2020_MUTCLUST/Data/Rawdata/COVID19/nucleotide_data/mutclust_input_data.txt&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=s1>&#39;mutation frequency data file&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-r&#39;</span><span class=p>,</span> <span class=s1>&#39;--ref&#39;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=s1>&#39;/data3/projects/2020_MUTCLUST/Data/Rawdata/COVID19/nucleotide_data/new_reference.fasta&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=s1>&#39;the reference genome&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-e&#39;</span><span class=p>,</span> <span class=s1>&#39;--eps&#39;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>int</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=n>EPSILON</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=s1>&#39;width of window (epsilon)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;--maxeps&#39;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>int</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=n>MAX_EPS</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=s1>&#39;maximum eps&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;--minps&#39;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>float</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=n>CCM_MIN_PERCENTAGE_SUM</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=s1>&#39;minimum per_sum&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;--es&#39;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>float</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=n>EPSILON_SCALING_FACTOR</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=s1>&#39;eps scaling factor&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;--exd&#39;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>float</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=n>DIMINISHING_FACTOR</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=s1>&#39;cluster expansion es diminishing factor&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;--minl&#39;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>int</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=n>MIN_CLUSTER_LENGTH</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=s1>&#39;minimum cluster length&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>args</span> <span class=o>=</span> <span class=n>parser</span><span class=o>.</span><span class=n>parse_args</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>info</span><span class=o>.</span><span class=n>fin</span> <span class=o>=</span> <span class=n>input_path</span> <span class=k>if</span> <span class=n>input_path</span> <span class=k>else</span> <span class=n>args</span><span class=o>.</span><span class=n>input_file</span>
</span></span><span class=line><span class=cl>    <span class=n>info</span><span class=o>.</span><span class=n>ref</span> <span class=o>=</span> <span class=n>reference</span> <span class=k>if</span> <span class=n>reference</span> <span class=k>else</span> <span class=n>args</span><span class=o>.</span><span class=n>ref</span>
</span></span><span class=line><span class=cl>    <span class=n>info</span><span class=o>.</span><span class=n>outdir</span> <span class=o>=</span> <span class=n>output_path</span> <span class=k>if</span> <span class=n>output_path</span> <span class=k>else</span> <span class=s1>&#39;./output&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>exists</span><span class=p>(</span><span class=n>info</span><span class=o>.</span><span class=n>fin</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Input file does not exist: </span><span class=si>{</span><span class=n>info</span><span class=o>.</span><span class=n>fin</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>exit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>info</span><span class=o>.</span><span class=n>eps</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>eps</span>
</span></span><span class=line><span class=cl>    <span class=n>info</span><span class=o>.</span><span class=n>maxeps</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>maxeps</span>
</span></span><span class=line><span class=cl>    <span class=n>info</span><span class=o>.</span><span class=n>min_persum</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>minps</span>
</span></span><span class=line><span class=cl>    <span class=n>info</span><span class=o>.</span><span class=n>eps_scaler_const</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>es</span>
</span></span><span class=line><span class=cl>    <span class=n>info</span><span class=o>.</span><span class=n>es_control_const</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>exd</span>
</span></span><span class=line><span class=cl>    <span class=n>info</span><span class=o>.</span><span class=n>min_cluster_length</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>minl</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>info</span>
</span></span></code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments><script src=https://giscus.app/client.js data-repo=yshghid/yshghid.github.io data-repo-id=R_kgDONkMkNg data-category-id=DIC_kwDONkMkNs4CloJh data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=ko crossorigin=anonymous async></script></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents></nav></div></aside></main></body></html>