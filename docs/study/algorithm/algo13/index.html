<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  MutClust 알고리즘 로직정리 #1 expand_cluster
  #

#2025-08-05


  1. input
  #

def expand_cluster(ccmIdx, mutData, info):

ccm의 인덱스 ccmIdx
돌연변이 중요도 정보 mutData
info: 기본 세팅 파라미터


  2
  #

scaler_l = mutData[ccmIdx]['eps_scaler']
idx_l = ccmIdx - 1
eps_l = mutData[ccmIdx]['left_distance']
pos_l = mutData[ccmIdx][POS]
#변수설명

scaler_l: ccm의 eps scaler
idx_l: 최초 이웃의 인덱스
eps_l: ccm의 최초 eps
pos_l: ccm의 postion


  3
  #

while idx_l >= 0 and (pos_l - mutData[idx_l][POS]) <= eps_l:
    delta = scaler_l - mutData[idx_l]['eps_scaler']
    scaler_l -= delta / info.es_control_const
    eps_l = max(info.eps * scaler_l, 0)
    idx_l -= 1
#Logic"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://yshghid.github.io/docs/study/algorithm/algo13/"><meta property="og:site_name" content=" "><meta property="og:title" content="MutClust 알고리즘 로직정리 #1 expand_cluster"><meta property="og:description" content="MutClust 알고리즘 로직정리 #1 expand_cluster # #2025-08-05
1. input # def expand_cluster(ccmIdx, mutData, info): ccm의 인덱스 ccmIdx 돌연변이 중요도 정보 mutData info: 기본 세팅 파라미터 2 # scaler_l = mutData[ccmIdx]['eps_scaler'] idx_l = ccmIdx - 1 eps_l = mutData[ccmIdx]['left_distance'] pos_l = mutData[ccmIdx][POS] #변수설명
scaler_l: ccm의 eps scaler idx_l: 최초 이웃의 인덱스 eps_l: ccm의 최초 eps pos_l: ccm의 postion 3 # while idx_l >= 0 and (pos_l - mutData[idx_l][POS]) <= eps_l: delta = scaler_l - mutData[idx_l]['eps_scaler'] scaler_l -= delta / info.es_control_const eps_l = max(info.eps * scaler_l, 0) idx_l -= 1 #Logic"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:published_time" content="2025-08-05T00:00:00+00:00"><meta property="article:modified_time" content="2025-08-05T00:00:00+00:00"><meta property="article:tag" content="2025-08"><title>MutClust 알고리즘 로직정리 #1 expand_cluster |</title><link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://yshghid.github.io/docs/study/algorithm/algo13/><link rel=stylesheet href=/book.min.6217d077edb4189fd0578345e84bca1a884dfdee121ff8dc9a0f55cfe0852bc9.css integrity="sha256-YhfQd+20GJ/QV4NF6EvKGohN/e4SH/jcmg9Vz+CFK8k=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.850220299d05288122524721a3be0c45dc8727b8a3f4150a0c21164d1262eff6.js integrity="sha256-hQIgKZ0FKIEiUkcho74MRdyHJ7ij9BUKDCEWTRJi7/Y=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><img src=/logo.png alt=Logo class=book-icon><span></span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li class=book-section-flat><span>기록</span><ul><li><a href=/docs/hobby/book/>글</a><ul></ul></li><li><a href=/docs/hobby/daily/>일상</a><ul></ul></li></ul></li><li class=book-section-flat><span>공부</span><ul><li><a href=/docs/study/bioinformatics/>Bioinformatics</a><ul></ul></li><li><a href=/docs/study/ai/>AI</a><ul></ul></li><li><a href=/docs/study/sw/>SW</a><ul></ul></li><li><a href=/docs/study/algorithm/>알고리즘</a><ul></ul></li><li><a href=/docs/study/career/>취업</a><ul></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>MutClust 알고리즘 로직정리 #1 expand_cluster</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#1-input>1. input</a></li><li><a href=#2>2</a></li><li><a href=#3>3</a></li><li><a href=#4>4</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=mutclust-알고리즘-로직정리-1-expand_cluster>MutClust 알고리즘 로직정리 #1 expand_cluster
<a class=anchor href=#mutclust-%ec%95%8c%ea%b3%a0%eb%a6%ac%ec%a6%98-%eb%a1%9c%ec%a7%81%ec%a0%95%eb%a6%ac-1-expand_cluster>#</a></h1><p>#2025-08-05</p><hr><h3 id=1-input>1. input
<a class=anchor href=#1-input>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>expand_cluster</span>(ccmIdx, mutData, info):
</span></span></code></pre></div><ul><li>ccm의 인덱스 ccmIdx</li><li>돌연변이 중요도 정보 mutData</li><li>info: 기본 세팅 파라미터</li></ul><h3 id=2>2
<a class=anchor href=#2>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>scaler_l <span style=color:#f92672>=</span> mutData[ccmIdx][<span style=color:#e6db74>&#39;eps_scaler&#39;</span>]
</span></span><span style=display:flex><span>idx_l <span style=color:#f92672>=</span> ccmIdx <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>eps_l <span style=color:#f92672>=</span> mutData[ccmIdx][<span style=color:#e6db74>&#39;left_distance&#39;</span>]
</span></span><span style=display:flex><span>pos_l <span style=color:#f92672>=</span> mutData[ccmIdx][POS]
</span></span></code></pre></div><p>#변수설명</p><ul><li>scaler_l: ccm의 eps scaler</li><li>idx_l: 최초 이웃의 인덱스</li><li>eps_l: ccm의 최초 eps</li><li>pos_l: ccm의 postion</li></ul><h3 id=3>3
<a class=anchor href=#3>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>while</span> idx_l <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>and</span> (pos_l <span style=color:#f92672>-</span> mutData[idx_l][POS]) <span style=color:#f92672>&lt;=</span> eps_l:
</span></span><span style=display:flex><span>    delta <span style=color:#f92672>=</span> scaler_l <span style=color:#f92672>-</span> mutData[idx_l][<span style=color:#e6db74>&#39;eps_scaler&#39;</span>]
</span></span><span style=display:flex><span>    scaler_l <span style=color:#f92672>-=</span> delta <span style=color:#f92672>/</span> info<span style=color:#f92672>.</span>es_control_const
</span></span><span style=display:flex><span>    eps_l <span style=color:#f92672>=</span> max(info<span style=color:#f92672>.</span>eps <span style=color:#f92672>*</span> scaler_l, <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>    idx_l <span style=color:#f92672>-=</span> <span style=color:#ae81ff>1</span>
</span></span></code></pre></div><p>#Logic</p><ol><li>ccm의 eps scaler와 최초 이웃의 eps scaler의 차를 delta로 받는다.</li><li>ccm의 eps scaler를 delta/DIMIN_FACTOR을 뺀 값으로 업데이트(DIMIN_FACTOR=3)</li><li>eps scaler * EPSILON으로 ccm의 eps(eps_l)를 업데이트. (EPSILON=5)</li><li>다음 이웃에 대해 반복한다.<ul><li>그만둬야하는 경우: 현재 이웃 인덱스가 0미만이 될때</li><li>언제까지 반복하는가: ccm(pos_l)에서 현재 이웃(mutData[idx_l])까지의 거리가 업데이트 된 eps(eps_l)이하로 떨어지면 종료.</li></ul></li></ol><p>#Keypoint</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>delta <span style=color:#f92672>=</span> scaler_l <span style=color:#f92672>-</span> mutData[idx_l][<span style=color:#e6db74>&#39;eps_scaler&#39;</span>]
</span></span><span style=display:flex><span>scaler_l <span style=color:#f92672>-=</span> delta <span style=color:#f92672>/</span> info<span style=color:#f92672>.</span>es_control_const
</span></span><span style=display:flex><span>eps_l <span style=color:#f92672>=</span> max(info<span style=color:#f92672>.</span>eps <span style=color:#f92672>*</span> scaler_l, <span style=color:#ae81ff>0</span>)
</span></span></code></pre></div><ol><li>eps scaler가 작다는 건 중요도가 낮다는 뜻이다.</li><li>이웃 변이의 중요도가 낮으면 delta가 커진다. delta가 크면 그만큼 scaler을 더 많이 깎아내리므로 eps_l도 작아진다. 클러스터를 더 왼쪽으로 확장할 수 있는 거리 한계가 빠르게 줄어들게 된다. 즉, 품질이 낮은 변이를 만나면 그쪽으로는 금방 확장이 멈추게 되는 것이다. 반대로 이웃의 eps_scaler가 중심 변이와 비슷하거나 더 크다면 delta가 작아지고, es_l 감소폭도 작아져서 l_max가 크게 줄어들지 않는다. 그러면 확장할 수 있는 여유가 더 생기고, 결과적으로 비슷한 품질의 이웃들을 더 많이 포함하는 클러스터를 만들 수 있게 된다.</li></ol><h3 id=4>4
<a class=anchor href=#4>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>idx_l <span style=color:#f92672>=</span> max(idx_l <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>idx_r <span style=color:#f92672>=</span> min(idx_r <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>, mut_n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>clust <span style=color:#f92672>=</span> [a[POS] <span style=color:#66d9ef>for</span> a <span style=color:#f92672>in</span> mutData[idx_l:idx_r <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] <span style=color:#66d9ef>if</span> a[HSCORE] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>]
</span></span></code></pre></div><p>#full code</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># --- Cluster Expansion ---</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>expand_cluster</span>(ccmIdx, mutData, info):
</span></span><span style=display:flex><span>    scaler_l <span style=color:#f92672>=</span> es_r <span style=color:#f92672>=</span> mutData[ccmIdx][<span style=color:#e6db74>&#39;eps_scaler&#39;</span>]
</span></span><span style=display:flex><span>    idx_l, idx_r <span style=color:#f92672>=</span> ccmIdx <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>, ccmIdx <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    mut_n <span style=color:#f92672>=</span> len(mutData)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    eps_l, eps_r <span style=color:#f92672>=</span> mutData[ccmIdx][<span style=color:#e6db74>&#39;left_distance&#39;</span>], mutData[ccmIdx][<span style=color:#e6db74>&#39;right_distance&#39;</span>]
</span></span><span style=display:flex><span>    pos_l <span style=color:#f92672>=</span> mutData[ccmIdx][POS]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> idx_l <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>and</span> (pos_l <span style=color:#f92672>-</span> mutData[idx_l][POS]) <span style=color:#f92672>&lt;=</span> eps_l:
</span></span><span style=display:flex><span>        delta <span style=color:#f92672>=</span> scaler_l <span style=color:#f92672>-</span> mutData[idx_l][<span style=color:#e6db74>&#39;eps_scaler&#39;</span>]
</span></span><span style=display:flex><span>        scaler_l <span style=color:#f92672>-=</span> delta <span style=color:#f92672>/</span> info<span style=color:#f92672>.</span>es_control_const
</span></span><span style=display:flex><span>        eps_l <span style=color:#f92672>=</span> max(info<span style=color:#f92672>.</span>eps <span style=color:#f92672>*</span> scaler_l, <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>        idx_l <span style=color:#f92672>-=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> idx_r <span style=color:#f92672>&lt;</span> mut_n <span style=color:#f92672>and</span> (mutData[idx_r][POS] <span style=color:#f92672>-</span> pos_l) <span style=color:#f92672>&lt;=</span> eps_r:
</span></span><span style=display:flex><span>        delta <span style=color:#f92672>=</span> es_r <span style=color:#f92672>-</span> mutData[idx_r][<span style=color:#e6db74>&#39;eps_scaler&#39;</span>]
</span></span><span style=display:flex><span>        es_r <span style=color:#f92672>-=</span> delta <span style=color:#f92672>/</span> info<span style=color:#f92672>.</span>es_control_const
</span></span><span style=display:flex><span>        eps_r <span style=color:#f92672>=</span> max(info<span style=color:#f92672>.</span>eps <span style=color:#f92672>*</span> es_r, <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>        idx_r <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    idx_l <span style=color:#f92672>=</span> max(idx_l <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>    idx_r <span style=color:#f92672>=</span> min(idx_r <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>, mut_n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    clust <span style=color:#f92672>=</span> [a[POS] <span style=color:#66d9ef>for</span> a <span style=color:#f92672>in</span> mutData[idx_l:idx_r <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] <span style=color:#66d9ef>if</span> a[HSCORE] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;left_position&#39;</span>: min(clust),
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;right_position&#39;</span>: max(clust),
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;length&#39;</span>: max(clust) <span style=color:#f92672>-</span> min(clust) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;mut_positions&#39;</span>: <span style=color:#e6db74>&#39;,&#39;</span><span style=color:#f92672>.</span>join(map(str, sorted(clust)))
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments><script src=https://giscus.app/client.js data-repo=yshghid/yshghid.github.io data-repo-id=R_kgDONkMkNg data-category-id=DIC_kwDONkMkNs4CloJh data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=ko crossorigin=anonymous async></script></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#1-input>1. input</a></li><li><a href=#2>2</a></li><li><a href=#3>3</a></li><li><a href=#4>4</a></li></ul></li></ul></nav></div></aside></main></body></html>