<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  AI #2 HPO, XAI 실습
  #

#2025-09-22


  1. 실습 개요
  #


목적

UCI Breast Cancer 데이터를 로드하고 전처리 후 XGBoost 모델을 구축 및 평가
교차검증(StratifiedKFold, KFold)과 하이퍼파라미터 탐색 기법(RandomizedSearchCV, Optuna)을 비교하여 최적 성능을 도출
SHAP을 활용하여 전역적·집단적·개별적 수준에서 해석력을 확보하고 도메인 지식과 연결


구현

데이터 로드: UCI Breast Cancer 데이터셋
데이터 전처리: 타겟(Diagnosis)을 이진화(M=1, B=0), StandardScaler로 범위 스케일링, 상관계수 0.9 이상인 중복 변수 제거
모델 구축: xgboost.XGBClassifier
모델 평가: 정확도, AUC, 분류리포트, 혼동행렬, feature importance
교차검증: KFold, StratifiedKFold
하이퍼파라미터 최적화: Random Search, Optuna TPE
모델 해석 (SHAP)

Bar Summary Plot: 전역적 중요도(평균 |SHAP|)를 통해 주요 변수 확인
Beeswarm Plot: 변수 값 크기(빨강/파랑)와 방향성(+/−)에 따른 분포 해석
Force / Waterfall Plot: 3가지 개별 환자 샘플(예측 확률 극단/불확실, SHAP 영향력 최대, 도메인 특이 케이스)을 선택하여 모델이 어떤 요인 때문에 해당 예측을 내렸는지 설명






  
  #


  2. 실습 보고서
  #

링크 - https://open-trust-407.notion.site/AI-2-XAI-274766ec530e80c8977cd13e3c27af84?source=copy_link"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://yshghid.github.io/docs/study/ai/ai38/"><meta property="og:site_name" content=" "><meta property="og:title" content="AI #2 HPO, XAI 실습"><meta property="og:description" content="AI #2 HPO, XAI 실습 # #2025-09-22
1. 실습 개요 # 목적 UCI Breast Cancer 데이터를 로드하고 전처리 후 XGBoost 모델을 구축 및 평가 교차검증(StratifiedKFold, KFold)과 하이퍼파라미터 탐색 기법(RandomizedSearchCV, Optuna)을 비교하여 최적 성능을 도출 SHAP을 활용하여 전역적·집단적·개별적 수준에서 해석력을 확보하고 도메인 지식과 연결 구현 데이터 로드: UCI Breast Cancer 데이터셋 데이터 전처리: 타겟(Diagnosis)을 이진화(M=1, B=0), StandardScaler로 범위 스케일링, 상관계수 0.9 이상인 중복 변수 제거 모델 구축: xgboost.XGBClassifier 모델 평가: 정확도, AUC, 분류리포트, 혼동행렬, feature importance 교차검증: KFold, StratifiedKFold 하이퍼파라미터 최적화: Random Search, Optuna TPE 모델 해석 (SHAP) Bar Summary Plot: 전역적 중요도(평균 |SHAP|)를 통해 주요 변수 확인 Beeswarm Plot: 변수 값 크기(빨강/파랑)와 방향성(+/−)에 따른 분포 해석 Force / Waterfall Plot: 3가지 개별 환자 샘플(예측 확률 극단/불확실, SHAP 영향력 최대, 도메인 특이 케이스)을 선택하여 모델이 어떤 요인 때문에 해당 예측을 내렸는지 설명 # 2. 실습 보고서 # 링크 - https://open-trust-407.notion.site/AI-2-XAI-274766ec530e80c8977cd13e3c27af84?source=copy_link"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:published_time" content="2025-09-22T00:00:00+00:00"><meta property="article:modified_time" content="2025-09-22T00:00:00+00:00"><meta property="article:tag" content="2025-09"><title>AI #2 HPO, XAI 실습 |</title><link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://yshghid.github.io/docs/study/ai/ai38/><link rel=stylesheet href=/book.min.30a7836b6a89342da3b88e7afd1036166aeced16c8de12df060ded2031837886.css integrity="sha256-MKeDa2qJNC2juI56/RA2Fmrs7RbI3hLfBg3tIDGDeIY=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.dfb8db6f4d25f997bfa72215ba3307be706f543020a387bb8f0dcee6e38ba176.js integrity="sha256-37jbb00l+Ze/pyIVujMHvnBvVDAgo4e7jw3O5uOLoXY=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><img src=/logo.png alt=Logo class=book-icon><span></span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li class=book-section-flat><span>기록</span><ul><li><a href=/docs/hobby/daily/>일상</a><ul></ul></li><li><a href=/docs/hobby/book/>글</a><ul></ul></li></ul></li><li class=book-section-flat><span>공부</span><ul><li><a href=/docs/study/ai/>AI</a><ul></ul></li><li><a href=/docs/study/bioinformatics/>Bioinformatics</a><ul></ul></li><li><a href=/docs/study/be/>BE</a><ul></ul></li><li><a href=/docs/study/fe/>FE</a><ul></ul></li><li><a href=/docs/study/career/>취업</a><ul></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>AI #2 HPO, XAI 실습</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#1-실습-개요>1. 실습 개요</a></li><li></li><li><a href=#2-실습-보고서>2. 실습 보고서</a></li><li></li><li><a href=#3-프롬프팅1---하이퍼파라미터별-의미>3. 프롬프팅1 - 하이퍼파라미터별 의미</a></li><li></li><li><a href=#4-프롬프팅2---shap-플롯-해석법>4. 프롬프팅2 - SHAP 플롯 해석법</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=ai-2-hpo-xai-실습>AI #2 HPO, XAI 실습
<a class=anchor href=#ai-2-hpo-xai-%ec%8b%a4%ec%8a%b5>#</a></h1><p>#2025-09-22</p><hr><h3 id=1-실습-개요>1. 실습 개요
<a class=anchor href=#1-%ec%8b%a4%ec%8a%b5-%ea%b0%9c%ec%9a%94>#</a></h3><ul><li>목적<ul><li>UCI Breast Cancer 데이터를 로드하고 전처리 후 XGBoost 모델을 구축 및 평가</li><li>교차검증(StratifiedKFold, KFold)과 하이퍼파라미터 탐색 기법(RandomizedSearchCV, Optuna)을 비교하여 최적 성능을 도출</li><li>SHAP을 활용하여 전역적·집단적·개별적 수준에서 해석력을 확보하고 도메인 지식과 연결</li></ul></li><li>구현<ul><li>데이터 로드: UCI Breast Cancer 데이터셋</li><li>데이터 전처리: 타겟(Diagnosis)을 이진화(M=1, B=0), StandardScaler로 범위 스케일링, 상관계수 0.9 이상인 중복 변수 제거</li><li>모델 구축: xgboost.XGBClassifier</li><li>모델 평가: 정확도, AUC, 분류리포트, 혼동행렬, feature importance</li><li>교차검증: KFold, StratifiedKFold</li><li>하이퍼파라미터 최적화: Random Search, Optuna TPE</li><li>모델 해석 (SHAP)<ul><li>Bar Summary Plot: 전역적 중요도(평균 |SHAP|)를 통해 주요 변수 확인</li><li>Beeswarm Plot: 변수 값 크기(빨강/파랑)와 방향성(+/−)에 따른 분포 해석</li><li>Force / Waterfall Plot: 3가지 개별 환자 샘플(예측 확률 극단/불확실, SHAP 영향력 최대, 도메인 특이 케이스)을 선택하여 모델이 어떤 요인 때문에 해당 예측을 내렸는지 설명</li></ul></li></ul></li></ul><h3><a class=anchor href=#>#</a></h3><h3 id=2-실습-보고서>2. 실습 보고서
<a class=anchor href=#2-%ec%8b%a4%ec%8a%b5-%eb%b3%b4%ea%b3%a0%ec%84%9c>#</a></h3><p>링크 - <a href="https://open-trust-407.notion.site/AI-2-XAI-274766ec530e80c8977cd13e3c27af84?source=copy_link">https://open-trust-407.notion.site/AI-2-XAI-274766ec530e80c8977cd13e3c27af84?source=copy_link</a></p><h3><a class=anchor href=#>#</a></h3><h3 id=3-프롬프팅1---하이퍼파라미터별-의미>3. 프롬프팅1 - 하이퍼파라미터별 의미
<a class=anchor href=#3-%ed%94%84%eb%a1%ac%ed%94%84%ed%8c%851---%ed%95%98%ec%9d%b4%ed%8d%bc%ed%8c%8c%eb%9d%bc%eb%af%b8%ed%84%b0%eb%b3%84-%ec%9d%98%eb%af%b8>#</a></h3><ul><li>값이 클수록?<ul><li>n_estimators (트리 개수): 크면 학습을 오래 시킴, 성능을 높일 수 있음, overfitting</li><li>max_depth (트리 깊이): 깊으면 데이터의 세부 패턴까지 학습해 overfitting</li><li>learning_rate (학습률): 크면 빠르게 학습하지만 최적점을 지나쳐 버릴 수 있어 overfitting. 작으면 한 스텝씩 조심스럽게 학습해 일반화 성능은 좋아지지만 많은 트리 n_estimators가 필요할수있음.</li><li>subsample (샘플 비율): 크면 variance가 크고 overfitting.</li><li>colsample_bytree (특성 샘플링 비율): 1.0이면 모든 피처를 쓰고 낮추면 랜덤성을 주므로 모델 다양성을 높여 overfitting 완화.</li></ul></li></ul><h3><a class=anchor href=#>#</a></h3><h3 id=4-프롬프팅2---shap-플롯-해석법>4. 프롬프팅2 - SHAP 플롯 해석법
<a class=anchor href=#4-%ed%94%84%eb%a1%ac%ed%94%84%ed%8c%852---shap-%ed%94%8c%eb%a1%af-%ed%95%b4%ec%84%9d%eb%b2%95>#</a></h3><ol><li>Bar Summary Plot</li></ol><ul><li>봐야하는것: 막대 길이<ul><li>막대 길이가 길수록 전체 모델 예측에서 해당 변수가 차지하는 중요도가 크다.</li></ul></li><li>해석 포인트<ul><li>막대 길이가 길다: 전역적으로 중요한 변수</li><li>막대 길이가 짧다: 영향력이 거의 없는 변수</li></ul></li></ul><ol start=2><li>Beeswarm Plot</li></ol><ul><li>봐야하는것: 막대 길이, 방향성, 색깔<ul><li>막대 길이의 분포가 넓을수록 샘플별로 변수 효과가 다양하다.</li><li>방향성이 +일수록 예측값을 올린다, -일수록 예측값을 낮춘다.</li><li>색깔이 빨강 = 변수 값이 크다, 파랑 = 변수 값이 작다.</li></ul></li><li>해석 포인트<ul><li>막대길이와 방향성 조합<ul><li>막대길이가 길고 방향성이 양수: 변수 값이 커질수록 예측 확률을 크게 올린다.</li><li>막대길이가 길고 방향성이 음수: 변수 값이 작아질수록 예측 확률을 크게 낮춘다.</li><li>막대길이가 짧거나 방향성이 양/음 혼재: 전체에 미치는 영향은 작음.</li></ul></li><li>색깔과 방향성 조합<ul><li>빨강이면서 방향성이 양수: 값이 클 때 예측값↑</li><li>파랑이면서 방향성이 음수: 값이 작을 때 예측값↓</li><li>원칙적으로는 위와 같은데<ul><li>빨강이면서 음수에 몰림: 값이 클수록 오히려 예측값↓ (역효과)</li><li>파랑이면서 양수에 몰림: 값이 작을수록 오히려 예측값↑ (역효과)</li><li>이런 경우는 보통<ul><li>비선형 관계: 변수 값이 커질수록 예측이 올라가다가, 일정 임계점 넘으면 오히려 내려가는 경우</li><li>상호작용 효과: 다른 변수와 조합됐을 때만 특정 방향으로 작용하는 경우.</li></ul></li></ul></li></ul></li></ul></li></ul><ol start=3><li>Force / Waterfall Plot (개별 샘플 해석)</li></ol><ul><li>봐야하는것: 막대 길이, 방향성<ul><li>막대 길이 길수록 해당 샘플의 예측에 기여한 정도가 크다.</li><li>방향성이 +일수록 예측값을 기준선(Base Value)에서 올리는 요인, -일수록 낮추는 요인.</li></ul></li><li>해석 포인트<ul><li>막대길이가 길고 방향성이 양수: 이 변수 때문에 해당 샘플의 예측 확률이 많이 올라감.</li><li>막대길이가 길고 방향성이 음수: 이 변수 때문에 해당 샘플의 예측 확률이 많이 내려감.</li><li>막대길이가 짧음: 해당 샘플에서는 영향이 거의 없음.</li></ul></li></ul><h1><a class=anchor href=#>#</a></h1></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments><script src=https://giscus.app/client.js data-repo=yshghid/yshghid.github.io data-repo-id=R_kgDONkMkNg data-category-id=DIC_kwDONkMkNs4CloJh data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=ko crossorigin=anonymous async></script></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#1-실습-개요>1. 실습 개요</a></li><li></li><li><a href=#2-실습-보고서>2. 실습 보고서</a></li><li></li><li><a href=#3-프롬프팅1---하이퍼파라미터별-의미>3. 프롬프팅1 - 하이퍼파라미터별 의미</a></li><li></li><li><a href=#4-프롬프팅2---shap-플롯-해석법>4. 프롬프팅2 - SHAP 플롯 해석법</a></li></ul></li></ul></nav></div></aside></main></body></html>