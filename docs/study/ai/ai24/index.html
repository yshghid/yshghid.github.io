<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  MLflow #1 설치 & 실습
  #

#2025-08-21


  1. mlflow 설치 및 docker 띄우기
  #

$ export CR_PAT=* # *: github token 블라인드 처리
$ echo $CR_PAT | docker login ghcr.io -u yshghid --password-stdin
Login Succeeded
로그인햇으면 도커를 켠다음에 다음을 수행.
$ docker pull ghcr.io/mlflow/mlflow:v2.0.1
v2.0.1: Pulling from mlflow/mlflow
7a6db449b51b: Pull complete 
e238bceb2957: Pull complete 
ce77f44508b5: Pull complete 
455a39ac3ab8: Pull complete 
f8c2fbfe5046: Pull complete 
60e3c6e8536b: Pull complete 
Digest: sha256:1e1f28a6134e7e6c4b0d0a4f5f8647ff31c953ad53eb3bb5af4c51ae4e8dd14d
Status: Downloaded newer image for ghcr.io/mlflow/mlflow:v2.0.1
ghcr.io/mlflow/mlflow:v2.0.1

$ docker image ls | grep mlflow
ghcr.io/mlflow/mlflow                                                       v2.0.1                            35853aa42ccd   2 years ago    905MB
확인해보면 제대로 떠있다!!"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://yshghid.github.io/docs/study/ai/ai24/"><meta property="og:site_name" content=" "><meta property="og:title" content="MLflow #1 설치 & 실습"><meta property="og:description" content="MLflow #1 설치 & 실습 # #2025-08-21
1. mlflow 설치 및 docker 띄우기 # $ export CR_PAT=* # *: github token 블라인드 처리 $ echo $CR_PAT | docker login ghcr.io -u yshghid --password-stdin Login Succeeded 로그인햇으면 도커를 켠다음에 다음을 수행.
$ docker pull ghcr.io/mlflow/mlflow:v2.0.1 v2.0.1: Pulling from mlflow/mlflow 7a6db449b51b: Pull complete e238bceb2957: Pull complete ce77f44508b5: Pull complete 455a39ac3ab8: Pull complete f8c2fbfe5046: Pull complete 60e3c6e8536b: Pull complete Digest: sha256:1e1f28a6134e7e6c4b0d0a4f5f8647ff31c953ad53eb3bb5af4c51ae4e8dd14d Status: Downloaded newer image for ghcr.io/mlflow/mlflow:v2.0.1 ghcr.io/mlflow/mlflow:v2.0.1 $ docker image ls | grep mlflow ghcr.io/mlflow/mlflow v2.0.1 35853aa42ccd 2 years ago 905MB 확인해보면 제대로 떠있다!!"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:published_time" content="2025-08-21T00:00:00+00:00"><meta property="article:modified_time" content="2025-08-21T00:00:00+00:00"><meta property="article:tag" content="2025-08"><title>MLflow #1 설치 & 실습 |</title><link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://yshghid.github.io/docs/study/ai/ai24/><link rel=stylesheet href=/book.min.c1243161bf0533845410166eed8d51c01c88b7495cb920164aa7f624f5f1e66a.css integrity="sha256-wSQxYb8FM4RUEBZu7Y1RwByIt0lcuSAWSqf2JPXx5mo=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.d0f14a7a7be64c5b5cad1d1f2a51a3355d428914488c9be6c6787f48e574183a.js integrity="sha256-0PFKenvmTFtcrR0fKlGjNV1CiRRIjJvmxnh/SOV0GDo=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><img src=/logo.png alt=Logo class=book-icon><span></span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li class=book-section-flat><span>기록</span><ul><li><a href=/docs/hobby/book/>글</a><ul></ul></li><li><a href=/docs/hobby/daily/>일상</a><ul></ul></li></ul></li><li class=book-section-flat><span>공부</span><ul><li><a href=/docs/study/bioinformatics/>Bioinformatics</a><ul></ul></li><li><a href=/docs/study/ai/>AI</a><ul></ul></li><li><a href=/docs/study/sw/>SW</a><ul></ul></li><li><a href=/docs/study/algorithm/>알고리즘</a><ul></ul></li><li><a href=/docs/study/career/>취업</a><ul></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>MLflow #1 설치 & 실습</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#1-mlflow-설치-및-docker-띄우기>1. mlflow 설치 및 docker 띄우기</a></li><li></li><li><a href=#2-mlflow-quick-start>2. mlflow quick start</a></li><li></li><li><a href=#3-mlflow-experiments>3. mlflow experiments</a></li><li></li><li></li><li></li><li></li><li></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=mlflow-1-설치--실습>MLflow #1 설치 & 실습
<a class=anchor href=#mlflow-1-%ec%84%a4%ec%b9%98--%ec%8b%a4%ec%8a%b5>#</a></h1><p>#2025-08-21</p><hr><h3 id=1-mlflow-설치-및-docker-띄우기>1. mlflow 설치 및 docker 띄우기
<a class=anchor href=#1-mlflow-%ec%84%a4%ec%b9%98-%eb%b0%8f-docker-%eb%9d%84%ec%9a%b0%ea%b8%b0>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ export CR_PAT<span style=color:#f92672>=</span>* <span style=color:#75715e># *: github token 블라인드 처리</span>
</span></span><span style=display:flex><span>$ echo $CR_PAT | docker login ghcr.io -u yshghid --password-stdin
</span></span><span style=display:flex><span>Login Succeeded
</span></span></code></pre></div><p>로그인햇으면 도커를 켠다음에 다음을 수행.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker pull ghcr.io/mlflow/mlflow:v2.0.1
</span></span><span style=display:flex><span>v2.0.1: Pulling from mlflow/mlflow
</span></span><span style=display:flex><span>7a6db449b51b: Pull complete 
</span></span><span style=display:flex><span>e238bceb2957: Pull complete 
</span></span><span style=display:flex><span>ce77f44508b5: Pull complete 
</span></span><span style=display:flex><span>455a39ac3ab8: Pull complete 
</span></span><span style=display:flex><span>f8c2fbfe5046: Pull complete 
</span></span><span style=display:flex><span>60e3c6e8536b: Pull complete 
</span></span><span style=display:flex><span>Digest: sha256:1e1f28a6134e7e6c4b0d0a4f5f8647ff31c953ad53eb3bb5af4c51ae4e8dd14d
</span></span><span style=display:flex><span>Status: Downloaded newer image <span style=color:#66d9ef>for</span> ghcr.io/mlflow/mlflow:v2.0.1
</span></span><span style=display:flex><span>ghcr.io/mlflow/mlflow:v2.0.1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ docker image ls | grep mlflow
</span></span><span style=display:flex><span>ghcr.io/mlflow/mlflow                                                       v2.0.1                            35853aa42ccd   <span style=color:#ae81ff>2</span> years ago    905MB
</span></span></code></pre></div><p>확인해보면 제대로 떠있다!!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker compose up
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Running 12/12
</span></span><span style=display:flex><span> ⠿ db Pulled                                                                                                                     20.3s
</span></span><span style=display:flex><span>   ⠿ da99ef17bcd1 Pull complete                                                                                                   4.2s
</span></span><span style=display:flex><span>   ⠿ bc12642f0976 Pull complete                                                                                                   4.2s
</span></span><span style=display:flex><span>   ⠿ 739cdd12ec77 Pull complete                                                                                                   4.3s
</span></span><span style=display:flex><span>   ⠿ d7e901e4e4c1 Pull complete                                                                                                   4.4s
</span></span><span style=display:flex><span>   ⠿ 19592870864a Pull complete                                                                                                   4.4s
</span></span><span style=display:flex><span>   ⠿ bbd0027b9705 Pull complete                                                                                                   4.5s
</span></span><span style=display:flex><span>   ⠿ 3da0df221558 Pull complete                                                                                                   8.2s
</span></span><span style=display:flex><span>   ⠿ c055843e3f4c Pull complete                                                                                                   8.3s
</span></span><span style=display:flex><span>   ⠿ 6682c79ed3b0 Pull complete                                                                                                  16.0s
</span></span><span style=display:flex><span>   ⠿ 8583ecde4482 Pull complete                                                                                                  16.0s
</span></span><span style=display:flex><span>   ⠿ c195b220f391 Pull complete                                                                                                  16.1s
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Running 3/3
</span></span><span style=display:flex><span> ⠿ Network learn-mlflow-main_default                                                                                                                     Created 0.1s        Created                                                                                     0.4s
</span></span><span style=display:flex><span> ⠿ Container mysql                                                                                                                                       Created 0.4s
</span></span><span style=display:flex><span> ⠿ Container mlflow                                                                                                                                      Created 0.1s
</span></span></code></pre></div><p>MLflow 서버를 띄웠고 경고창이 뜨는데</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mlflow  | The requested image<span style=color:#960050;background-color:#1e0010>&#39;</span>s platform <span style=color:#f92672>(</span>linux/amd64<span style=color:#f92672>)</span> does not match the detected host platform <span style=color:#f92672>(</span>linux/arm64/v8<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>mlflow  | &lt;jemalloc&gt;: MADV_DONTNEED does not work <span style=color:#f92672>(</span>memset will be used instead<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>This is the expected behaviour <span style=color:#66d9ef>if</span> you are running under QEMU<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>호스트 CPU는 ARM64이고 MLflow 공식 이미지는 AMD64여서 플랫폼 불일치 이슈가 있지만 문제되지는 않고 만약에 해결하고싶으면 docker-compose.yml에 아래와같이쓰면 댄다고함.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>mlflow</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>ghcr.io/mlflow/mlflow:v2.0.1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>linux/amd64</span>
</span></span></code></pre></div><p>docker ps 해보면</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker ps
</span></span><span style=display:flex><span>CONTAINER ID   IMAGE                          COMMAND                  CREATED          STATUS          PORTS                               NAMES
</span></span><span style=display:flex><span>bcb7b2832fb7   ghcr.io/mlflow/mlflow:v2.0.1   <span style=color:#e6db74>&#34;/bin/sh -c &#39;pip ins…&#34;</span>   <span style=color:#ae81ff>21</span> minutes ago   Up <span style=color:#ae81ff>20</span> minutes   0.0.0.0:5001-&gt;5000/tcp              mlflow
</span></span><span style=display:flex><span>87ed94077621   mysql:8.0                      <span style=color:#e6db74>&#34;docker-entrypoint.s…&#34;</span>   <span style=color:#ae81ff>21</span> minutes ago   Up <span style=color:#ae81ff>20</span> minutes   0.0.0.0:3306-&gt;3306/tcp, 33060/tcp   mysql
</span></span></code></pre></div><p>떠있는걸볼수있고</p><p>확인후에 http://localhost:5001/ 접속하기</p><img width=3360 height=2100 alt=image src=https://github.com/user-attachments/assets/3c0cba17-b7ff-4063-aca6-1244fc192b1d><p>잘들어가있다!!</p><h3><a class=anchor href=#>#</a></h3><h3 id=2-mlflow-quick-start>2. mlflow quick start
<a class=anchor href=#2-mlflow-quick-start>#</a></h3><p>튜토리얼 링크 - <a href=https://mlflow.org/docs/latest/getting-started/intro-quickstart/index.html>https://mlflow.org/docs/latest/getting-started/intro-quickstart/index.html</a></p><p>위에서 한 내용이 step1-2여서 step3부터 하면 댄다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Step 3 - Train a model and prepare metadata for logging</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> mlflow
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> mlflow.models <span style=color:#f92672>import</span> infer_signature
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn <span style=color:#f92672>import</span> datasets
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.model_selection <span style=color:#f92672>import</span> train_test_split
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.linear_model <span style=color:#f92672>import</span> LogisticRegression
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.metrics <span style=color:#f92672>import</span> accuracy_score, precision_score, recall_score, f1_score
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Load the Iris dataset</span>
</span></span><span style=display:flex><span>X, y <span style=color:#f92672>=</span> datasets<span style=color:#f92672>.</span>load_iris(return_X_y<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Split the data into training and test sets</span>
</span></span><span style=display:flex><span>X_train, X_test, y_train, y_test <span style=color:#f92672>=</span> train_test_split(
</span></span><span style=display:flex><span>    X, y, test_size<span style=color:#f92672>=</span><span style=color:#ae81ff>0.2</span>, random_state<span style=color:#f92672>=</span><span style=color:#ae81ff>42</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Define the model hyperparameters</span>
</span></span><span style=display:flex><span>params <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;solver&#34;</span>: <span style=color:#e6db74>&#34;lbfgs&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;max_iter&#34;</span>: <span style=color:#ae81ff>1000</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;multi_class&#34;</span>: <span style=color:#e6db74>&#34;auto&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;random_state&#34;</span>: <span style=color:#ae81ff>8888</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Train the model</span>
</span></span><span style=display:flex><span>lr <span style=color:#f92672>=</span> LogisticRegression(<span style=color:#f92672>**</span>params)
</span></span><span style=display:flex><span>lr<span style=color:#f92672>.</span>fit(X_train, y_train)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Predict on the test set</span>
</span></span><span style=display:flex><span>y_pred <span style=color:#f92672>=</span> lr<span style=color:#f92672>.</span>predict(X_test)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate metrics</span>
</span></span><span style=display:flex><span>accuracy <span style=color:#f92672>=</span> accuracy_score(y_test, y_pred)
</span></span></code></pre></div><ul><li>step3는 그냥 사이킷런으로 기본적인 모델 만들기.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Step 4 - Log the model and its metadata to MLflow</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set our tracking server uri for logging</span>
</span></span><span style=display:flex><span>mlflow<span style=color:#f92672>.</span>set_tracking_uri(uri<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://127.0.0.1:8080&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Create a new MLflow Experiment</span>
</span></span><span style=display:flex><span>mlflow<span style=color:#f92672>.</span>set_experiment(<span style=color:#e6db74>&#34;MLflow Quickstart&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Start an MLflow run</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> mlflow<span style=color:#f92672>.</span>start_run():
</span></span><span style=display:flex><span>    <span style=color:#75715e># Log the hyperparameters</span>
</span></span><span style=display:flex><span>    mlflow<span style=color:#f92672>.</span>log_params(params)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Log the loss metric</span>
</span></span><span style=display:flex><span>    mlflow<span style=color:#f92672>.</span>log_metric(<span style=color:#e6db74>&#34;accuracy&#34;</span>, accuracy)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Infer the model signature</span>
</span></span><span style=display:flex><span>    signature <span style=color:#f92672>=</span> infer_signature(X_train, lr<span style=color:#f92672>.</span>predict(X_train))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Log the model, which inherits the parameters and metric</span>
</span></span><span style=display:flex><span>    model_info <span style=color:#f92672>=</span> mlflow<span style=color:#f92672>.</span>sklearn<span style=color:#f92672>.</span>log_model(
</span></span><span style=display:flex><span>        sk_model<span style=color:#f92672>=</span>lr,
</span></span><span style=display:flex><span>        name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;iris_model&#34;</span>,
</span></span><span style=display:flex><span>        signature<span style=color:#f92672>=</span>signature,
</span></span><span style=display:flex><span>        input_example<span style=color:#f92672>=</span>X_train,
</span></span><span style=display:flex><span>        registered_model_name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;tracking-quickstart&#34;</span>,
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Set a tag that we can use to remind ourselves what this model was for</span>
</span></span><span style=display:flex><span>    mlflow<span style=color:#f92672>.</span>set_logged_model_tags(
</span></span><span style=display:flex><span>        model_info<span style=color:#f92672>.</span>model_id, {<span style=color:#e6db74>&#34;Training Info&#34;</span>: <span style=color:#e6db74>&#34;Basic LR model for iris data&#34;</span>}
</span></span><span style=display:flex><span>    )
</span></span></code></pre></div><ul><li>step4는 tracking uri를 설정하고 현재 experiment에 대한 name을 MLflow Quickstart로 정한다.</li><li>model_info에 step3에서 만들었던 lr 모델을 보낸다.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Load the model back for predictions as a generic Python Function model</span>
</span></span><span style=display:flex><span>loaded_model <span style=color:#f92672>=</span> mlflow<span style=color:#f92672>.</span>pyfunc<span style=color:#f92672>.</span>load_model(model_info<span style=color:#f92672>.</span>model_uri)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>predictions <span style=color:#f92672>=</span> loaded_model<span style=color:#f92672>.</span>predict(X_test)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>iris_feature_names <span style=color:#f92672>=</span> datasets<span style=color:#f92672>.</span>load_iris()<span style=color:#f92672>.</span>feature_names
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>result <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame(X_test, columns<span style=color:#f92672>=</span>iris_feature_names)
</span></span><span style=display:flex><span>result[<span style=color:#e6db74>&#34;actual_class&#34;</span>] <span style=color:#f92672>=</span> y_test
</span></span><span style=display:flex><span>result[<span style=color:#e6db74>&#34;predicted_class&#34;</span>] <span style=color:#f92672>=</span> predictions
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>result[:<span style=color:#ae81ff>4</span>]
</span></span></code></pre></div><ul><li>model loading을 하고</li><li>loading된 model을 가지고 test dataset을 사용해서 prediction을 한다.</li></ul><h3><a class=anchor href=#>#</a></h3><h3 id=3-mlflow-experiments>3. mlflow experiments
<a class=anchor href=#3-mlflow-experiments>#</a></h3><p>모델 inference를 하면 mlflow의 experiments에 뜬다. (ui에서 information을 볼수있다)</p><h3><a class=anchor href=#>#</a></h3><p>확인하는원리는?</p><ul><li>compose.yml을 보면</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>./mlruns:/mlflow/mlruns</span>
</span></span></code></pre></div><p>라고 돼있는데 local의 mlruns 디렉토리를 /mlflow/mlruns 도커 이미지 안에 매핑을 시키면 mlruns 디렉토리내 모든 파일들이 도커 이미지로 들어간다.</p><h3><a class=anchor href=#>#</a></h3><p>확인하는법은?</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker ps
</span></span><span style=display:flex><span>CONTAINER ID   IMAGE                          COMMAND                  CREATED              STATUS              PORTS                               NAMES
</span></span><span style=display:flex><span>d40c2085dd73   ghcr.io/mlflow/mlflow:v2.0.1   <span style=color:#e6db74>&#34;/bin/sh -c &#39;pip ins…&#34;</span>   About a minute ago   Up About a minute   0.0.0.0:5001-&gt;5000/tcp              mlflow
</span></span><span style=display:flex><span>9da59e40a1f8   mysql:8.0                      <span style=color:#e6db74>&#34;docker-entrypoint.s…&#34;</span>   About a minute ago   Up About a minute   0.0.0.0:3306-&gt;3306/tcp, 33060/tcp   mysql
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ docker exec -it d40c2085dd73 /bin/bash
</span></span><span style=display:flex><span>root@d40c2085dd73:/# 
</span></span></code></pre></div><ul><li>docker 안으로 들어가서 /mlflow/mlruns 들어가기.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@d40c2085dd73:/# ls
</span></span><span style=display:flex><span>bin  boot  dev  etc  home  lib  lib64  media  mlflow  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var
</span></span><span style=display:flex><span>root@d40c2085dd73:/# cd /mlflow/mlruns
</span></span><span style=display:flex><span>root@d40c2085dd73:/mlflow/mlruns# 
</span></span></code></pre></div><p>여기서 python tutorial.py를 하면 실행된다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@d40c2085dd73:/mlflow/mlruns# python tutorial.py 
</span></span><span style=display:flex><span>&lt;jemalloc&gt;: MADV_DONTNEED does not work <span style=color:#f92672>(</span>memset will be used instead<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>&lt;jemalloc&gt;: <span style=color:#f92672>(</span>This is the expected behaviour <span style=color:#66d9ef>if</span> you are running under QEMU<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>2025/08/22 01:10:51 INFO mlflow.tracking.fluent: Experiment with name <span style=color:#e6db74>&#39;MLflow Quickstart&#39;</span> does not exist. Creating a new experiment.
</span></span><span style=display:flex><span>/usr/local/lib/python3.10/site-packages/_distutils_hack/__init__.py:33: UserWarning: Setuptools is replacing distutils.
</span></span><span style=display:flex><span>  warnings.warn<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Setuptools is replacing distutils.&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Successfully registered model <span style=color:#e6db74>&#39;tracking-quickstart&#39;</span>.
</span></span><span style=display:flex><span>2025/08/22 01:11:01 INFO mlflow.tracking._model_registry.client: Waiting up to <span style=color:#ae81ff>300</span> seconds <span style=color:#66d9ef>for</span> model version to finish creation.                     Model name: tracking-quickstart, version <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Created version <span style=color:#e6db74>&#39;1&#39;</span> of model <span style=color:#e6db74>&#39;tracking-quickstart&#39;</span>.
</span></span><span style=display:flex><span>   sepal length <span style=color:#f92672>(</span>cm<span style=color:#f92672>)</span>  sepal width <span style=color:#f92672>(</span>cm<span style=color:#f92672>)</span>  petal length <span style=color:#f92672>(</span>cm<span style=color:#f92672>)</span>  petal width <span style=color:#f92672>(</span>cm<span style=color:#f92672>)</span>  actual_class  predicted_class
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span>                6.1               2.8                4.7               1.2             <span style=color:#ae81ff>1</span>                <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>                5.7               3.8                1.7               0.3             <span style=color:#ae81ff>0</span>                <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>                7.7               2.6                6.9               2.3             <span style=color:#ae81ff>2</span>                <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span>                6.0               2.9                4.5               1.5             <span style=color:#ae81ff>1</span>                <span style=color:#ae81ff>1</span>
</span></span></code></pre></div><ul><li>iris 데이터를 가지고 모델을 만들고</li><li>mlflow가 tracking을 하고</li><li>model을 만들어서 tracking-quickstart라는 이름으로 register를 함</li><li>그리고 result를 출력.</li><li>tracking url은?<ul><li>compose.yml에 MLFLOW_TRACKING_URI=http://0.0.0.0:5000 로 돼있어서 자동으로 이쪽으로간다(공식 튜토리얼은 mlflow.set_tracking_uri(uri=&ldquo;http://127.0.0.1:8080&rdquo;)</li></ul></li></ul><h3><a class=anchor href=#>#</a></h3><p>tutorial.py에서 run하는부분 코드를 보면 이렇다</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Start an MLflow run</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> mlflow<span style=color:#f92672>.</span>start_run():
</span></span><span style=display:flex><span>    <span style=color:#75715e># Log the hyperparameters</span>
</span></span><span style=display:flex><span>    mlflow<span style=color:#f92672>.</span>log_params(params)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Log the loss metric</span>
</span></span><span style=display:flex><span>    mlflow<span style=color:#f92672>.</span>log_metric(<span style=color:#e6db74>&#34;accuracy&#34;</span>, float(accuracy))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Set a tag that we can use to remind ourselves what this run was for</span>
</span></span><span style=display:flex><span>    mlflow<span style=color:#f92672>.</span>set_tag(<span style=color:#e6db74>&#34;Training Info&#34;</span>, <span style=color:#e6db74>&#34;Basic LR model for iris data&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Infer the model signature</span>
</span></span><span style=display:flex><span>    signature <span style=color:#f92672>=</span> infer_signature(X_train, lr<span style=color:#f92672>.</span>predict(X_train))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Log the model</span>
</span></span><span style=display:flex><span>    model_info <span style=color:#f92672>=</span> mlflow<span style=color:#f92672>.</span>sklearn<span style=color:#f92672>.</span>log_model(
</span></span><span style=display:flex><span>        sk_model<span style=color:#f92672>=</span>lr,
</span></span><span style=display:flex><span>        artifact_path<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;iris_model&#34;</span>,
</span></span><span style=display:flex><span>        signature<span style=color:#f92672>=</span>signature,
</span></span><span style=display:flex><span>        input_example<span style=color:#f92672>=</span>X_train,
</span></span><span style=display:flex><span>        registered_model_name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;tracking-quickstart&#34;</span>,
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Load the model back for predictions as a generic Python Function model</span>
</span></span><span style=display:flex><span>    loaded_model <span style=color:#f92672>=</span> mlflow<span style=color:#f92672>.</span>pyfunc<span style=color:#f92672>.</span>load_model(model_info<span style=color:#f92672>.</span>model_uri)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    predictions <span style=color:#f92672>=</span> loaded_model<span style=color:#f92672>.</span>predict(X_test)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    iris_feature_names <span style=color:#f92672>=</span> datasets<span style=color:#f92672>.</span>load_iris()<span style=color:#f92672>.</span>feature_names
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    result <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame(X_test, columns<span style=color:#f92672>=</span>iris_feature_names)
</span></span><span style=display:flex><span>    result[<span style=color:#e6db74>&#34;actual_class&#34;</span>] <span style=color:#f92672>=</span> y_test
</span></span><span style=display:flex><span>    result[<span style=color:#e6db74>&#34;predicted_class&#34;</span>] <span style=color:#f92672>=</span> predictions
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(result[:<span style=color:#ae81ff>4</span>])
</span></span></code></pre></div><h3><a class=anchor href=#>#</a></h3><p>암튼 이렇게 Inference를 했고 UI(http://localhost:5001/)를보면</p><img width=3360 height=2100 alt=image src=https://github.com/user-attachments/assets/3436999c-6db9-4d8d-bf5d-6e3cba5c9f77><p>mlflow quickstart가 왼쪽에 생겻고 클릭하면 inference(prediction)한게 나온다.</p><img width=3360 height=2100 alt=image src=https://github.com/user-attachments/assets/e4fe2f1d-0e8b-4ff5-84d2-fc3d842d4fd3><p>해당 experiment를 확인해보면</p><ul><li>모델에 대한 정보 environment conda, python environment, requirements.txt 등이 다 넘어왔고</li><li>tagging이돼있음</li><li>tracking quickstart 누르면<ul><li>register된 모델도 뜬다.</li></ul></li></ul><img width=3360 height=2100 alt=image src=https://github.com/user-attachments/assets/246b438a-3023-497a-aa76-e8c494463eac><h3><a class=anchor href=#>#</a></h3><p>정리하면?</p><ul><li>mlflow를 docker pull해서 설치하고 inference해서 ui에서 어떻게 flow가 뜨는지랑 모델 register를 확인했다.</li></ul><h1><a class=anchor href=#>#</a></h1></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments><script src=https://giscus.app/client.js data-repo=yshghid/yshghid.github.io data-repo-id=R_kgDONkMkNg data-category-id=DIC_kwDONkMkNs4CloJh data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=ko crossorigin=anonymous async></script></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#1-mlflow-설치-및-docker-띄우기>1. mlflow 설치 및 docker 띄우기</a></li><li></li><li><a href=#2-mlflow-quick-start>2. mlflow quick start</a></li><li></li><li><a href=#3-mlflow-experiments>3. mlflow experiments</a></li><li></li><li></li><li></li><li></li><li></li></ul></li></ul></nav></div></aside></main></body></html>