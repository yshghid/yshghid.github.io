<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  Langchain #2 LangGraph 기반 Multi-Agent + Agentic RAG 시스템
  #

#2025-10-13


  1. 실습 개요
  #



목적

AI 헬스케어 스타트업의 투자 가치를 평가하기 위해 입력된 스타트업 정보에서 &lsquo;경쟁사 유무를 자동 판별&rsquo;하고, 판별 결과에 따라 워크플로우를 동적으로 분기하여 &lsquo;Multi-Agent 시스템(10개 전문 에이전트)&lsquo;이 각자의 역할(정보 수집, 기술력 분석, 시장성 평가, 경쟁사 비교)을 순차적으로 수행하며, 외부 문서(시장 보고서, 기술 리뷰, 규제 정보)를 &lsquo;RAG 시스템(FAISS + OpenAI Embeddings)&lsquo;으로 검색하여 LLM 분석에 참조 컨텍스트를 제공하고, &lsquo;Scorecard Method 가중치 평가 방식&rsquo;으로 6개 항목(창업자/팀, 시장성, 제품/기술력, 경쟁 우위, 실적, 투자조건)을 정량화하여 10점 만점 투자 점수를 산출한 뒤, 전체 프로세스를 &lsquo;LangGraph 기반 상태 관리 워크플로우&rsquo;로 자동화하고, 최종적으로 분석 결과를 Executive Summary, 기술력/시장성 평가, 경쟁 분석, 투자 판단을 포함한 전문적인 &lsquo;Word/PDF 형식의 투자 평가 보고서&rsquo;로 생성



실습 설계"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://yshghid.github.io/docs/study/ai/ai39/"><meta property="og:site_name" content=" "><meta property="og:title" content="Langchain #2 LangGraph 기반 Multi-Agent + Agentic RAG 시스템"><meta property="og:description" content="Langchain #2 LangGraph 기반 Multi-Agent + Agentic RAG 시스템 # #2025-10-13
1. 실습 개요 # 목적
AI 헬스케어 스타트업의 투자 가치를 평가하기 위해 입력된 스타트업 정보에서 ‘경쟁사 유무를 자동 판별’하고, 판별 결과에 따라 워크플로우를 동적으로 분기하여 ‘Multi-Agent 시스템(10개 전문 에이전트)‘이 각자의 역할(정보 수집, 기술력 분석, 시장성 평가, 경쟁사 비교)을 순차적으로 수행하며, 외부 문서(시장 보고서, 기술 리뷰, 규제 정보)를 ‘RAG 시스템(FAISS + OpenAI Embeddings)‘으로 검색하여 LLM 분석에 참조 컨텍스트를 제공하고, ‘Scorecard Method 가중치 평가 방식’으로 6개 항목(창업자/팀, 시장성, 제품/기술력, 경쟁 우위, 실적, 투자조건)을 정량화하여 10점 만점 투자 점수를 산출한 뒤, 전체 프로세스를 ‘LangGraph 기반 상태 관리 워크플로우’로 자동화하고, 최종적으로 분석 결과를 Executive Summary, 기술력/시장성 평가, 경쟁 분석, 투자 판단을 포함한 전문적인 ‘Word/PDF 형식의 투자 평가 보고서’로 생성 실습 설계"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:published_time" content="2025-10-13T00:00:00+00:00"><meta property="article:modified_time" content="2025-10-13T00:00:00+00:00"><meta property="article:tag" content="2025-10"><title>Langchain #2 LangGraph 기반 Multi-Agent + Agentic RAG 시스템 |</title><link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://yshghid.github.io/docs/study/ai/ai39/><link rel=stylesheet href=/book.min.30a7836b6a89342da3b88e7afd1036166aeced16c8de12df060ded2031837886.css integrity="sha256-MKeDa2qJNC2juI56/RA2Fmrs7RbI3hLfBg3tIDGDeIY=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.43534cd1d44032a92a2fff0b35c0b8b3b1d183e5ac0789c7f808df8c5f1f5a15.js integrity="sha256-Q1NM0dRAMqkqL/8LNcC4s7HRg+WsB4nH+AjfjF8fWhU=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><img src=/logo.png alt=Logo class=book-icon><span></span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li class=book-section-flat><span>기록</span><ul><li><a href=/docs/hobby/daily/>일상</a><ul></ul></li><li><a href=/docs/hobby/book/>글</a><ul></ul></li></ul></li><li class=book-section-flat><span>공부</span><ul><li><a href=/docs/study/bioinformatics/>Bioinformatics</a><ul></ul></li><li><a href=/docs/study/ai/>AI</a><ul></ul></li><li><a href=/docs/study/sw/>SW</a><ul></ul></li><li><a href=/docs/study/career/>취업</a><ul></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Langchain #2 LangGraph 기반 Multi-Agent + Agentic RAG 시스템</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#1-실습-개요>1. 실습 개요</a></li><li><a href=#2-실습-코드>2. 실습 코드</a></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=langchain-2-langgraph-기반-multi-agent--agentic-rag-시스템>Langchain #2 LangGraph 기반 Multi-Agent + Agentic RAG 시스템
<a class=anchor href=#langchain-2-langgraph-%ea%b8%b0%eb%b0%98-multi-agent--agentic-rag-%ec%8b%9c%ec%8a%a4%ed%85%9c>#</a></h1><p>#2025-10-13</p><hr><h3 id=1-실습-개요>1. 실습 개요
<a class=anchor href=#1-%ec%8b%a4%ec%8a%b5-%ea%b0%9c%ec%9a%94>#</a></h3><ul><li><p>목적</p><ul><li>AI 헬스케어 스타트업의 투자 가치를 평가하기 위해 입력된 스타트업 정보에서 &lsquo;경쟁사 유무를 자동 판별&rsquo;하고, 판별 결과에 따라 워크플로우를 동적으로 분기하여 &lsquo;Multi-Agent 시스템(10개 전문 에이전트)&lsquo;이 각자의 역할(정보 수집, 기술력 분석, 시장성 평가, 경쟁사 비교)을 순차적으로 수행하며, 외부 문서(시장 보고서, 기술 리뷰, 규제 정보)를 &lsquo;RAG 시스템(FAISS + OpenAI Embeddings)&lsquo;으로 검색하여 LLM 분석에 참조 컨텍스트를 제공하고, &lsquo;Scorecard Method 가중치 평가 방식&rsquo;으로 6개 항목(창업자/팀, 시장성, 제품/기술력, 경쟁 우위, 실적, 투자조건)을 정량화하여 10점 만점 투자 점수를 산출한 뒤, 전체 프로세스를 &lsquo;LangGraph 기반 상태 관리 워크플로우&rsquo;로 자동화하고, 최종적으로 분석 결과를 Executive Summary, 기술력/시장성 평가, 경쟁 분석, 투자 판단을 포함한 전문적인 &lsquo;Word/PDF 형식의 투자 평가 보고서&rsquo;로 생성</li></ul></li><li><p>실습 설계</p><ul><li>경쟁사 유무 판별: LLM 기반 스타트업 정보 분석 → YES/NO 판단 → 워크플로우 분기점 결정</li><li>Multi-Agent 기반 분석: InvestmentAgents 클래스 내 10개 전문 에이전트(경쟁사 정보 수집, 기술력 분석, 시장성 평가, 경쟁사 비교 등) 독립 실행</li><li>RAG 시스템: FAISS 벡터스토어 + OpenAIEmbeddings를 활용해 외부 문서(PDF, TXT) 검색 → 기술력/시장성 분석 시 컨텍스트 제공</li><li>Scorecard Method: 창업자/팀(30%), 시장성(25%), 제품/기술력(15%), 경쟁 우위(10%), 실적(10%), 투자조건(10%) 가중치 평가 → 10점 만점 점수 산출</li><li>LangGraph 워크플로우: StateGraph로 노드(10개 에이전트) 및 조건부 엣지 정의 → 경쟁사 유무에 따라 동적 경로 분기 → 순차 실행 자동화</li><li>Word/PDF 투자 평가 보고서 생성: python-docx + ReportLab 활용 → 마크다운 파싱 → 투자 점수 강조 → Executive Summary, 기술력/시장성 평가, 경쟁 분석, 투자 판단 포함 전문 보고서 출력</li></ul></li></ul><h3 id=2-실습-코드>2. 실습 코드
<a class=anchor href=#2-%ec%8b%a4%ec%8a%b5-%ec%bd%94%eb%93%9c>#</a></h3><p><mark>프로젝트 구조</mark></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain><span style=display:flex><span>project/
</span></span><span style=display:flex><span>├── config.py                 # 환경 설정
</span></span><span style=display:flex><span>├── models.py                 # 데이터 모델 정의
</span></span><span style=display:flex><span>├── rag_system.py             # RAG 시스템
</span></span><span style=display:flex><span>├── agents.py                 # 투자 평가 에이전트
</span></span><span style=display:flex><span>├── graph.py                  # LangGraph 워크플로우
</span></span><span style=display:flex><span>├── report_generator.py       # 보고서 생성 (Word/PDF)
</span></span><span style=display:flex><span>├── main.py                   # 메인 실행 파일
</span></span><span style=display:flex><span>└── requirements.txt          # 의존성 패키지
</span></span></code></pre></div><h3><a class=anchor href=#>#</a></h3><p><mark>#1 config.py</mark></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># config.py </span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;환경 설정 및 상수 정의&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> dotenv <span style=color:#f92672>import</span> load_dotenv
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 환경 변수 로드</span>
</span></span><span style=display:flex><span>load_dotenv()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># API 설정</span>
</span></span><span style=display:flex><span>OPENAI_API_KEY <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>getenv(<span style=color:#e6db74>&#34;OPENAI_API_KEY&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 모델 설정</span>
</span></span><span style=display:flex><span>LLM_MODEL <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;gpt-4o-mini&#34;</span>
</span></span><span style=display:flex><span>LLM_TEMPERATURE_RAG <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.3</span>
</span></span><span style=display:flex><span>LLM_TEMPERATURE_AGENT <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># RAG 설정</span>
</span></span><span style=display:flex><span>CHUNK_SIZE <span style=color:#f92672>=</span> <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>CHUNK_OVERLAP <span style=color:#f92672>=</span> <span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span>RETRIEVAL_K <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 출력 디렉토리</span>
</span></span><span style=display:flex><span>OUTPUT_DIR <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;outputs&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># RAG 문서 경로</span>
</span></span><span style=display:flex><span>RAG_DOC_PATHS <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;data/rag_docs/02-18-25_CDER AI Discussion Paper_v2.1.pdf&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;data/rag_docs/BRG-Report-AI-and-The-Future-of-Healthcare.pdf&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;data/rag_docs/CB-Insights-Report-The-Generative-AI-in-Healthcare-Market-Map.pdf&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;data/rag_docs/high-performance_medicine_the_convergence_of_human_and_artificial_intelligence_nature_medicine_volume_25_january_2019.pdf&#34;</span>
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><h3><a class=anchor href=#>#</a></h3><p><mark>#2 models.py</mark></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># models.py</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;데이터 모델 정의&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> typing <span style=color:#f92672>import</span> TypedDict, Annotated, List, Optional
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> operator
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>InvestmentState</span>(TypedDict):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;투자 평가 상태&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    startup_name: str
</span></span><span style=display:flex><span>    startup_info: str
</span></span><span style=display:flex><span>    has_competitor: Optional[bool]
</span></span><span style=display:flex><span>    competitor_info: Optional[str]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 타겟 스타트업 분석</span>
</span></span><span style=display:flex><span>    tech_analysis: Optional[str]
</span></span><span style=display:flex><span>    market_analysis: Optional[str]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 경쟁사 분석</span>
</span></span><span style=display:flex><span>    competitor_tech_analysis: Optional[str]
</span></span><span style=display:flex><span>    competitor_market_analysis: Optional[str]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 비교 및 판단</span>
</span></span><span style=display:flex><span>    comparison_result: Optional[str]
</span></span><span style=display:flex><span>    investment_decision: Optional[str]
</span></span><span style=display:flex><span>    investment_score: Optional[float]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 최종 보고서</span>
</span></span><span style=display:flex><span>    final_report: Optional[str]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 메타 정보</span>
</span></span><span style=display:flex><span>    messages: Annotated[List[str], operator<span style=color:#f92672>.</span>add]
</span></span><span style=display:flex><span>    iteration: int
</span></span></code></pre></div><h3><a class=anchor href=#>#</a></h3><p><mark>#3 rag_system.py</mark></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># rag_system.py</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;RAG 시스템 - 문서 기반 정보 검색&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> typing <span style=color:#f92672>import</span> List
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> langchain_openai <span style=color:#f92672>import</span> ChatOpenAI, OpenAIEmbeddings
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> langchain_community.vectorstores <span style=color:#f92672>import</span> FAISS
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> langchain.text_splitter <span style=color:#f92672>import</span> RecursiveCharacterTextSplitter
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> langchain_core.documents <span style=color:#f92672>import</span> Document
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> pypdf <span style=color:#f92672>import</span> PdfReader
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> config <span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>    OPENAI_API_KEY, 
</span></span><span style=display:flex><span>    LLM_MODEL, 
</span></span><span style=display:flex><span>    LLM_TEMPERATURE_RAG,
</span></span><span style=display:flex><span>    CHUNK_SIZE,
</span></span><span style=display:flex><span>    CHUNK_OVERLAP,
</span></span><span style=display:flex><span>    RETRIEVAL_K
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>RAGSystem</span>:
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;RAG 시스템 - 문서 기반 정보 검색&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__init__</span>(self, api_key: str <span style=color:#f92672>=</span> OPENAI_API_KEY):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>llm <span style=color:#f92672>=</span> ChatOpenAI(
</span></span><span style=display:flex><span>            model<span style=color:#f92672>=</span>LLM_MODEL,
</span></span><span style=display:flex><span>            temperature<span style=color:#f92672>=</span>LLM_TEMPERATURE_RAG,
</span></span><span style=display:flex><span>            api_key<span style=color:#f92672>=</span>api_key
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>embeddings <span style=color:#f92672>=</span> OpenAIEmbeddings(api_key<span style=color:#f92672>=</span>api_key)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>vectorstore <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>load_documents</span>(self, file_paths: List[str]) <span style=color:#f92672>-&gt;</span> int:
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;문서 로드 및 벡터 스토어 생성&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        docs <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> path <span style=color:#f92672>in</span> file_paths:
</span></span><span style=display:flex><span>            content <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> path<span style=color:#f92672>.</span>lower()<span style=color:#f92672>.</span>endswith(<span style=color:#e6db74>&#34;.pdf&#34;</span>):
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>with</span> open(path, <span style=color:#e6db74>&#39;rb&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>                        reader <span style=color:#f92672>=</span> PdfReader(f)
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>for</span> page <span style=color:#f92672>in</span> reader<span style=color:#f92672>.</span>pages:
</span></span><span style=display:flex><span>                            content <span style=color:#f92672>+=</span> page<span style=color:#f92672>.</span>extract_text() <span style=color:#f92672>or</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>with</span> open(path, <span style=color:#e6db74>&#39;r&#39;</span>, encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;utf-8&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>                        content <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> content:
</span></span><span style=display:flex><span>                    docs<span style=color:#f92672>.</span>append(Document(
</span></span><span style=display:flex><span>                        page_content<span style=color:#f92672>=</span>content,
</span></span><span style=display:flex><span>                        metadata<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#34;source&#34;</span>: path}
</span></span><span style=display:flex><span>                    ))
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;문서 로드 실패 </span><span style=color:#e6db74>{</span>path<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        text_splitter <span style=color:#f92672>=</span> RecursiveCharacterTextSplitter(
</span></span><span style=display:flex><span>            chunk_size<span style=color:#f92672>=</span>CHUNK_SIZE,
</span></span><span style=display:flex><span>            chunk_overlap<span style=color:#f92672>=</span>CHUNK_OVERLAP
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>        splits <span style=color:#f92672>=</span> text_splitter<span style=color:#f92672>.</span>split_documents(docs)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>vectorstore <span style=color:#f92672>=</span> FAISS<span style=color:#f92672>.</span>from_documents(splits, self<span style=color:#f92672>.</span>embeddings)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> len(splits)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>retrieve</span>(self, query: str, k: int <span style=color:#f92672>=</span> RETRIEVAL_K) <span style=color:#f92672>-&gt;</span> str:
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;관련 문서 검색&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> self<span style=color:#f92672>.</span>vectorstore:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        docs <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>vectorstore<span style=color:#f92672>.</span>similarity_search(query, k<span style=color:#f92672>=</span>k)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n\n</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>join([doc<span style=color:#f92672>.</span>page_content <span style=color:#66d9ef>for</span> doc <span style=color:#f92672>in</span> docs])
</span></span></code></pre></div><h3><a class=anchor href=#>#</a></h3><p><mark>#4 agents.py</mark></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># agents.py</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;투자 평가 에이전트&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> typing <span style=color:#f92672>import</span> List
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> langchain_openai <span style=color:#f92672>import</span> ChatOpenAI
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> langchain_core.prompts <span style=color:#f92672>import</span> ChatPromptTemplate
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> models <span style=color:#f92672>import</span> InvestmentState
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> rag_system <span style=color:#f92672>import</span> RAGSystem
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> config <span style=color:#f92672>import</span> OPENAI_API_KEY, LLM_MODEL, LLM_TEMPERATURE_AGENT
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>InvestmentAgents</span>:
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;투자 평가 에이전트들&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__init__</span>(self, api_key: str <span style=color:#f92672>=</span> OPENAI_API_KEY):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>llm <span style=color:#f92672>=</span> ChatOpenAI(
</span></span><span style=display:flex><span>            model<span style=color:#f92672>=</span>LLM_MODEL,
</span></span><span style=display:flex><span>            temperature<span style=color:#f92672>=</span>LLM_TEMPERATURE_AGENT,
</span></span><span style=display:flex><span>            api_key<span style=color:#f92672>=</span>api_key
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>rag <span style=color:#f92672>=</span> RAGSystem(api_key)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>setup_rag</span>(self, doc_paths: List[str]):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;RAG 시스템 초기화&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        num_chunks <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>rag<span style=color:#f92672>.</span>load_documents(doc_paths)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;✅ RAG 시스템 초기화 완료: </span><span style=color:#e6db74>{</span>num_chunks<span style=color:#e6db74>}</span><span style=color:#e6db74>개 청크 생성&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>check_competitor</span>(self, state: InvestmentState) <span style=color:#f92672>-&gt;</span> InvestmentState:
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;경쟁사 유무 판별&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        prompt <span style=color:#f92672>=</span> ChatPromptTemplate<span style=color:#f92672>.</span>from_messages([
</span></span><span style=display:flex><span>            (<span style=color:#e6db74>&#34;system&#34;</span>, <span style=color:#e6db74>&#34;&#34;&#34;당신은 헬스케어 시장 분석 전문가입니다.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            주어진 스타트업 정보를 분석하여 직접적인 경쟁사가 있는지 판단하세요.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            판단 기준:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            - 동일한 기술 영역 (예: 의료영상 AI, 진단 AI, 신약개발 AI 등)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            - 유사한 타겟 질환 또는 적용 분야
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            - 경쟁 관계가 명시된 경우
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            명확한 경쟁사가 언급되어 있으면 &#39;YES&#39;, 없으면 &#39;NO&#39;로만 답하세요.&#34;&#34;&#34;</span>),
</span></span><span style=display:flex><span>            (<span style=color:#e6db74>&#34;user&#34;</span>, <span style=color:#e6db74>&#34;스타트업 정보:</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>{info}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        ])
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        response <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>llm<span style=color:#f92672>.</span>invoke(
</span></span><span style=display:flex><span>            prompt<span style=color:#f92672>.</span>format_messages(info<span style=color:#f92672>=</span>state[<span style=color:#e6db74>&#34;startup_info&#34;</span>])
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        has_competitor <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;YES&#34;</span> <span style=color:#f92672>in</span> response<span style=color:#f92672>.</span>content<span style=color:#f92672>.</span>upper()
</span></span><span style=display:flex><span>        state[<span style=color:#e6db74>&#34;has_competitor&#34;</span>] <span style=color:#f92672>=</span> has_competitor
</span></span><span style=display:flex><span>        state[<span style=color:#e6db74>&#34;messages&#34;</span>]<span style=color:#f92672>.</span>append(
</span></span><span style=display:flex><span>            <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;경쟁사 유무: </span><span style=color:#e6db74>{</span><span style=color:#e6db74>&#39;있음&#39;</span> <span style=color:#66d9ef>if</span> has_competitor <span style=color:#66d9ef>else</span> <span style=color:#e6db74>&#39;없음&#39;</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> state
</span></span></code></pre></div><h3><a class=anchor href=#>#</a></h3><p>#5 graph.py</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># graph.py</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;LangGraph 워크플로우 구성&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> typing <span style=color:#f92672>import</span> List
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> langgraph.graph <span style=color:#f92672>import</span> StateGraph, END
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> models <span style=color:#f92672>import</span> InvestmentState
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> agents <span style=color:#f92672>import</span> InvestmentAgents
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>create_investment_graph</span>(api_key: str, doc_paths: List[str]):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;투자 평가 그래프 생성&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    agents <span style=color:#f92672>=</span> InvestmentAgents(api_key)
</span></span><span style=display:flex><span>    agents<span style=color:#f92672>.</span>setup_rag(doc_paths)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 그래프 정의</span>
</span></span><span style=display:flex><span>    workflow <span style=color:#f92672>=</span> StateGraph(InvestmentState)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 노드 추가</span>
</span></span><span style=display:flex><span>    workflow<span style=color:#f92672>.</span>add_node(<span style=color:#e6db74>&#34;check_competitor&#34;</span>, agents<span style=color:#f92672>.</span>check_competitor)
</span></span><span style=display:flex><span>    workflow<span style=color:#f92672>.</span>add_node(<span style=color:#e6db74>&#34;collect_startup&#34;</span>, agents<span style=color:#f92672>.</span>collect_startup_info)
</span></span><span style=display:flex><span>    workflow<span style=color:#f92672>.</span>add_node(<span style=color:#e6db74>&#34;collect_competitor&#34;</span>, agents<span style=color:#f92672>.</span>collect_competitor_info)
</span></span><span style=display:flex><span>    workflow<span style=color:#f92672>.</span>add_node(<span style=color:#e6db74>&#34;analyze_tech&#34;</span>, agents<span style=color:#f92672>.</span>analyze_technology)
</span></span><span style=display:flex><span>    workflow<span style=color:#f92672>.</span>add_node(<span style=color:#e6db74>&#34;analyze_competitor_tech&#34;</span>, agents<span style=color:#f92672>.</span>analyze_competitor_technology)
</span></span><span style=display:flex><span>    workflow<span style=color:#f92672>.</span>add_node(<span style=color:#e6db74>&#34;evaluate_market&#34;</span>, agents<span style=color:#f92672>.</span>evaluate_market)
</span></span><span style=display:flex><span>    workflow<span style=color:#f92672>.</span>add_node(<span style=color:#e6db74>&#34;evaluate_competitor_market&#34;</span>, agents<span style=color:#f92672>.</span>evaluate_competitor_market)
</span></span><span style=display:flex><span>    workflow<span style=color:#f92672>.</span>add_node(<span style=color:#e6db74>&#34;compare&#34;</span>, agents<span style=color:#f92672>.</span>compare_competitors)
</span></span><span style=display:flex><span>    workflow<span style=color:#f92672>.</span>add_node(<span style=color:#e6db74>&#34;decide&#34;</span>, agents<span style=color:#f92672>.</span>make_investment_decision)
</span></span><span style=display:flex><span>    workflow<span style=color:#f92672>.</span>add_node(<span style=color:#e6db74>&#34;report&#34;</span>, agents<span style=color:#f92672>.</span>generate_report)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 엣지 정의</span>
</span></span><span style=display:flex><span>    workflow<span style=color:#f92672>.</span>set_entry_point(<span style=color:#e6db74>&#34;check_competitor&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 경쟁사 유무에 따른 분기</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>route_by_competitor</span>(state: InvestmentState):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> state[<span style=color:#e6db74>&#34;has_competitor&#34;</span>] <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;collect_startup&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> state[<span style=color:#e6db74>&#34;has_competitor&#34;</span>]:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;collect_competitor&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;collect_startup&#34;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    workflow<span style=color:#f92672>.</span>add_conditional_edges(
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;check_competitor&#34;</span>,
</span></span><span style=display:flex><span>        route_by_competitor,
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;collect_startup&#34;</span>: <span style=color:#e6db74>&#34;collect_startup&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;collect_competitor&#34;</span>: <span style=color:#e6db74>&#34;collect_competitor&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 경쟁사 없는 경로</span>
</span></span><span style=display:flex><span>    workflow<span style=color:#f92672>.</span>add_edge(<span style=color:#e6db74>&#34;collect_startup&#34;</span>, <span style=color:#e6db74>&#34;analyze_tech&#34;</span>)
</span></span><span style=display:flex><span>    workflow<span style=color:#f92672>.</span>add_edge(<span style=color:#e6db74>&#34;analyze_tech&#34;</span>, <span style=color:#e6db74>&#34;evaluate_market&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 경쟁사 있는 경로</span>
</span></span><span style=display:flex><span>    workflow<span style=color:#f92672>.</span>add_edge(<span style=color:#e6db74>&#34;collect_competitor&#34;</span>, <span style=color:#e6db74>&#34;analyze_competitor_tech&#34;</span>)
</span></span><span style=display:flex><span>    workflow<span style=color:#f92672>.</span>add_edge(<span style=color:#e6db74>&#34;analyze_competitor_tech&#34;</span>, <span style=color:#e6db74>&#34;evaluate_competitor_market&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 병합 지점 (경쟁사 비교 또는 투자 판단)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>route_to_comparison</span>(state: InvestmentState):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> state<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;competitor_market_analysis&#34;</span>):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;compare&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;decide&#34;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    workflow<span style=color:#f92672>.</span>add_conditional_edges(
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;evaluate_market&#34;</span>,
</span></span><span style=display:flex><span>        route_to_comparison,
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;compare&#34;</span>: <span style=color:#e6db74>&#34;compare&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;decide&#34;</span>: <span style=color:#e6db74>&#34;decide&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    workflow<span style=color:#f92672>.</span>add_edge(<span style=color:#e6db74>&#34;evaluate_competitor_market&#34;</span>, <span style=color:#e6db74>&#34;compare&#34;</span>)
</span></span><span style=display:flex><span>    workflow<span style=color:#f92672>.</span>add_edge(<span style=color:#e6db74>&#34;compare&#34;</span>, <span style=color:#e6db74>&#34;decide&#34;</span>)
</span></span><span style=display:flex><span>    workflow<span style=color:#f92672>.</span>add_edge(<span style=color:#e6db74>&#34;decide&#34;</span>, <span style=color:#e6db74>&#34;report&#34;</span>)
</span></span><span style=display:flex><span>    workflow<span style=color:#f92672>.</span>add_edge(<span style=color:#e6db74>&#34;report&#34;</span>, END)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> workflow<span style=color:#f92672>.</span>compile()
</span></span></code></pre></div><h3><a class=anchor href=#>#</a></h3><p>#6 report_generator.py</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;보고서 생성 - Word/PDF&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> typing <span style=color:#f92672>import</span> Dict
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> datetime <span style=color:#f92672>import</span> datetime
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> docx <span style=color:#f92672>import</span> Document <span style=color:#66d9ef>as</span> DocxDocument
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> docx.shared <span style=color:#f92672>import</span> Pt, Inches, RGBColor
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> docx.enum.text <span style=color:#f92672>import</span> WD_PARAGRAPH_ALIGNMENT
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> reportlab.lib.pagesizes <span style=color:#f92672>import</span> letter
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> reportlab.lib.styles <span style=color:#f92672>import</span> getSampleStyleSheet, ParagraphStyle
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> reportlab.platypus <span style=color:#f92672>import</span> SimpleDocTemplate, Paragraph, Spacer
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> reportlab.lib.enums <span style=color:#f92672>import</span> TA_CENTER
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> reportlab.lib <span style=color:#f92672>import</span> colors
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> config <span style=color:#f92672>import</span> OUTPUT_DIR
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>save_report_as_docx</span>(result: Dict, startup_name: str) <span style=color:#f92672>-&gt;</span> str:
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Word 문서로 보고서 저장&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    doc <span style=color:#f92672>=</span> DocxDocument()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 문서 제목</span>
</span></span><span style=display:flex><span>    title <span style=color:#f92672>=</span> doc<span style=color:#f92672>.</span>add_heading(<span style=color:#e6db74>&#39;AI 스타트업 투자 평가 보고서&#39;</span>, <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>    title<span style=color:#f92672>.</span>alignment <span style=color:#f92672>=</span> WD_PARAGRAPH_ALIGNMENT<span style=color:#f92672>.</span>CENTER
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 부제목</span>
</span></span><span style=display:flex><span>    subtitle <span style=color:#f92672>=</span> doc<span style=color:#f92672>.</span>add_paragraph(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{</span>startup_name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>    subtitle<span style=color:#f92672>.</span>alignment <span style=color:#f92672>=</span> WD_PARAGRAPH_ALIGNMENT<span style=color:#f92672>.</span>CENTER
</span></span><span style=display:flex><span>    subtitle_format <span style=color:#f92672>=</span> subtitle<span style=color:#f92672>.</span>runs[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>    subtitle_format<span style=color:#f92672>.</span>font<span style=color:#f92672>.</span>size <span style=color:#f92672>=</span> Pt(<span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>    subtitle_format<span style=color:#f92672>.</span>font<span style=color:#f92672>.</span>color<span style=color:#f92672>.</span>rgb <span style=color:#f92672>=</span> RGBColor(<span style=color:#ae81ff>70</span>, <span style=color:#ae81ff>130</span>, <span style=color:#ae81ff>180</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 날짜</span>
</span></span><span style=display:flex><span>    date_para <span style=color:#f92672>=</span> doc<span style=color:#f92672>.</span>add_paragraph(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;평가일: </span><span style=color:#e6db74>{</span>datetime<span style=color:#f92672>.</span>now()<span style=color:#f92672>.</span>strftime(<span style=color:#e6db74>&#34;%Y년 %m월 </span><span style=color:#e6db74>%d</span><span style=color:#e6db74>일&#34;</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>    date_para<span style=color:#f92672>.</span>alignment <span style=color:#f92672>=</span> WD_PARAGRAPH_ALIGNMENT<span style=color:#f92672>.</span>CENTER
</span></span><span style=display:flex><span>    date_para<span style=color:#f92672>.</span>runs[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>font<span style=color:#f92672>.</span>size <span style=color:#f92672>=</span> Pt(<span style=color:#ae81ff>11</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    doc<span style=color:#f92672>.</span>add_paragraph()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 투자 점수 강조</span>
</span></span><span style=display:flex><span>    score_para <span style=color:#f92672>=</span> doc<span style=color:#f92672>.</span>add_heading(<span style=color:#e6db74>&#39;투자 평가 점수&#39;</span>, level<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>    score_value <span style=color:#f92672>=</span> doc<span style=color:#f92672>.</span>add_paragraph(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>result[<span style=color:#e6db74>&#39;investment_score&#39;</span>]<span style=color:#e6db74>:</span><span style=color:#e6db74>.1f</span><span style=color:#e6db74>}</span><span style=color:#e6db74> / 10.0&#34;</span>)
</span></span><span style=display:flex><span>    score_value<span style=color:#f92672>.</span>runs[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>font<span style=color:#f92672>.</span>size <span style=color:#f92672>=</span> Pt(<span style=color:#ae81ff>24</span>)
</span></span><span style=display:flex><span>    score_value<span style=color:#f92672>.</span>runs[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>font<span style=color:#f92672>.</span>bold <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>    score_value<span style=color:#f92672>.</span>runs[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>font<span style=color:#f92672>.</span>color<span style=color:#f92672>.</span>rgb <span style=color:#f92672>=</span> RGBColor(<span style=color:#ae81ff>220</span>, <span style=color:#ae81ff>20</span>, <span style=color:#ae81ff>60</span>) <span style=color:#66d9ef>if</span> result[<span style=color:#e6db74>&#39;investment_score&#39;</span>] <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>7.0</span> <span style=color:#66d9ef>else</span> RGBColor(<span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>140</span>, <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>    score_value<span style=color:#f92672>.</span>alignment <span style=color:#f92672>=</span> WD_PARAGRAPH_ALIGNMENT<span style=color:#f92672>.</span>CENTER
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    doc<span style=color:#f92672>.</span>add_paragraph()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 보고서 본문 파싱</span>
</span></span><span style=display:flex><span>    report_content <span style=color:#f92672>=</span> result[<span style=color:#e6db74>&#39;final_report&#39;</span>]
</span></span><span style=display:flex><span>    lines <span style=color:#f92672>=</span> report_content<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> lines:
</span></span><span style=display:flex><span>        line <span style=color:#f92672>=</span> line<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> line:
</span></span><span style=display:flex><span>            doc<span style=color:#f92672>.</span>add_paragraph()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> line<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#39;# &#39;</span>):
</span></span><span style=display:flex><span>            doc<span style=color:#f92672>.</span>add_heading(line[<span style=color:#ae81ff>2</span>:], level<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> line<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#39;## &#39;</span>):
</span></span><span style=display:flex><span>            doc<span style=color:#f92672>.</span>add_heading(line[<span style=color:#ae81ff>3</span>:], level<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> line<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#39;### &#39;</span>):
</span></span><span style=display:flex><span>            doc<span style=color:#f92672>.</span>add_heading(line[<span style=color:#ae81ff>4</span>:], level<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> line<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#39;- &#39;</span>):
</span></span><span style=display:flex><span>            p <span style=color:#f92672>=</span> doc<span style=color:#f92672>.</span>add_paragraph(line[<span style=color:#ae81ff>2</span>:], style<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;List Bullet&#39;</span>)
</span></span><span style=display:flex><span>            p<span style=color:#f92672>.</span>runs[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>font<span style=color:#f92672>.</span>size <span style=color:#f92672>=</span> Pt(<span style=color:#ae81ff>11</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> line<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#39;**&#39;</span>) <span style=color:#f92672>and</span> line<span style=color:#f92672>.</span>endswith(<span style=color:#e6db74>&#39;**&#39;</span>):
</span></span><span style=display:flex><span>            p <span style=color:#f92672>=</span> doc<span style=color:#f92672>.</span>add_paragraph()
</span></span><span style=display:flex><span>            run <span style=color:#f92672>=</span> p<span style=color:#f92672>.</span>add_run(line[<span style=color:#ae81ff>2</span>:<span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>])
</span></span><span style=display:flex><span>            run<span style=color:#f92672>.</span>bold <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>            run<span style=color:#f92672>.</span>font<span style=color:#f92672>.</span>size <span style=color:#f92672>=</span> Pt(<span style=color:#ae81ff>11</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            p <span style=color:#f92672>=</span> doc<span style=color:#f92672>.</span>add_paragraph(line)
</span></span><span style=display:flex><span>            p<span style=color:#f92672>.</span>runs[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>font<span style=color:#f92672>.</span>size <span style=color:#f92672>=</span> Pt(<span style=color:#ae81ff>11</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 파일 저장</span>
</span></span><span style=display:flex><span>    output_path <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>OUTPUT_DIR<span style=color:#e6db74>}</span><span style=color:#e6db74>/</span><span style=color:#e6db74>{</span>startup_name<span style=color:#e6db74>}</span><span style=color:#e6db74>_투자평가보고서.docx&#34;</span>
</span></span><span style=display:flex><span>    os<span style=color:#f92672>.</span>makedirs(OUTPUT_DIR, exist_ok<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>    doc<span style=color:#f92672>.</span>save(output_path)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> output_path
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>save_report_as_pdf</span>(result: Dict, startup_name: str) <span style=color:#f92672>-&gt;</span> str:
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;PDF 문서로 보고서 저장&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    output_path <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>OUTPUT_DIR<span style=color:#e6db74>}</span><span style=color:#e6db74>/</span><span style=color:#e6db74>{</span>startup_name<span style=color:#e6db74>}</span><span style=color:#e6db74>_투자평가보고서.pdf&#34;</span>
</span></span><span style=display:flex><span>    os<span style=color:#f92672>.</span>makedirs(OUTPUT_DIR, exist_ok<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    doc <span style=color:#f92672>=</span> SimpleDocTemplate(output_path, pagesize<span style=color:#f92672>=</span>letter)
</span></span><span style=display:flex><span>    story <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    styles <span style=color:#f92672>=</span> getSampleStyleSheet()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 커스텀 스타일</span>
</span></span><span style=display:flex><span>    title_style <span style=color:#f92672>=</span> ParagraphStyle(
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;CustomTitle&#39;</span>,
</span></span><span style=display:flex><span>        parent<span style=color:#f92672>=</span>styles[<span style=color:#e6db74>&#39;Title&#39;</span>],
</span></span><span style=display:flex><span>        fontSize<span style=color:#f92672>=</span><span style=color:#ae81ff>24</span>,
</span></span><span style=display:flex><span>        textColor<span style=color:#f92672>=</span>colors<span style=color:#f92672>.</span>HexColor(<span style=color:#e6db74>&#39;#2C3E50&#39;</span>),
</span></span><span style=display:flex><span>        spaceAfter<span style=color:#f92672>=</span><span style=color:#ae81ff>12</span>,
</span></span><span style=display:flex><span>        alignment<span style=color:#f92672>=</span>TA_CENTER
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    subtitle_style <span style=color:#f92672>=</span> ParagraphStyle(
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;CustomSubtitle&#39;</span>,
</span></span><span style=display:flex><span>        parent<span style=color:#f92672>=</span>styles[<span style=color:#e6db74>&#39;Normal&#39;</span>],
</span></span><span style=display:flex><span>        fontSize<span style=color:#f92672>=</span><span style=color:#ae81ff>16</span>,
</span></span><span style=display:flex><span>        textColor<span style=color:#f92672>=</span>colors<span style=color:#f92672>.</span>HexColor(<span style=color:#e6db74>&#39;#4682B4&#39;</span>),
</span></span><span style=display:flex><span>        spaceAfter<span style=color:#f92672>=</span><span style=color:#ae81ff>6</span>,
</span></span><span style=display:flex><span>        alignment<span style=color:#f92672>=</span>TA_CENTER
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    heading1_style <span style=color:#f92672>=</span> ParagraphStyle(
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;CustomHeading1&#39;</span>,
</span></span><span style=display:flex><span>        parent<span style=color:#f92672>=</span>styles[<span style=color:#e6db74>&#39;Heading1&#39;</span>],
</span></span><span style=display:flex><span>        fontSize<span style=color:#f92672>=</span><span style=color:#ae81ff>16</span>,
</span></span><span style=display:flex><span>        textColor<span style=color:#f92672>=</span>colors<span style=color:#f92672>.</span>HexColor(<span style=color:#e6db74>&#39;#2C3E50&#39;</span>),
</span></span><span style=display:flex><span>        spaceAfter<span style=color:#f92672>=</span><span style=color:#ae81ff>12</span>,
</span></span><span style=display:flex><span>        spaceBefore<span style=color:#f92672>=</span><span style=color:#ae81ff>12</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    heading2_style <span style=color:#f92672>=</span> ParagraphStyle(
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;CustomHeading2&#39;</span>,
</span></span><span style=display:flex><span>        parent<span style=color:#f92672>=</span>styles[<span style=color:#e6db74>&#39;Heading2&#39;</span>],
</span></span><span style=display:flex><span>        fontSize<span style=color:#f92672>=</span><span style=color:#ae81ff>14</span>,
</span></span><span style=display:flex><span>        textColor<span style=color:#f92672>=</span>colors<span style=color:#f92672>.</span>HexColor(<span style=color:#e6db74>&#39;#34495E&#39;</span>),
</span></span><span style=display:flex><span>        spaceAfter<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>,
</span></span><span style=display:flex><span>        spaceBefore<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    normal_style <span style=color:#f92672>=</span> ParagraphStyle(
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;CustomNormal&#39;</span>,
</span></span><span style=display:flex><span>        parent<span style=color:#f92672>=</span>styles[<span style=color:#e6db74>&#39;Normal&#39;</span>],
</span></span><span style=display:flex><span>        fontSize<span style=color:#f92672>=</span><span style=color:#ae81ff>11</span>,
</span></span><span style=display:flex><span>        spaceAfter<span style=color:#f92672>=</span><span style=color:#ae81ff>6</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 제목</span>
</span></span><span style=display:flex><span>    story<span style=color:#f92672>.</span>append(Paragraph(<span style=color:#e6db74>&#34;AI 스타트업 투자 평가 보고서&#34;</span>, title_style))
</span></span><span style=display:flex><span>    story<span style=color:#f92672>.</span>append(Spacer(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0.1</span><span style=color:#f92672>*</span>Inches))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 부제목</span>
</span></span><span style=display:flex><span>    story<span style=color:#f92672>.</span>append(Paragraph(startup_name, subtitle_style))
</span></span><span style=display:flex><span>    story<span style=color:#f92672>.</span>append(Spacer(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0.1</span><span style=color:#f92672>*</span>Inches))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 날짜</span>
</span></span><span style=display:flex><span>    date_text <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;평가일: </span><span style=color:#e6db74>{</span>datetime<span style=color:#f92672>.</span>now()<span style=color:#f92672>.</span>strftime(<span style=color:#e6db74>&#39;%Y년 %m월 </span><span style=color:#e6db74>%d</span><span style=color:#e6db74>일&#39;</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    story<span style=color:#f92672>.</span>append(Paragraph(date_text, normal_style))
</span></span><span style=display:flex><span>    story<span style=color:#f92672>.</span>append(Spacer(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0.3</span><span style=color:#f92672>*</span>Inches))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 투자 점수</span>
</span></span><span style=display:flex><span>    score_style <span style=color:#f92672>=</span> ParagraphStyle(
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;Score&#39;</span>,
</span></span><span style=display:flex><span>        parent<span style=color:#f92672>=</span>styles[<span style=color:#e6db74>&#39;Normal&#39;</span>],
</span></span><span style=display:flex><span>        fontSize<span style=color:#f92672>=</span><span style=color:#ae81ff>20</span>,
</span></span><span style=display:flex><span>        textColor<span style=color:#f92672>=</span>colors<span style=color:#f92672>.</span>HexColor(<span style=color:#e6db74>&#39;#DC143C&#39;</span>) <span style=color:#66d9ef>if</span> result[<span style=color:#e6db74>&#39;investment_score&#39;</span>] <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>7.0</span> <span style=color:#66d9ef>else</span> colors<span style=color:#f92672>.</span>HexColor(<span style=color:#e6db74>&#39;#FF8C00&#39;</span>),
</span></span><span style=display:flex><span>        alignment<span style=color:#f92672>=</span>TA_CENTER,
</span></span><span style=display:flex><span>        spaceAfter<span style=color:#f92672>=</span><span style=color:#ae81ff>12</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    story<span style=color:#f92672>.</span>append(Paragraph(<span style=color:#e6db74>&#34;투자 평가 점수&#34;</span>, heading2_style))
</span></span><span style=display:flex><span>    story<span style=color:#f92672>.</span>append(Paragraph(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;&lt;b&gt;</span><span style=color:#e6db74>{</span>result[<span style=color:#e6db74>&#39;investment_score&#39;</span>]<span style=color:#e6db74>:</span><span style=color:#e6db74>.1f</span><span style=color:#e6db74>}</span><span style=color:#e6db74> / 10.0&lt;/b&gt;&#34;</span>, score_style))
</span></span><span style=display:flex><span>    story<span style=color:#f92672>.</span>append(Spacer(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0.3</span><span style=color:#f92672>*</span>Inches))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 보고서 본문</span>
</span></span><span style=display:flex><span>    report_content <span style=color:#f92672>=</span> result[<span style=color:#e6db74>&#39;final_report&#39;</span>]
</span></span><span style=display:flex><span>    lines <span style=color:#f92672>=</span> report_content<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> lines:
</span></span><span style=display:flex><span>        line <span style=color:#f92672>=</span> line<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> line:
</span></span><span style=display:flex><span>            story<span style=color:#f92672>.</span>append(Spacer(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0.1</span><span style=color:#f92672>*</span>Inches))
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># HTML 특수 문자 이스케이프</span>
</span></span><span style=display:flex><span>        line <span style=color:#f92672>=</span> line<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;&amp;&#39;</span>, <span style=color:#e6db74>&#39;&amp;amp;&#39;</span>)<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;&lt;&#39;</span>, <span style=color:#e6db74>&#39;&amp;lt;&#39;</span>)<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;&gt;&#39;</span>, <span style=color:#e6db74>&#39;&amp;gt;&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> line<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#39;# &#39;</span>):
</span></span><span style=display:flex><span>            story<span style=color:#f92672>.</span>append(Paragraph(line[<span style=color:#ae81ff>2</span>:], heading1_style))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> line<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#39;## &#39;</span>):
</span></span><span style=display:flex><span>            story<span style=color:#f92672>.</span>append(Paragraph(line[<span style=color:#ae81ff>3</span>:], heading2_style))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> line<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#39;### &#39;</span>):
</span></span><span style=display:flex><span>            story<span style=color:#f92672>.</span>append(Paragraph(line[<span style=color:#ae81ff>4</span>:], heading2_style))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> line<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#39;- &#39;</span>):
</span></span><span style=display:flex><span>            story<span style=color:#f92672>.</span>append(Paragraph(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;• </span><span style=color:#e6db74>{</span>line[<span style=color:#ae81ff>2</span>:]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>, normal_style))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> line<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#39;**&#39;</span>) <span style=color:#f92672>and</span> line<span style=color:#f92672>.</span>endswith(<span style=color:#e6db74>&#39;**&#39;</span>):
</span></span><span style=display:flex><span>            story<span style=color:#f92672>.</span>append(Paragraph(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;&lt;b&gt;</span><span style=color:#e6db74>{</span>line[<span style=color:#ae81ff>2</span>:<span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>&lt;/b&gt;&#34;</span>, normal_style))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            story<span style=color:#f92672>.</span>append(Paragraph(line, normal_style))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># PDF 빌드</span>
</span></span><span style=display:flex><span>    doc<span style=color:#f92672>.</span>build(story)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> output_path
</span></span></code></pre></div><h3><a class=anchor href=#>#</a></h3><p><mark>#7 main.py</mark></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># main.py</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;메인 실행 파일&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> typing <span style=color:#f92672>import</span> Dict, List
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> models <span style=color:#f92672>import</span> InvestmentState
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> graph <span style=color:#f92672>import</span> create_investment_graph
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> report_generator <span style=color:#f92672>import</span> save_report_as_docx, save_report_as_pdf
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> config <span style=color:#f92672>import</span> OPENAI_API_KEY, RAG_DOC_PATHS
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>evaluate_startup</span>(
</span></span><span style=display:flex><span>    startup_name: str,
</span></span><span style=display:flex><span>    startup_info: str,
</span></span><span style=display:flex><span>    api_key: str <span style=color:#f92672>=</span> OPENAI_API_KEY,
</span></span><span style=display:flex><span>    doc_paths: List[str] <span style=color:#f92672>=</span> RAG_DOC_PATHS
</span></span><span style=display:flex><span>) <span style=color:#f92672>-&gt;</span> Dict:
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;스타트업 투자 평가 실행&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>{</span><span style=color:#e6db74>&#39;=&#39;</span><span style=color:#f92672>*</span><span style=color:#ae81ff>60</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;🏥 </span><span style=color:#e6db74>{</span>startup_name<span style=color:#e6db74>}</span><span style=color:#e6db74> 투자 평가 시작&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span><span style=color:#e6db74>&#39;=&#39;</span><span style=color:#f92672>*</span><span style=color:#ae81ff>60</span><span style=color:#e6db74>}</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 그래프 생성</span>
</span></span><span style=display:flex><span>    graph <span style=color:#f92672>=</span> create_investment_graph(api_key, doc_paths)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 초기 상태</span>
</span></span><span style=display:flex><span>    initial_state <span style=color:#f92672>=</span> InvestmentState(
</span></span><span style=display:flex><span>        startup_name<span style=color:#f92672>=</span>startup_name,
</span></span><span style=display:flex><span>        startup_info<span style=color:#f92672>=</span>startup_info,
</span></span><span style=display:flex><span>        has_competitor<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>,
</span></span><span style=display:flex><span>        competitor_info<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>,
</span></span><span style=display:flex><span>        tech_analysis<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>,
</span></span><span style=display:flex><span>        market_analysis<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>,
</span></span><span style=display:flex><span>        competitor_tech_analysis<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>,
</span></span><span style=display:flex><span>        competitor_market_analysis<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>,
</span></span><span style=display:flex><span>        comparison_result<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>,
</span></span><span style=display:flex><span>        investment_decision<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>,
</span></span><span style=display:flex><span>        investment_score<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>,
</span></span><span style=display:flex><span>        final_report<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>,
</span></span><span style=display:flex><span>        messages<span style=color:#f92672>=</span>[],
</span></span><span style=display:flex><span>        iteration<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 실행</span>
</span></span><span style=display:flex><span>    result <span style=color:#f92672>=</span> graph<span style=color:#f92672>.</span>invoke(initial_state)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 결과 출력</span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>{</span><span style=color:#e6db74>&#39;=&#39;</span><span style=color:#f92672>*</span><span style=color:#ae81ff>60</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;📊 평가 결과&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span><span style=color:#e6db74>&#39;=&#39;</span><span style=color:#f92672>*</span><span style=color:#ae81ff>60</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;투자 점수: </span><span style=color:#e6db74>{</span>result[<span style=color:#e6db74>&#39;investment_score&#39;</span>]<span style=color:#e6db74>:</span><span style=color:#e6db74>.1f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>점&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>진행 과정:&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> msg <span style=color:#f92672>in</span> result[<span style=color:#e6db74>&#39;messages&#39;</span>]:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;  </span><span style=color:#e6db74>{</span>msg<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> result
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    <span style=color:#75715e># 스타트업 정보</span>
</span></span><span style=display:flex><span>    STARTUP_NAME <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Qure.ai&#34;</span>
</span></span><span style=display:flex><span>    STARTUP_INFO <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Qure.ai는 인도 기반 의료 AI 스타트업으로, 의료 영상 진단을 위한 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    딥러닝 솔루션을 개발합니다.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    주요 제품:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - qXR: 흉부 X-ray 자동 분석
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - qER: 응급실 뇌 CT 스캔 분석
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - qCT: 폐 결절 및 병변 탐지
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    실적:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - 70개국 이상 진출
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - 3,000개 이상 의료기관 도입
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - FDA 승인 획득
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    경쟁사:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - Zebra Medical Vision (이스라엘)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - Lunit (한국)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 평가 실행</span>
</span></span><span style=display:flex><span>    result <span style=color:#f92672>=</span> evaluate_startup(
</span></span><span style=display:flex><span>        startup_name<span style=color:#f92672>=</span>STARTUP_NAME,
</span></span><span style=display:flex><span>        startup_info<span style=color:#f92672>=</span>STARTUP_INFO
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 최종 보고서 저장</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> result[<span style=color:#e6db74>&#39;final_report&#39;</span>]:
</span></span><span style=display:flex><span>        <span style=color:#75715e># Word 파일 생성</span>
</span></span><span style=display:flex><span>        docx_path <span style=color:#f92672>=</span> save_report_as_docx(result, STARTUP_NAME)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>✅ Word 보고서 저장 완료: </span><span style=color:#e6db74>{</span>docx_path<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># PDF 파일 생성</span>
</span></span><span style=display:flex><span>        pdf_path <span style=color:#f92672>=</span> save_report_as_pdf(result, STARTUP_NAME)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;✅ PDF 보고서 저장 완료: </span><span style=color:#e6db74>{</span>pdf_path<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><h3><a class=anchor href=#>#</a></h3><p>#8</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments><script src=https://giscus.app/client.js data-repo=yshghid/yshghid.github.io data-repo-id=R_kgDONkMkNg data-category-id=DIC_kwDONkMkNs4CloJh data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=ko crossorigin=anonymous async></script></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#1-실습-개요>1. 실습 개요</a></li><li><a href=#2-실습-코드>2. 실습 코드</a></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul></li></ul></nav></div></aside></main></body></html>