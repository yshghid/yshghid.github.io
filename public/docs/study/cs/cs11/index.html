<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="머신러닝 과정 이해 # 목록 # 랜덤 데이터 세트 생성 &raquo;
머신러닝 과정 이해 &raquo;
랜덤 데이터 세트 생성 # centers=2로 만들기 피쳐 개수 2개, 클러스터 2개, 표준편차 1인 300개의 점으로 된 데이터 세트 생성하기. make_blobs()를 사용하고 피쳐가 X, 분류가 y로 들어간다.
from sklearn.datasets import make_blobs import pandas as pd X,y = make_blobs( random_state=3, n_features=2, #피쳐 개수 2 centers=2, #클러스터 2 cluster_std=1, n_samples=300) 데이터 확인하기
df = pd.DataFrame(X) df[&#34;target&#34;]=y df.">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1313/docs/study/cs/cs11/">
  <meta property="og:site_name" content="Lifelog 2025">
  <meta property="og:title" content="CS">
  <meta property="og:description" content="머신러닝 과정 이해 # 목록 # 랜덤 데이터 세트 생성 »
머신러닝 과정 이해 »
랜덤 데이터 세트 생성 # centers=2로 만들기 피쳐 개수 2개, 클러스터 2개, 표준편차 1인 300개의 점으로 된 데이터 세트 생성하기. make_blobs()를 사용하고 피쳐가 X, 분류가 y로 들어간다.
from sklearn.datasets import make_blobs import pandas as pd X,y = make_blobs( random_state=3, n_features=2, #피쳐 개수 2 centers=2, #클러스터 2 cluster_std=1, n_samples=300) 데이터 확인하기
df = pd.DataFrame(X) df[&#34;target&#34;]=y df.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
<title>CS | Lifelog 2025</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="http://localhost:1313/docs/study/cs/cs11/">
<link rel="stylesheet" href="/book.min.b79d7c33395061c8f79ecaf2ed506fabfbb4f7a048c6bf40218447335d11296c.css" integrity="sha256-t518MzlQYcj3nsry7VBvq/u096BIxr9AIYRHM10RKWw=" crossorigin="anonymous">
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.3cee19c080ab174413ad44df468ef1f12bf9ec37b69659caac14ca71cd7844e4.js" integrity="sha256-PO4ZwICrF0QTrUTfRo7x8Sv57De2llnKrBTKcc14ROQ=" crossorigin="anonymous"></script>

  

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><img src="/logo.png" alt="Logo" class="book-icon" /><span>Lifelog 2025</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>















  
  <ul>
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>기록</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/hobby/book/" class="">책</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/hobby/movie/" class="">영화</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/hobby/daily/" class="">일상</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>공부</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/study/bi/" class="">BI</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/study/cs/" class="">CS</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/disk/" class="">◡̈⋆*</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/about/" class=""> </a>
  

        </li>
      
    
  </ul>














</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>CS</h3>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#목록">목록</a></li>
    <li><a href="#랜덤-데이터-세트-생성">랜덤 데이터 세트 생성</a></li>
    <li><a href="#머신러닝-과정-이해-1">머신러닝 과정 이해</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h1 id="머신러닝-과정-이해">
  머신러닝 과정 이해
  <a class="anchor" href="#%eb%a8%b8%ec%8b%a0%eb%9f%ac%eb%8b%9d-%ea%b3%bc%ec%a0%95-%ec%9d%b4%ed%95%b4">#</a>
</h1>
<h2 id="목록">
  목록
  <a class="anchor" href="#%eb%aa%a9%eb%a1%9d">#</a>
</h2>
<p>랜덤 데이터 세트 생성 <a href="https://yshghid.github.io/docs/study/cs/cs11/#%eb%9e%9c%eb%8d%a4-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%84%b8%ed%8a%b8-%ec%83%9d%ec%84%b1">&raquo;</a></p>
<p>머신러닝 과정 이해 <a href="https://yshghid.github.io/docs/study/cs/cs11/#%eb%a8%b8%ec%8b%a0%eb%9f%ac%eb%8b%9d-%ea%b3%bc%ec%a0%95-%ec%9d%b4%ed%95%b4">&raquo;</a></p>
<hr>
<h2 id="랜덤-데이터-세트-생성">
  랜덤 데이터 세트 생성
  <a class="anchor" href="#%eb%9e%9c%eb%8d%a4-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%84%b8%ed%8a%b8-%ec%83%9d%ec%84%b1">#</a>
</h2>
<ol>
<li>centers=2로 만들기</li>
</ol>
<p>피쳐 개수 2개, 클러스터 2개, 표준편차 1인 300개의 점으로 된 데이터 세트 생성하기. make_blobs()를 사용하고 피쳐가 X, 분류가 y로 들어간다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.datasets <span style="color:#f92672">import</span> make_blobs
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>X,y <span style="color:#f92672">=</span> make_blobs(
</span></span><span style="display:flex;"><span>  random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  n_features<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, <span style="color:#75715e">#피쳐 개수 2</span>
</span></span><span style="display:flex;"><span>  centers<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, <span style="color:#75715e">#클러스터 2</span>
</span></span><span style="display:flex;"><span>  cluster_std<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, 
</span></span><span style="display:flex;"><span>  n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">300</span>)
</span></span></code></pre></div><p>데이터 확인하기</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(X)
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">=</span>y
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>head()
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plain" data-lang="plain"><span style="display:flex;"><span>	0	1	target
</span></span><span style="display:flex;"><span>0	-5.071794	-1.364393	1
</span></span><span style="display:flex;"><span>1	-3.174364	-1.145104	1
</span></span><span style="display:flex;"><span>2	0.818543	5.937601	0
</span></span><span style="display:flex;"><span>3	-4.338424	-2.055692	1
</span></span><span style="display:flex;"><span>4	-3.887373	-0.436586	1
</span></span></code></pre></div><p>이 데이터의 피쳐0을 가로, 피쳐1을 세로축으로 하고, target 값을 색을 구분해서 산포도 그리기.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 분류에 따라 데이터프레임 나누기</span>
</span></span><span style="display:flex;"><span>df0 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>df1 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 분류0은 파란색, 분류1은 빨간색으로 시각화</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df0[<span style="color:#ae81ff">0</span>], df0[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df1[<span style="color:#ae81ff">0</span>], df1[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;r&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="https://github.com/user-attachments/assets/c394b30c-9b92-4d59-ba74-7138be83b07e" alt="image" /></p>
<ol start="2">
<li>centers=3으로 만들기</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>X,y <span style="color:#f92672">=</span> make_blobs(
</span></span><span style="display:flex;"><span>  random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  n_features<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, <span style="color:#75715e">#피쳐 개수 2</span>
</span></span><span style="display:flex;"><span>  centers<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, <span style="color:#75715e">#클러스터 3</span>
</span></span><span style="display:flex;"><span>  cluster_std<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, 
</span></span><span style="display:flex;"><span>  n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">300</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(X)
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;target&#34;</span>] <span style="color:#f92672">=</span> y
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df0 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>df1 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>df2 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df0[<span style="color:#ae81ff">0</span>], df0[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df1[<span style="color:#ae81ff">0</span>], df1[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;r&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df2[<span style="color:#ae81ff">0</span>], df2[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;g&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="https://github.com/user-attachments/assets/8799cd62-d808-4030-a773-3cdf60fffc02" alt="image" /></p>
<ol start="3">
<li>centers=5로 만들기</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>X,y <span style="color:#f92672">=</span> make_blobs(
</span></span><span style="display:flex;"><span>  random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  n_features<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, <span style="color:#75715e">#피쳐 개수 2</span>
</span></span><span style="display:flex;"><span>  centers<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>, <span style="color:#75715e">#클러스터 5</span>
</span></span><span style="display:flex;"><span>  cluster_std<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, 
</span></span><span style="display:flex;"><span>  n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">300</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(X)
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;target&#34;</span>] <span style="color:#f92672">=</span> y
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df0 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>df1 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>df2 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>df3 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">3</span>]
</span></span><span style="display:flex;"><span>df4 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">4</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df0[<span style="color:#ae81ff">0</span>], df0[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df1[<span style="color:#ae81ff">0</span>], df1[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;r&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df2[<span style="color:#ae81ff">0</span>], df2[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;g&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df3[<span style="color:#ae81ff">0</span>], df3[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;m&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df4[<span style="color:#ae81ff">0</span>], df4[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;c&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="https://github.com/user-attachments/assets/4a13e2be-9387-4065-9782-98f138d0dc48" alt="image" /></p>
<ol start="4">
<li>초승달 모양 데이터 세트 - 노이즈 0.1로 만들기</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.datasets <span style="color:#f92672">import</span> make_moons
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>X,y <span style="color:#f92672">=</span> make_moons(
</span></span><span style="display:flex;"><span>  random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  noise<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1</span>,
</span></span><span style="display:flex;"><span>  n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">300</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(X)
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;target&#34;</span>] <span style="color:#f92672">=</span> y
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df0 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>df1 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df0[<span style="color:#ae81ff">0</span>], df0[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df1[<span style="color:#ae81ff">0</span>], df1[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;r&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="https://github.com/user-attachments/assets/08c26362-2ff7-4131-beae-01ec7d14e6c9" alt="image" /></p>
<ol start="5">
<li>초승달 모양 - 노이즈 0으로 만들기</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>X,y <span style="color:#f92672">=</span> make_moons(
</span></span><span style="display:flex;"><span>  random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  noise<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>  n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">300</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(X)
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;target&#34;</span>] <span style="color:#f92672">=</span> y
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df0 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>df1 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df0[<span style="color:#ae81ff">0</span>], df0[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df1[<span style="color:#ae81ff">0</span>], df1[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;r&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="https://github.com/user-attachments/assets/a255a170-9add-409b-b282-2fdf273767d7" alt="image" /></p>
<ol start="6">
<li>초승달 모양 - 노이즈 0.3으로 만들기</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>X,y <span style="color:#f92672">=</span> make_moons(
</span></span><span style="display:flex;"><span>  random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  noise<span style="color:#f92672">=</span><span style="color:#ae81ff">0.3</span>,
</span></span><span style="display:flex;"><span>  n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">300</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(X)
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;target&#34;</span>] <span style="color:#f92672">=</span> y
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df0 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>df1 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df0[<span style="color:#ae81ff">0</span>], df0[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df1[<span style="color:#ae81ff">0</span>], df1[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;r&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="https://github.com/user-attachments/assets/96807a98-ec36-406e-a0bf-a9350c8efd2d" alt="image" /></p>
<ol start="7">
<li>이중 원 데이터 세트 - 노이즈 0.1로 만들기</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.datasets <span style="color:#f92672">import</span> make_circles
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>X,y <span style="color:#f92672">=</span> make_circles(
</span></span><span style="display:flex;"><span>  random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  noise<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1</span>,
</span></span><span style="display:flex;"><span>  n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">300</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(X)
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;target&#34;</span>] <span style="color:#f92672">=</span> y
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df0 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>df1 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df0[<span style="color:#ae81ff">0</span>], df0[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df1[<span style="color:#ae81ff">0</span>], df1[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;r&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="https://github.com/user-attachments/assets/47f21349-8509-4fa8-afa2-8ce6af3ca599" alt="image" /></p>
<ol start="8">
<li>회귀용 데이터 세트 - 노이즈 10으로 만들기</li>
</ol>
<p>노이즈 10, X=0일때 y=100인 선의 데이터 세트 만들기.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.datasets <span style="color:#f92672">import</span> make_regression
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>X,y <span style="color:#f92672">=</span> make_regression(
</span></span><span style="display:flex;"><span>  random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  n_features<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  noise<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>,
</span></span><span style="display:flex;"><span>  bias<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>  n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">300</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(X)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#피쳐0과 y로 시각화</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df[<span style="color:#ae81ff">0</span>], y, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="https://github.com/user-attachments/assets/9f2e29af-167a-4820-bc15-5b19f677995f" alt="image" /></p>
<ol start="9">
<li>회귀용 데이터 노이즈 0으로 만들기</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.datasets <span style="color:#f92672">import</span> make_regression
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>X,y <span style="color:#f92672">=</span> make_regression(
</span></span><span style="display:flex;"><span>  random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  n_features<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  noise<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>  bias<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>  n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">300</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(X)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#피쳐0과 y로 시각화</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df[<span style="color:#ae81ff">0</span>], y, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="https://github.com/user-attachments/assets/08561593-45f8-4fac-a68e-bb3e8e488b57" alt="image" /></p>
<hr>
<h2 id="머신러닝-과정-이해-1">
  머신러닝 과정 이해
  <a class="anchor" href="#%eb%a8%b8%ec%8b%a0%eb%9f%ac%eb%8b%9d-%ea%b3%bc%ec%a0%95-%ec%9d%b4%ed%95%b4-1">#</a>
</h2>
<ol>
<li>데이터 만들기</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.datasets <span style="color:#f92672">import</span> make_blobs
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>X,y <span style="color:#f92672">=</span> make_blobs(
</span></span><span style="display:flex;"><span>  random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>  n_features<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>  centers<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>  cluster_std<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">300</span>)
</span></span></code></pre></div><ol start="2">
<li>학습용/테스트용 데이터 나누기</li>
</ol>
<p>자동 생성한 데이터를 학습용과 테스트용으로 나눈다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>X_train, X_test, y_train, y_test <span style="color:#f92672">=</span> train_test_split(X, y, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#학습용 피쳐 X_train 확인</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(X_train)
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;target&#34;</span>] <span style="color:#f92672">=</span> y_train
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#분류에 따라 데이터프레임 나누고 시각화</span>
</span></span><span style="display:flex;"><span>df0 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>df1 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df0[<span style="color:#ae81ff">0</span>], df0[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df1[<span style="color:#ae81ff">0</span>], df1[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;r&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;train:75%&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#테스트용 피쳐 X_test 확인</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(X_test)
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;target&#34;</span>] <span style="color:#f92672">=</span> y_test
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#분류에 따라 데이터프레임 나누고 시각화</span>
</span></span><span style="display:flex;"><span>df0 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>df1 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df0[<span style="color:#ae81ff">0</span>], df0[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df1[<span style="color:#ae81ff">0</span>], df1[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;r&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;test:25%&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="https://github.com/user-attachments/assets/2e995a34-4014-428f-9185-3cb8fec3bd41" alt="image" />
<img src="https://github.com/user-attachments/assets/0c1ab685-b490-4b39-a6df-2b2e3f6f0770" alt="image" /></p>
<ol start="3">
<li>모델 선택, 학습</li>
</ol>
<p>서포트 벡터 머신으로 학습 모델을 만들고 학습하기</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn <span style="color:#f92672">import</span> svm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>model <span style="color:#f92672">=</span> svm<span style="color:#f92672">.</span>SVC()
</span></span><span style="display:flex;"><span>model<span style="color:#f92672">.</span>fit(X_train, y_train)
</span></span></code></pre></div><ol start="4">
<li>모델 테스트</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pred <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(X_test)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(X_test)
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#34;target&#34;</span>] <span style="color:#f92672">=</span> pred <span style="color:#75715e">#y_test 대신 pred 사용</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#분류에 따라 데이터프레임 나누고 시각화</span>
</span></span><span style="display:flex;"><span>df0 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>df1 <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#34;target&#34;</span>]<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df0[<span style="color:#ae81ff">0</span>], df0[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df1[<span style="color:#ae81ff">0</span>], df1[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;r&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;predict&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="https://github.com/user-attachments/assets/c7c6d987-7027-47c3-8fcc-559f26792569" alt="image" /></p>
<p>정답률 확인하기.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> accuracy_score
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pred <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(X_test)
</span></span><span style="display:flex;"><span>score <span style="color:#f92672">=</span> accuracy_score(y_test, pred)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;정답률:&#34;</span>, score<span style="color:#f92672">*</span><span style="color:#ae81ff">100</span>, <span style="color:#e6db74">&#34;%&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plain" data-lang="plain"><span style="display:flex;"><span>정답률: 96.0 %
</span></span></code></pre></div><ol start="5">
<li>새로운 값 예측</li>
</ol>
<p>이 머신러닝에서는 2개의 피쳐를 이용해서 학습했으므로 예측도 2개의 피쳐 데이터로 예측한다. 첫번째 데이터는 피쳐가 1,3이고 두번째 데이터는 피쳐가 1,2이다. 이들은 &lsquo;분류 경계 부근&rsquo;에 있는 가상 데이터이다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#피쳐가 1,3인 결과를 예측</span>
</span></span><span style="display:flex;"><span>pred <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict([[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>]])
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;1,3=&#34;</span>, pred)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#피쳐가 1,2인 결과를 예측</span>
</span></span><span style="display:flex;"><span>pred <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict([[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>]])
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;1,2=&#34;</span>, pred)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plain" data-lang="plain"><span style="display:flex;"><span>1,3= [0]
</span></span><span style="display:flex;"><span>1,2= [1]
</span></span></code></pre></div><p>피쳐가 &lsquo;1,3&rsquo;일때 분류가 0이고 피쳐가 &lsquo;1,2&rsquo;일때 분류가 1로 예측되었다.</p>
<p>이 데이터를 산포도의 [1,3],[1,2] 위치에 X 마크를 그려서 확인하기.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df0[<span style="color:#ae81ff">0</span>], df0[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(df1[<span style="color:#ae81ff">0</span>], df1[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;r&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter([<span style="color:#ae81ff">1</span>],[<span style="color:#ae81ff">3</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>, marker<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;x&#34;</span>, s<span style="color:#f92672">=</span><span style="color:#ae81ff">300</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter([<span style="color:#ae81ff">1</span>],[<span style="color:#ae81ff">2</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;r&#34;</span>, marker<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;x&#34;</span>, s<span style="color:#f92672">=</span><span style="color:#ae81ff">300</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;predict&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="https://github.com/user-attachments/assets/c7b21702-ba24-49c4-a220-e669e981b2f5" alt="image" /></p>
<p>새로운 데이터포인트 2개의 분류와 각 포인트의 위치. 분류가 잘된것을 눈으로는 확인 가능하다.</p>
<ol start="6">
<li>새로운 값의 분류 상태 시각화</li>
</ol>
<p>분류가 잘된것을 더 확실하게 확인하는 법은? 그래프를 칸 모양으로 구획한 점 데이터를 만들기. 점들이 어떻게 분류되는지를 칸을 색칠해서 확인.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplots(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#pcolormesh를 사용하면 표시 범위를 분할해서 색칠할 수 있고 3x3, 8x8, 100x100으로 조밀할수록 매끄럽게 칠해진다.</span>
</span></span><span style="display:flex;"><span>sizelist <span style="color:#f92672">=</span> [<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">100</span>]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>):
</span></span><span style="display:flex;"><span>  size <span style="color:#f92672">=</span> sizelist[i]
</span></span><span style="display:flex;"><span>  X, Y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>meshgrid(np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">10</span>,size<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>), np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">10</span>,size<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>  C <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">100</span>,size<span style="color:#f92672">*</span>size)<span style="color:#f92672">.</span>reshape(size,size)
</span></span><span style="display:flex;"><span>  plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>,i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>  plt<span style="color:#f92672">.</span>pcolormesh(X,Y,C,cmap<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;rainbow&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="https://github.com/user-attachments/assets/0c21cd0b-0f8e-4afa-8662-2afb86f53c09" alt="image" /></p>
<p>이런 식으로 &lsquo;분류 상태를 그리는 함수&rsquo; 만들기. 그래프상의 모든 점을 예측해서 어느 분류인지 색칠해서 확인한다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> matplotlib.colors <span style="color:#f92672">import</span> ListedColormap
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#산포도에 분류 상태를 그리는 함수</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">plot_boundary</span>(model,X,Y,target,xlabel,ylabel):
</span></span><span style="display:flex;"><span>    cmap_dots <span style="color:#f92672">=</span> ListedColormap([<span style="color:#e6db74">&#34;#1f77b4&#34;</span>, <span style="color:#e6db74">&#34;#ff7f0e&#34;</span>, <span style="color:#e6db74">&#34;#2ca02c&#34;</span>])
</span></span><span style="display:flex;"><span>    cmap_fills <span style="color:#f92672">=</span> ListedColormap([<span style="color:#e6db74">&#34;#c6dcec&#34;</span>, <span style="color:#e6db74">&#34;#ffdec2&#34;</span>, <span style="color:#e6db74">&#34;#cae7ca&#34;</span>])
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> model:
</span></span><span style="display:flex;"><span>        XX,YY <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>meshgrid(
</span></span><span style="display:flex;"><span>            np<span style="color:#f92672">.</span>linspace(X<span style="color:#f92672">.</span>min()<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,X<span style="color:#f92672">.</span>max()<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">200</span>),
</span></span><span style="display:flex;"><span>            np<span style="color:#f92672">.</span>linspace(Y<span style="color:#f92672">.</span>min()<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,Y<span style="color:#f92672">.</span>max()<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">200</span>))
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#점의 값 예측</span>
</span></span><span style="display:flex;"><span>        pred <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(np<span style="color:#f92672">.</span>c_[XX<span style="color:#f92672">.</span>ravel(),YY<span style="color:#f92672">.</span>ravel()])<span style="color:#f92672">.</span>reshape(XX<span style="color:#f92672">.</span>shape)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#예측결과값(0~2)를 색칠</span>
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>pcolormesh(XX,YY,pred,cmap<span style="color:#f92672">=</span>cmap_fills,shading<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;auto&#34;</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>contour(XX,YY,pred,colors<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;gray&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#target값(0~2) 점을 그림</span>
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>scatter(X,Y,c<span style="color:#f92672">=</span>target,cmap<span style="color:#f92672">=</span>cmap_dots)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>xlabel(xlabel)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>ylabel(ylabel)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>show()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(X_test)
</span></span><span style="display:flex;"><span>pred <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(X_test)
</span></span><span style="display:flex;"><span>plot_boundary(<span style="color:#66d9ef">None</span>,df[<span style="color:#ae81ff">0</span>],df[<span style="color:#ae81ff">1</span>],pred,<span style="color:#e6db74">&#34;df[0]&#34;</span>,<span style="color:#e6db74">&#34;df[1]&#34;</span>)
</span></span></code></pre></div><p><img src="https://github.com/user-attachments/assets/eb1fdc56-8f93-4fa3-bfba-6f9d36b91856" alt="image" /></p>
<p>plot_boundary 함수의 input으로는 모델, x축 피쳐, y축 피쳐, target(분류값), 그래프에 표시될 x축 label, y축 label이 들어간다. model을 None으로 지정하면 산포도만 그릴수도 있다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plot_boundary(model,df[<span style="color:#ae81ff">0</span>],df[<span style="color:#ae81ff">1</span>],pred,<span style="color:#e6db74">&#34;df[0]&#34;</span>,<span style="color:#e6db74">&#34;df[1]&#34;</span>)
</span></span></code></pre></div><p><img src="https://github.com/user-attachments/assets/ddb45f55-f41c-46bc-90f0-93d37c27cfe8" alt="image" /></p>
<p>초승달 데이터 세트를 만들고 모델을 만들어 학습시킨 다음 학습된 분류상태를 산포도로 그리기.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.datasets <span style="color:#f92672">import</span> make_moons
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>X,y <span style="color:#f92672">=</span> make_moons(random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, noise<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1</span>, n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">300</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#피쳐 X로 데이터프레임 만들고 모델 학습</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(X)
</span></span><span style="display:flex;"><span>model<span style="color:#f92672">=</span>svm<span style="color:#f92672">.</span>SVC()
</span></span><span style="display:flex;"><span>model<span style="color:#f92672">.</span>fit(X,y)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#분류 상태 그리기</span>
</span></span><span style="display:flex;"><span>plot_boundary(model, df[<span style="color:#ae81ff">0</span>], df[<span style="color:#ae81ff">1</span>], y, <span style="color:#e6db74">&#34;df[0]&#34;</span>, <span style="color:#e6db74">&#34;df[1]&#34;</span>)
</span></span></code></pre></div><p><img src="https://github.com/user-attachments/assets/2c97f354-6b71-4bc2-8253-42f9157420de" alt="image" /></p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments"><script src="https://giscus.app/client.js"
        data-repo="yshghid/yshghid.github.io"
        data-repo-id="R_kgDONkMkNg"
        data-category-id="DIC_kwDONkMkNs4CloJh"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="ko"
        crossorigin="anonymous"
        async>
</script>
</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#목록">목록</a></li>
    <li><a href="#랜덤-데이터-세트-생성">랜덤 데이터 세트 생성</a></li>
    <li><a href="#머신러닝-과정-이해-1">머신러닝 과정 이해</a></li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












